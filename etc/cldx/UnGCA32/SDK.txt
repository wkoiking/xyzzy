=======================================================================
               UnGCA32.dll Ver 0.10b以降  API 仕様書
=======================================================================

　 UnGCA32.dll はスレッドセーフではありません。
　対応アプリケーション作成の際には注意してください。

　同梱のUnGCA32.libはVisualC++6.0+SP5を想定したものです。
　動的リンクをすれば必要ありませんので、極力使用しないでください。


-----------------------------------------------------------------------
int WINAPI UnGCA(const HWND hWnd, LPCSTR szCmdLine, LPSTR szOutput,
                 const DWORD dwSize);
-----------------------------------------------------------------------
順序数  1
機能
        解凍（展開）などを行います。
        コマンド文字列はCommand.txtを参照してください。

引数
        hWnd        呼び出し元ウィンドウハンドル
        szCmdLine   UnGCA32.dll に渡すコマンド文字列
        szOutput    戻り文字列
        dwSize      戻り文字列のサイズ

        戻り文字列が指定した戻り文字列のサイズよりも大きい場合は、切捨て
        られます。

戻り値
        正常終了の時            0
        ERROR_FILE_OPEN         ファイルが開けない
        ERROR_COMMAND_NAME      ファイル名が指定されていない
        ERROR_ENOUGH_MEMORY     メモリが足りない
        ERROR_ALREADY_RUNNING   既に動作中である。
        ERROR_NOT_ARC_FILE      書庫ファイルの指定がない。
        -1                      書き込みできない、展開できないファイルである

-----------------------------------------------------------------------
WORD WINAPI UnGCAGetVersion(void);
-----------------------------------------------------------------------
順序数  2
機能
        UnGCA32.dll のバージョンを返します。

戻り値
        例        1 -> Version 0.01
                256 -> Version 2.56

その他
        仕様変更で関数仕様が変わる可能性があります。
        必ずバージョンのチェックを行なってください。
        緊急時や不具合修正のみの場合は、UnGCAGetSubVersion() で返される
        値のみ増加することがあります。
        （「Ver.0.07c」のUnGCAGetSubVersion()の戻り値は「3」になります）

-----------------------------------------------------------------------
WORD WINAPI UnGCAGetCursorInterval(void)
-----------------------------------------------------------------------
順序数  3
機能
        カーソルの回転速度を得ます
        エントリだけで動作しません。

戻り値
        0固定

-----------------------------------------------------------------------
BOOL WINAPI UnGCASetCursorInterval(const WORD wInterval)
-----------------------------------------------------------------------
順序数  4
機能
        カーソルの回転速度を設定します
        エントリだけで動作しません。

引数
        無視します。

戻り値
        TRUE固定

-----------------------------------------------------------------------
BOOL WINAPI UnGCAGetBackGroundMode(void);
-----------------------------------------------------------------------
順序数  5
機能
        UnGCA32.DLL がバックグラウンドモードか否かを得ます。
        エントリだけで動作しません。

戻り値
        TRUE固定

-----------------------------------------------------------------------
BOOL WINAPI UnGCASetBackGroundMode(const BOOL bBackGroundMode);
-----------------------------------------------------------------------
順序数  6
機能
        UnGCA32.DLL のバックグラウンドモードを設定します。
        エントリだけで動作しません。

引数
        bBackGroundMode 設定するバックグラウンドモード。

戻り値
        TRUE固定

-----------------------------------------------------------------------
BOOL WINAPI UnGCAGetCursorMode(void);
-----------------------------------------------------------------------
順序数  7
機能
        UnGCA32.DLL の動作中にカーソルを表示するモードか否かを得ます。
        エントリだけで動作しません。

戻り値
        TRUE固定

-----------------------------------------------------------------------
BOOL WINAPI UnGCASetCursorMode(const BOOL bCursorMode);
-----------------------------------------------------------------------
順序数  8
機能
        UnGCA32.DLL の動作中にカーソルを表示するモードか否かを設定します。
        エントリだけで動作しません。

引数
        bCursorMode     設定するカーソルモード。

戻り値
        TRUE固定

-----------------------------------------------------------------------
BOOL WINAPI UnGCAGetRunning(void)
-----------------------------------------------------------------------
順序数  10
機能
        現在 UnGCA32.DLL が動作中か否かを得ます。 UnGCA32.DLL は複数同時実
        行に対応していないので，同時に実行される可能性がある場合はアプリ側
        で API を呼び出す前にチェックを行うようにしてください。
        UnGCA32.DLL は処理を行う前に内部でこのチェックを行ってはいます。

戻り値
        TRUE:実行中
        FALSE:実行中でない

-----------------------------------------------------------------------
BOOL WINAPI UnGCACheckArchive(LPCSTR szFileName, const int nMode)
-----------------------------------------------------------------------
順序数  11
機能
        指定ファイルが書庫として正しいかどうかを返します。

引数
        szFileName      チェックすべき書庫のファイル名。
        nMode           チェックモード。
          CHECKARCHIVE_RAPID    簡易モード。
                (0)             自己展開形式や、パスワードがかけられている
                                書庫ではFALSEになります

          　以下のフラグは上記のフラグと組み合わせて使います
          CHECKARCHIVE_SFX      自己展開書庫でもTRUEを返すようになります
                (8)             
          CHECKARCHIVE_ALL      パスワードがかけられている書庫もTRUEを返す
                (16)            ようになります
                                ただし、パスワードが必要な場合は入力画面でが
                                表示され、正しいパスワードを入力する必要があ
                                ります

戻り値
        GCA ファイルの時        TRUE を返します。
        ファイルが不正の時      FALSE。 

-----------------------------------------------------------------------
BOOL WINAPI UnGCAConfigDialog(const HWND hWnd,LPSTR szOptionBuffer,
                                 const int nMode);
-----------------------------------------------------------------------
順序数  12
機能
        環境設定ダイアログですが、設定するものがないのでバージョン情報に
        なっています。(^^;

引数
        hWnd            呼び出すアプリのウィンドウのハンドル
        szOptionBuffer  無視します
        nMode           無視します

戻り値
        TRUE固定。

-----------------------------------------------------------------------
int WINAPI UnGCAGetFileCount(LPCSTR szArcFile);
-----------------------------------------------------------------------
順序数  17
機能
        指定した書庫ファイルに格納されているファイル数を取得します。

引数
        szArcFile 格納ファイル数を得たい書庫ファイル名。

戻り値
        格納ファイル数。エラーのときは -1 を返す。

-----------------------------------------------------------------------
BOOL UnGCAQueryFunctionList(const int nFunction);
-----------------------------------------------------------------------
順序数  18
機能
    指定した API が使用可能かどうかを得ます。

引数
    nFunction   API を示す一意な数値。具体的な数値は UnGCA.H 参照のこと。

戻り値
    TRUE:使用可能
    FALSE:使用不可

=======================================================================
                OpenArchive 系 API
=======================================================================

-----------------------------------------------------------------------
HARC UnGCAOpenArchive(const HWND hWnd, LPCSTR szFileName,
                         const DWORD dwMode);
-----------------------------------------------------------------------
順序数  21
機能
        指定ファイルが有効な書庫ファイルならばオープンし、そのハンドルを
        返します。以後の書庫ファイルへのアクセスはこのハンドルで行います。

引数
        hWnd            アプリのウィンドウ・ハンドル。
        szFileName      書庫ファイル名。
        dwMode          無視します

戻り値
        指定の書庫ファイルに対応したハンドル。エラー時は NULL 。

-----------------------------------------------------------------------
int UnGCACloseArchive(HARC hArc);
-----------------------------------------------------------------------
順序数  22
機能
        UnGCAOpenArchive()API で割り付けたハンドルを解放します。

戻り値
        0:正常終了、その他:エラー

-----------------------------------------------------------------------
int UnGCAFindFirst(HARC hArc, LPCSTR szWildName,
                        LPINDIVIDUALINFO lpSubInfo);
-----------------------------------------------------------------------
順序数  23
機能
        最初の格納ファイルの情報を得ます。

引数
        szWildName      検索するファイル名の指定。ワイルドカード指定が
                        可能。
        lpSubInfo       結果を返すための INDIVIDUALINFO 型の構造体への
                        ポインタ。
                        結果を必要としない場合は NULL を指定します。

戻り値
        0:正常終了
        -1:検索終了
        その他:エラー

注意
        szWildNameにパス名は含まないでください。
        また、「*」と「?」しか使用できません。
        全件検索は、szWildNameにNULLか"*"を指定してください。"*.*"は拡張
        子のあるファイルという意味になります。

-----------------------------------------------------------------------
int UnGCAFindNext(HARC hArc, LPINDIVIDUALINFO lpSubInfo);
-----------------------------------------------------------------------
順序数  24
機能
        ２番目以降の格納ファイルの情報を取得します。

引数
        lpSubInfo       結果を返すための INDIVIDUALINFO 型の構造体への
                        ポインタ。
                        結果を必要としない場合は NULL を指定する事。

戻り値
        0:正常終了
        -1:検索終了
        その他:エラー

-----------------------------------------------------------------------
int WINAPI UnGCAGetArcFileName(HARC hArc,
                        LPSTR szBuffer, const int nSize)
-----------------------------------------------------------------------
順序数  31
機能
        書庫ファイル名を得ます。

引数
        szBuffer        ファイル名を格納するバッファ。
        nSize           バッファのサイズ。

戻り値
        正常終了時は 0 を返します。エラー時には -1 を返します。

-----------------------------------------------------------------------
DWORD WINAPI UnGCAGetArcFileSize(HARC hArc)
-----------------------------------------------------------------------
順序数  32
機能
        書庫ファイルのサイズを得ます。

戻り値
        書庫ファイルのサイズ。エラー時には -1 を返します。

-----------------------------------------------------------------------
DWORD WINAPI UnGCAGetArcOriginalSize(HARC hArc)
-----------------------------------------------------------------------
順序数  33
機能
        検索にマッチしたファイルのサイズの合計を得ます。UnGCAFindNext() の
        検索が終了した後でないと返却値に意味はありません。検索中の場合はそ
        れまでにマッチしたファイルの合計となります。

戻り値
        合計サイズ。エラー時には -1 を返します。

-----------------------------------------------------------------------
DWORD WINAPI UnGCAGetArcCompressedSize(HARC hArc)
-----------------------------------------------------------------------
順序数  34
機能
        検索にマッチしたファイルの圧縮サイズの合計を得ます。

戻り値
        SOLIDモード時は 0 になります。
        エラー時には -1 を返します。

注意
        UnGCAFindNext() の検索が終了してから呼び出すようにしてください。
-----------------------------------------------------------------------
WORD WINAPI UnGCAGetArcRatio(HARC hArc)
-----------------------------------------------------------------------
順序数  35
機能
        検索にマッチしたファイルの全体の圧縮率を得ます。

戻り値
        パーミル (千分率) で現された格納ファイルの圧縮率。
        SOLIDモード時は 0 になります。
        エラー時には -1 を返します。

注意
        UnGCAFindNext() の検索が終了してから呼び出すようにしてください。

-----------------------------------------------------------------------
WORD WINAPI UnGCAGetArcDate(HARC hArc)
-----------------------------------------------------------------------
順序数  36
機能
        書庫ファイルの日付を DOS 形式で得ます。

戻り値
        書庫ファイルの日付。エラー時には -1 。 形式は INDIVIDUALINFO
        構造体に格納されるものと同じです。

-----------------------------------------------------------------------
WORD WINAPI UnGCAGetArcTime(HARC hArc)
-----------------------------------------------------------------------
順序数  37
機能
        書庫ファイルの時刻を DOS 形式で得ます。

戻り値
        書庫ファイルの時刻。エラー時には -1 。 形式は INDIVIDUALINFO
        構造体に格納されるものと同じです。

-----------------------------------------------------------------------
UINT WINAPI UnGCAGetArcOSType(HARC hArc);
-----------------------------------------------------------------------
順序数  38
機能
        無条件で 0 を返します。

戻り値
        0 固定、エラー時は -1 

-----------------------------------------------------------------------
int WINAPI UnGCAGetFileName(HARC hArc,
                         LPSTR szBuffer, const int nSize);
-----------------------------------------------------------------------
順序数  40
機能
        格納ファイルのファイル名を得ます。

引数
        szBuffer        ファイル名を格納するバッファ。
        nSize           バッファのサイズ。

戻り値
        正常終了時には 0 が返され、szBuffer にファイル名が格納されます。
        エラー時には -1 を返します。

-----------------------------------------------------------------------
DWORD WINAPI UnGCAGetOriginalSize(HARC hArc);
-----------------------------------------------------------------------
順序数  41
機能
        格納ファイルのサイズを得ます。

戻り値
        格納ファイルのサイズ。エラー時には -1 を返します。

-----------------------------------------------------------------------
DWORD WINAPI UnGCAGetCompressedSize(HARC hArc);
-----------------------------------------------------------------------
順序数  42
機能
        格納ファイルの圧縮サイズを得ます。

戻り値
        SOLIDモード時は 0 になります。
        エラー時には -1 を返します。

-----------------------------------------------------------------------
WORD WINAPI UnGCAGetRatio(HARC hArc);
-----------------------------------------------------------------------
順序数  43
機能
        格納ファイルの圧縮率を得ます。

戻り値
        パーミル (千分率) で現された格納ファイルの圧縮率を返します。
        SOLIDモード時は 0 になります。
        エラー時には -1 を返します。

-----------------------------------------------------------------------
WORD WINAPI UnGCAGetDate(HARC hArc);
-----------------------------------------------------------------------
順序数  44
機能
        格納ファイルの日付を DOS 形式で得ます。

戻り値
        格納ファイルの日付。エラー時には -1 。 形式は INDIVIDUALINFO
        構造体に格納されるものと同じです。

-----------------------------------------------------------------------
WORD WINAPI UnGCAGetTime(HARC hArc);
-----------------------------------------------------------------------
順序数  45
機能
        格納ファイルの時刻を DOS 形式で得ます。

戻り値
        格納ファイルの時刻。エラー時には -1 。 形式は INDIVIDUALINFO
        構造体に格納されるものと同じです。

-----------------------------------------------------------------------
DWORD WINAPI UnGCAGetCRC(HARC hArc);
-----------------------------------------------------------------------
順序数  46
機能
        格納ファイルのチェックサムを得ます。

戻り値
        格納ファイルのチェックサム。エラー時には -1 を返します。

-----------------------------------------------------------------------
int WINAPI UnGCAGetAttribute(HARC hArc);
-----------------------------------------------------------------------
順序数  47
機能
        格納ファイルの属性を得ます。

戻り値
        格納ファイルの属性。エラー時には -1 を返します。
注意
        ＳＤＫの返す値をそのまま返しています。
        FILE_ATTRIBUTE_ARCHIVE 等の属性が返ります。

-----------------------------------------------------------------------
UINT WINAPI UnGCAGetOSType(HARC hArc);
-----------------------------------------------------------------------
順序数  48
機能
        無条件で 0 を返します。

戻り値
        0 固定、エラー時には -1 を返します。

-----------------------------------------------------------------------
int WINAPI UnGCAExtractMem(const HWND hWnd, LPCSTR szCmdLine,
                LPBYTE lpbBuffer, const DWORD dwSize, time_t *lpTime,
                LPWORD lpwAttr, LPDWORD lpdwWriteSize)
-----------------------------------------------------------------------
順序数  49
機能
        メモリバッファへ展開します。 残念ながら、lpdwWriteSize で指定
        したサイズごとに複数回に分けて処理…といった使用法は行えません。

引数
        hWnd        UnGCA32.DLL を呼び出すアプリのウィンドウのハンドル。
                    指定する必要のない場合は NULL を渡します。
        szCmdLine   UnGCA32.DLL に渡すコマンドの文字列。UnGCA()のexコマンド
                    以外はエラーになります。
        lpBuffer    展開イメージを格納するバッファ。ここで指定するバッファ
                    については，dwSize で示されるサイズが保証されている必要
                    があります。
        dwSize      バッファのサイズ。UnGCA32.DLL が返す結果のサイズより指
                    定されたサイズが小さい場合は指定サイズまで出力されます。
        lpTime      展開されたファイルの UTC でのタイムスタンプを得ます。
                    必要ない場合は NULL を指定します。
        lpwAttr     展開されたファイルの属性を得ます。 必要ない場合は NULL
                    を指定します。
        lpdwWriteSize
                    展開の結果書き込まれたサイズを得ます。必要ない場合は
                    NULL を指定します。

戻り値
        正常終了の時            0。
        エラーが発生した場合    0 以外の数。

その他
        ワイルドカード、複数ファイル指定は使用できません。
        レスポンスファイルを使用すれば、複数指定することも可能ですが、APIの
        性格上無意味です。

注意
        APIの動作では使用しませんが、展開先フォルダも必須です。
        適当なフォルダ名を指定してください。

-----------------------------------------------------------------------
int WINAPI UnGCAGetMethod(HARC hArc, LPSTR szBuffer, const int nSize)
-----------------------------------------------------------------------
順序数  61
機能
        格納ファイルの圧縮法を得ます。

引数
        szBuffer        メソッド名を格納するバッファ。
        nSize           バッファのサイズ。

戻り値
        正常終了時には 0 が返されます。エラー時には -1 を返します。
        szBufferにはノーマルモード時には"GCA0"、SOLIDモード時は"GCA1"を
        返します。

-----------------------------------------------------------------------
DWORD WINAPI UnGCAGetWriteTime(HARC hArc)
-----------------------------------------------------------------------
順序数  62
機能
        格納ファイルの最終更新日時を得ます。

戻り値
        格納ファイルの UNIX 形式の UTC による更新日時。エラー時は -1。
        UNIX 形式とは，Jan.1,1970 00:00:00 からの秒数です。

-----------------------------------------------------------------------
BOOL WINAPI UnGCAGetWriteTimeEx(HARC hArc, FILETIME *lpftLastWriteTime)
-----------------------------------------------------------------------
順序数  65
機能
        格納ファイルの最終更新日時を得ます。

戻り値
        正常終了時は  TRUE を、そうでない場合は FALSE を返し、指定された
        FILETIME 構造体に最終更新日時を格納します。

-----------------------------------------------------------------------
BOOL WINAPI UnGCAGetArcCreateTimeEx(HARC hArc,
                                FILETIME *lpftCreationTime)
-----------------------------------------------------------------------
順序数  68
機能
        書庫の作成日時を得ます。

戻り値
        正常終了時は  TRUE を、そうでない場合は FALSE を返し、指定された
        FILETIME 構造体に作成日時を格納します。

-----------------------------------------------------------------------
BOOL WINAPI UnGCAGetArcAccessTimeEx(HARC hArc,
                                FILETIME *lpftLastAccessTime)
-----------------------------------------------------------------------
順序数  69
機能
        書庫の参照日時を得ます。

戻り値
        正常終了時は  TRUE を、そうでない場合は FALSE を返し、指定された
        FILETIME 構造体に参照日時を格納します。

-----------------------------------------------------------------------
BOOL WINAPI UnGCAGetArcWriteTimeEx(HARC hArc,
                                FILETIME *lpftLastWriteTime)
-----------------------------------------------------------------------
順序数  70
機能
        書庫の最終更新日時を得ます。

戻り値
        正常終了時は  TRUE を、そうでない場合は FALSE を返し、指定された
        FILETIME 構造体に最終更新日時を格納します。

-----------------------------------------------------------------------
BOOL WINAPI UnGCAGetArcFileSizeEx(HARC hArc,
                                ULHA_INT64 *lpllSize)
-----------------------------------------------------------------------
順序数  103
機能
        書庫ファイルのサイズを 64 ビット整数で得ます。

引数
        hArc            UnGCAOpenArchive() で返されたハンドル。
        lpllSize        情報を格納するためのバッファへのポインタ。 VC++ や
                        C++ Builder 5.x 等では実体は LONGLONG となっていま
                        す。BC++ 等 64ビット整数として LONGLONG を扱えない
                        コンパイラを使用する場合には， (アラインメントのな
                        い) LARGE_INTEGER 等で代用してください。

戻り値
        正常終了時は TRUE。エラー時には FALSE を返します。

注意
        格納ファイルの合計サイズではなく，書庫そのもののサイズであることに
        注意してください。

-----------------------------------------------------------------------
BOOL WINAPI UnGCAGetArcOriginalSizeEx(HARC hArc,
                                ULHA_INT64 *lpllSize)
-----------------------------------------------------------------------
順序数  104
機能
        検索にマッチしたファイルのサイズの合計を 64 ビット整数で得ます。Un-
        GCAFindNext() の検索が終了した後でないと返却値に意味はありません。
        検索中の場合はそれまでにマッチしたファイルの合計となります。

引数
        hArc            UnGCAOpenArchive() で返されたハンドル。
        lpllSize        情報を格納するためのバッファへのポインタ。 VC++ や
                        C++ Builder 5.x 等では実体は LONGLONG となっていま
                        す。BC++ 等 64ビット整数として LONGLONG を扱えない
                        コンパイラを使用する場合には， (アラインメントのな
                        い) LARGE_INTEGER 等で代用してください。

戻り値
        正常終了時は TRUE。エラー時には FALSE を返します。

注意
        UnGCAFindNext() の検索が終了してから呼び出すようにしてください。

-----------------------------------------------------------------------
BOOL WINAPI UnGCAGetArcCompressedSizeEx(HARC hArc,
                                ULHA_INT64 *lpllSize)
-----------------------------------------------------------------------
順序数  105
機能
        検索にマッチしたファイルの圧縮サイズの合計を 64 ビット整数で得ます。

引数
        hArc            UnGCAOpenArchive() で返されたハンドル。
        lpllSize        情報を格納するためのバッファへのポインタ。 VC++ や
                        C++ Builder 5.x 等では実体は LONGLONG となっていま
                        す。BC++ 等 64ビット整数として LONGLONG を扱えない
                        コンパイラを使用する場合には， (アラインメントのな
                        い) LARGE_INTEGER 等で代用してください。

戻り値
        正常終了時は TRUE。エラー時には FALSE を返します。

注意
        UnGCAFindNext() の検索が終了してから呼び出すようにしてください。

-----------------------------------------------------------------------
BOOL WINAPI UnGCAGetOriginalSizeEx(HARC hArc,
                                ULHA_INT64 *lpllSize)
-----------------------------------------------------------------------
順序数  106
機能
        格納ファイルのサイズを 64 ビット整数で得ます。

引数
        hArc            UnGCAOpenArchive() で返されたハンドル。
        lpllSize        情報を格納するためのバッファへのポインタ。 VC++ や
                        C++ Builder 5.x 等では実体は LONGLONG となっていま
                        す。BC++ 等 64ビット整数として LONGLONG を扱えない
                        コンパイラを使用する場合には， (アラインメントのな
                        い) LARGE_INTEGER 等で代用してください。

戻り値
        正常終了時は TRUE。エラー時には FALSE を返します。

-----------------------------------------------------------------------
DWORD WINAPI UnGCAGetCompressedSizeEx(HARC hArc, 
                                ULHA_INT64 *lpLLSize)
-----------------------------------------------------------------------
順序数  42
機能
        格納ファイルの圧縮サイズを得ます。

引数
        hArc            UnGCAOpenArchive() で返されたハンドル。
        lpllSize        情報を格納するためのバッファへのポインタ。 VC++ や
                        C++ Builder 5.x 等では実体は LONGLONG となっていま
                        す。BC++ 等 64ビット整数として LONGLONG を扱えない
                        コンパイラを使用する場合には， (アラインメントのな
                        い) LARGE_INTEGER 等で代用してください。

戻り値
        正常終了時は TRUE。エラー時には FALSE を返します。

