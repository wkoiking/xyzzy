=======================================================================
            UNLHA32.DLL Ver 2.67a  "$" ファイルコマンド説明
=======================================================================

                                               Ｍｉｃｃｏ (Sep.12,2010)


はじめに

　UNLHA32.DLL のドキュメント構成は以下のようになっています。

    API.TXT      : 基幹を成す Unlha() 系及び OpenArchive() 系 API の説明
    NOTE2.TXT    : API.TXT の補足説明
    COMMAND.TXT  : Unlha() に渡すコマンド文字列についての説明
    NOTE.TXT     : COMMAND.TXT の補足説明
    WINMES.TXT   : SetOwnerWindow() 系 API の説明
    ENUMAPI.TXT  : SetEnumMembersProc() 系 API の説明
    STRTABLE.TXT : ストリングテーブルと言語設定用 API についての説明
    HEADER.TXT   : LZH 書庫ヘッダ仕様の説明
    INFCOM.TXT   : Win32SFXM で使用される $ ファイルコマンドの説明
    QandA.TXT    : 過去にあった主な質問集
    HISTORY.TXT  : 修正履歴

　このドキュメントでは， WinSFX32(M) で使われる $ ファイルのコマンドについ
て説明されています。


--------------------------------------
%1.  "$" ファイルについて
%2.  コマンドラインの様式
%3.  コマンドの詳細
%4.  ディレクトリー指定変数文字列
%5.  "$" ファイルの例
--------------------------------------


%1.  "$" ファイルについて

  　WinSFX32(M) においては， 書庫に "$" の名前のファイルが格納されていると，
  そのファイルを設定ファイルとみなして，その内容に従って各種の処理を行いま
  す。EasyMelt95 と LHMelt 用に追加した機能なので簡単な設定しか行えません。
  複雑な処理を行いたい場合は，市販のインストーラ等を使用してください。

  　Ver 2.63 以降で作成される WinSFX32U は Unicode 対応版となっていますが，
  設定ダイアログ等で入力された文字列については，下位互換性を保つため (実行
  ファイルから直接情報を読み取っているアプリが存在します) ANSI へ変換した
  上で記録されています。Unicode 文字を必要とする場合は BOM が付加された
  UTF-16LE 形式で $ ファイルの記述を行ってください。! ファイルについても同
  様です。


%2.  コマンドラインの様式

    $<command>=<setting>[,<setting>...]

  　行頭に '$' の文字があると，その行をコマンド行とみなします。 コマンド名
  は大文字でも小文字でも構いません。 '$' とコマンド名，コマンド名と '=' の
  間にはスペースを入れないでください。

  　設定内容中のスペースは常に有効です。設定内容にセパレータ文字である ','
  を使いたいときは「"」で括るようにしてください。 括られた文字列を一つのパ
  ラメータとして扱うようになります。

  　UNLHA32.DLL Ver 1.54b 以降で作成される WinSFX32M は， 日本語版と英語版
  が統合されており，さらに Ver 1.55 以降では WinSFX32 についても統合されて
  います。これに伴い，"$EWindowTitle=" 等 'E' で始まるコマンドが追加されて
  います。 日本語環境では "$WindowTitle=" が，日本語以外の環境では
  "$EWindowTitle=" がそれぞれ有効となります。 双方の環境で使用されることを
  前提とする場合は，"$WindowTitle="，"$EWindowTitle=" の両方を指定しておく
  必要があります。


%3.  コマンドの詳細

    $WindowTitle=<タイトル文字列>
    $EWindowTitle=<タイトル文字列>

      　SFX ダイアログのタイトルを指定します。 SFX 作成時に表示される  SFX
      設定ダイアログでの指定は無視されます。文字列は '\0' を含めて 80 バイ
      ト以内にしてください。 ただし，ダイアログのサイズの関係上， 実際には
      40 文字程度までしか表示されません。

      　英語環境用コマンドは，WinSFX32M 2.70，WinSFX32 2.16 以降で使用でき
      ます。

    $InstallTitle=<タイトル文字列>
    $EInstallTitle=<タイトル文字列>

      　展開先指定エディトボックスのタイトル文字列を指定します。SFX 設定ダ
      イアログでの指定は無視されます。文字列は '\0' を含めて 80 バイト以内
      にしてください。ただし，ダイアログのサイズの関係上，実際には 40 文字
      程度までしか表示されません。

      　英語環境用コマンドは，WinSFX32M 2.70，WinSFX32 2.16 以降で使用でき
      ます。

    $InstallDir=<展開先初期値>
    $EInstallDir=<展開先初期値>

      　展開先指定エディトボックスの初期値を指定します。
      　英語環境用コマンドは，WinSFX32M 2.70，WinSFX32 2.16 以降で使用でき
      ます。

    $Flag=<フラグ>

      　自己解凍書庫の動作を指定します。フラグは次の値の組み合わせです。指
      定については，一括でも個別でもどちらの指定方法でも構いません。
      　なお，定義名は参考であって，実際の指定は数値で行ってください。

        SFXFLAG_AUTO             (1) : 自動実行する
        SFXFLAG_OVERWRITE        (2) : 上書き確認の抑制
        SFXFLAG_CHECKTIME        (8) : タイムスタンプを無視
        SFXFLAG_ATTRIBUTE       (16) : 属性を展開
        SFXFLAG_NO_AUTO        (256) : 自動実行しない
        SFXFLAG_NO_OVERWRITE   (512) : 上書き確認する
        SFXFLAG_NO_CHECKTIME  (2048) : タイムスタンプをチェック
        SFXFLAG_NO_ATTRIBUTE  (4096) : 属性を展開しない

        例 : $Flag=19
             『自動実行』『上書き確認抑制』『属性を展開』
             を有効にする

    $ClassTitle=<タイトル>[,<フラグ>]                    [WinSFX32M 専用]
    $EClassTitle=<タイトル>[,<フラグ>]                   [WinSFX32M 専用]

      　関連付けを行うことを指定し，関連付け指定チェックボックスのタイトル
      を指定します。必ず次の Class コマンドとセットで指定してください。
      フラグ指定を追加することで，ダイアログでのチェック状態の省略値を指定
      することができます。省略又は 1 でオン，0 でオフとなります。 タイトル
      は '\0' を含めて 80 バイト以内にしてください。

        例 : $Classtitle=LZH 書庫の関連付け,1
             LZH 書庫の関連付けを行うことを指定。初期値はチェック状
             態

      　英語環境用コマンドは WinSFX32M 2.70 以降で使用できます。

    $Class=<拡張子>,<タイトル>,<ファイル>,<キー>[,<ID>]  [WinSFX32M 専用]
    $EClass=<拡張子>,<タイトル>,<ファイル>,<キー>[,<ID>] [WinSFX32M 専用]

      　実際の関連付けの設定内容を記述します。この指定で行われる関連付けは，
      DDE 等によるものではなく，単純なコマンドライン指定のものです。複数指
      定が可能ですが，個別の関連付けの有無が指定できない点に注意してくださ
      い。

        拡張子   :      関連付けを行う拡張子を指定します。 必ず '.' から始
                        めるようにしてください。
        タイトル :      関連付けの説明文を指定します。 '\0' を含めて 80 バ
                        イト以内にしてください。
        ファイル :      実際に関連付けるプログラムのファイル名を指定します。
                        パス名は指定する必要がありません。展開先のパス名が
                        自動的に付加されます。
        キー     :      レジストリーへの登録に使用するキーを指定します。
        ID       :      使用するアイコンの  ID (ただし数値のみ) を指定しま
                        す。2.84.0.1 以降で指定が可能です。

      　実際には HKEY_CLASS_ROOT に以下のキーが作成されます。

            キー                      | 値（すべて文字列）
            --------------------------+-------------------
            <拡張子>                  | <キー>
            <キー>                    | <タイトル>
            <キー>\shell\open\command | <ファイル> "%1"
            <キー>\DefaultIcon        | <ファイル>,-<ID>

      　さらに， UNLHA32.DLL Ver 1.98 以降で作成される WinSFX32M 2.81 以降
      の自己解凍書庫では，関連付けのバックアップ用に以下の名前による値が作
      成されます。既に <キー> の名前による値が作成されていた場合には，値の
      上書き作成は行われません。

            キー      | 名前   | 値（すべて文字列）
            ----------+--------+-------------------------------
            <拡張子>  | <キー> | 以前の関連付け (標準キーのみ)

        例 : $Class=.LZH,LZH 書庫,LHMELT.EXE,LZH_LHMelt,101
             LZH 書庫を LHMelt に関連付け

      　英語環境用コマンドは WinSFX32M 2.70 以降で使用できます。

    $AskRegist=<flag>                                    [WinSFX32M 専用]

      　上記の $Class コマンドで複数の関連付けを行う場合に，個々の関連付け
      の有無を問い合わせるか否かを指定します。<flag> の値に関係なく， この
      コマンドを記述することにより問い合わせを行わせることができます。

    $GroupTitle=<タイトル>[,<フラグ>]                    [WinSFX32M 専用]
    $EGroupTitle=<タイトル>[,<フラグ>]                   [WinSFX32M 専用]

      　スタートメニューへの登録を行うことを指定し，メニュー登録チェックボッ
      クスのタイトルを指定します。 Win32s 等ではグループの作成になります。
      必ず次の Group コマンドとセットで指定してください。 $ClassTitle と同
      じく，フラグ指定でダイアログの初期値の設定が可能です。

        例 : $GroupTitle=スタートメニューへ登録
             スタートメニューへの登録を行うことを指定

      　英語環境用コマンドは WinSFX32M 2.70 以降で使用できます。

    $Group=<グループ>,<タイトル>,<ファイル>,[<ファイル2>[,<ID>]]
                                                         [WinSFX32M 専用]
    $EGroup=<グループ>,<タイトル>,<ファイル>,[<ファイル2>[,<ID>]]
                                                         [WinSFX32M 専用]

      　スタートメニューやグループへの登録を行います。 $GroupTitle= 等が指
      定されていないと無効になります。

        グループ  :     メニューのタイトルを指定します。実際には，ここで指
                        定した名前のフォルダが "プログラム" フォルダ上に作
                        成されます。
        タイトル  :     アイコン・タイトルを指定します。 '\0'  を含めて 80
                        バイト以内にしてください。
        ファイル  :     アイコンとして登録するファイルを指定します。
                        ユーザが指定した展開先が，この指定での基準ディレク
                        トリとして扱われます。
        ファイル2 :     登録するものと別のファイルのアイコンを使用したい場
                        合に，そのファイルを指定します。 ただし，"ファイル"
                        で指定したファイルと同じディレクトリー上に存在する
                        必要があります。単なる手抜きです。(笑)
        ID        :     使用するアイコンの  ID (ただし数値のみ) を指定しま
                        す。2.70.1.7 以降で指定が可能です。

        例 : $Group=UNLHA32,はじめに,UNLHA32.TXT
             スタートメニューに UNLHA32 メニューを追加し， UNLHA32.
             TXT を『はじめに』のタイトルで登録

      　英語環境用コマンドは WinSFX32M 2.70 以降で使用できます。

    $Command=<コマンド>
    $ECommand=<コマンド>

      　展開後実行コマンドを指定します。SFX 設定ダイアログでの指定は無視さ
      れます。ShellExecute() API を使用しているので， 関連付けされているの
      であればファイルを直接指定することも可能です。

        例 : $Command=UNLHA32.TXT
             UNLHA32.TXT を表示。関連付けを使用しているので，当然な
             がら .TXT が関連付けされていない場合はエラーとなる

      　指定するコマンド列で '"' の文字を使いたい場合は， 『""』としてくだ
      さい。

        例 : $Command="notepad.exe ""Long Name.txt"""
             『Long Name.txt』をメモ帳で開く。

        例 : $Command=notepad.exe "Long Name.txt"
              こちらは失敗例。'"' はセパレータ (',') 無効化のための
              エスケープ文字として働くので， システムに渡されるのは
              『notepad.exe Long Name.txt』である点に注意。

      　英語環境用コマンドは，WinSFX32M 2.70，WinSFX32 2.16 以降で使用でき
      ます。

    $SetReg=<キー>,<サブキー>,<名前>,<タイプ>,<値>

      　レジストリーを設定します。簡易的なものである点に注意してください。

        キー     :      レジストリーのルートを指定します。HKEY_CURRENT_
                        USER を示す  'C' と HKEY_LOCAL_MACHINE  を示す 'L'
                        が指定できます。
        サブキー :      作成するキーを指定します。
        名前     :      設定する値の名前を指定します。
        タイプ   :      値の種類を指定します。 REG_SZ を示す  'S' と  REG_
                        DWORD を示す 'D' が指定できます。
        値       :      実際に設定する値を指定します。

        例 : $SetReg=C,Software\micco\LHMelt\Info,Ver,D,01180114
             LHMelt 用のレジストリーにバージョン情報を設定

      　このコマンドは WinSFX32M 2.70，WinSFX32 2.16 以降で使用できます。

    $Uninst=<タイトル>,<コマンド>                        [WinSFX32M 専用]
        <Windows 95/98/SE/Me，Windows NT 4.x/2K/XP/Vista のみで機能>

        アンインストール情報 (アプリケーションの追加と削除) の登録を行いま
      す。当然ながらアンインストール用のプログラムが用意されている必要があ
      ります。Win32s 環境上では無効となります。

        実際には HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVer-
      sion\Uninstall 下に <タイトル>  名のキーが作成されタイトルとコマンド
      が登録されます。

        例 : "$Uninst=LHMelting,%WinDir%\DELREG.EXE" を指定

                <キー> : 〜\CurrentVersion\Uninstall\LHMelting を作成

                <名前>                    | 値（すべて文字列）
                --------------------------+-------------------
                DisplayName               | LHMelting
                UninstallString           | C:\WINDOWS\DELREG.EXE

      　このコマンドは WinSFX32M 2.70 以降で使用できます。

    $UseInf=<inf ファイル>                               [WinSFX32M 専用]
    $EUseInf=<inf ファイル>                              [WinSFX32M 専用]
        <Windows 95/98/SE/Me，Windows NT 4.x/2K/XP/Vista のみで機能>

      　inf ファイルを利用してインストールを行います。 NT，9x 系の双方に対
      応した inf ファイルを使用する必要があります。 展開先ディレクトリーに
      固定されていますので，パス情報を付加しないように注意してください。
      Windows 95 及び Windows NT 4.0 以降で有効となります。

        例 : $UseInf=UNLHA32.INF
             UNLHA32.INF を利用してインストールを行う

      　このコマンドは WinSFX32M 2.71 以降で使用できます。

    $sCopy=<コピー元>,<コピー先>                         [WinSFX32M 専用]
        <Win32s，Windows NT 3.6x のみで機能>

      　指定されたファイルのコピーを行います。コピー先について，パスのみで
      はなくファイル名まで指定する必要がある点に注意してください。

        例 : $sCopy=UNLHA32.DLL,%SystemDir%\UNLHA32.DLL
             UNLHA32.DLL をシステムディレクトリーにコピー

      　このコマンドは WinSFX32M 2.71 以降で使用できます。

    $sRun=<実行プログラム>                               [WinSFX32M 専用]
        <Win32s，Windows NT 3.6x のみで機能>

      　指定されたプログラムを実行します。 $Command と異なり，必ず実行ファ
      イルを指定する必要があります。

        例 : $sRun=INST.EXE
             INST.EXE を実行

      　このコマンドは WinSFX32M 2.71 以降で使用できます。

    $Language=<言語 ID>

      　基本となる言語を指定します。環境がここで指定されたものと同じ言語で
      あれば $Command 等 'E' の付加されていないコマンドが， 異なった言語で
      あれば $ECommand 等 'E' の付加されたコマンドが有効となります。また，
      LANG_JAPANESE が指定されると日本語で，それ以外が指定されると英語で表
      記されるようになります。
      　ここでの指定が行われていない場合の初期値は，LANG_JAPANESE (日本語)
      です。

      　このコマンドは WinSFX32M 2.71，WinSFX32 2.16 以降で使用できます。

    $Delfile=<削除ファイル>

      　指定されたファイルを削除します。各コマンドが連続して実行されること
      から，『$sRun での実行に使用した作業ファイルを削除する』といったよう
      な用途には使えないので，注意してください。

      　このコマンドは WinSFX32M 2.80.4.11 以降で使用できます。


%4.  ディレクトリー指定変数文字列

  　展開先や格納ファイルのパスとして指定できる変数としては，次のものがあり
  ます。

    %WORK%          基本的にはシステムが認識するワーク・ディレクトリーを使
                    用します。 具体的には COMMAND.TXT の環境変数の項目を参
                    照してください。
    %WinDir%        Windows ディレクトリーを指定します。
    %SystemDir%     Windows のシステムディレクトリーを指定します。
    %WinRoot%       Windows がインストールされているドライブのルートディレ
                    クトリーを指定します。
    %ProgramFiles%  Windows 95 や Windows NT 4.0  等でシステムが認識してい
                    るプログラム・ディレクトリーを指定します。 Win32s 等の
                    環境では Windows がインストールされているドライブのルー
                    ト・ディレクトリーを指定したことになります。 WinSFX32M
                    専用です。
    %Documents%     当該ユーザの『マイドキュメント』を指定します。  Win32s
                    では無視されてカレントディレクトリー扱いとなります。
    %Desktop%       当該ユーザの『デスクトップ』を指定します。 Win32s では
                    無視されてカレントディレクトリー扱いとなります。
    %Search%        ファイルを検索します。 検索には API の SearchPath() が
                    使われます。ファイルが見つからなかった場合には %System-
                    Dir% を指定したものとみなされます。 DLL 等のインストー
                    ルに使用するもので，普通は展開先としてではなく，格納
                    ファイルのパス情報として使用されることになります。

    　これらの変数を格納ファイルのパス情報として使用した場合は，SFX 設定ダ
    イアログで「ディレクトリー付き」を指定する必要があります。 また， Win-
    SFX32(M)  以外ではこれらの変数を認識できない点にも注意する必要がありま
    す。


%5.  "$" ファイルの例

--------------------------------------------------------------------------
;  　DLL のインストールにパス指定の %Search% が使われているので， SFX 作成
;  時には "x" 指定を行うこと。
;  　インストール時の説明は "!" によるメッセージで行う。

$WindowTitle=Easy Melting 95のｲﾝｽﾄｰﾙ
$InstallTitle=Easy Melting 95をｲﾝｽﾄｰﾙするﾌｫﾙﾀﾞ(&D)
;  　ダイアログが固定サイズであることから， これらのタイトルはせいぜい  40
;  文字 (半角) が限度。

$InstallDir=%ProgramFiles%\EZMelt95
;  　C:\Program Files\EZMelt95 を想定。 UNLHA32.DLL についてはパス情報とし
;  て %Search% を指定してあるので，通常は C:\WINDOWS\SYSTEM にインストール
;  される。

$ClassTitle=Easy Melting 95を書庫に関連付け(&R)
$Class=.LZH,LZH書庫,EZMELT95.EXE,LZH_EZMelt
;  　UNLHA32.DLL がバンドルされるので，LZH のみ関連付けを行う。

$GroupTitle=Easy Melting 95をｽﾀｰﾄﾒﾆｭｰに登録(&S)
$Group=Easy Melting 95,Easy Melting 95,EZMELT95.EXE,
$Group=Easy Melting 95,Easy Melting 95 について,EZMELT95.TXT,
$Group=Easy Melting 95,Easy Melting 95 ヘルプ,EZMELT95.HLP,
;  　"Easy Melting 95" のサブメニューを作成し， 本体，ドキュメント，ヘルプ
;  の３つを登録。

$Command=EZMELT95.TXT
;  　ドキュメントを関連付け起動で表示。関連付けが解除されている場合を想定
;  していない。(笑)
--------------------------------------------------------------------------
