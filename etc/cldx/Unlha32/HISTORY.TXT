Mar.13,1995  Ver 0.01   ・最初のプロトタイプ完成。
            (Ver 0.09)
Mar.26,1995  Ver 0.02   ・UnlhaCheckArchive() で CHECKARCHIVE_FULLCRC モードを
            (Ver 0.11)    使用すると一般保護エラーとなっていたバグを修正した。
                        ・解凍時において，CRC エラーが生じた場合にはファイルの
                          削除確認メッセージを表示するようにした。'P' コマンド
                          時にも確認メッセージを表示するようになっている(UNLHA.
                          DLL Ver 0.12 相当)。
                        ・"-+" オプション指定時， 解凍先ディレクトリーを指定し
                          ない場合にカレントディレクトリーに解凍できなかったバ
                          グを修正した。
                        ・'P' コマンドの場合に CRC  の計算がされていず必ず CRC
                          エラーとなってしまっていたバグを修正した。
Mar.30,1995  Ver 0.02a  ・ドキュメントの整備。
Apr. 1,1995  Ver 0.03   ・制限付きでロングファイル名に対応した（半角スペースを
            (Ver 0.12)    使ったファイル名には未対応）。
                        ・OS No. 取得ルーチンのバグフィクス。
                        ・タイムスライス明け渡し時のメッセージ処理の改善。
Apr. 2,1995  Ver 0.04   ・"'" で括ることによりスペースを使ったファイル名も扱え
                          るようにした。
Apr. 5,1995             ・'"' で括るように変更した。
Apr.10,1995  Ver 0.05   ・FV32 1.4  においてスペースを使ったファイル名の書庫が
                          扱えるようにファイル名認識ルーチンを改良した。
                        ・ヘッダを誤認識する場合があったので，ヘッダ認識ルーチ
                          ンを改善した($Win16-Ver 0.13 相当）。
Apr.12,1995  Ver 0.06   ・書庫によってヌルポインタ参照によりエラーとなってし
                          まっていたバグを修正した。
                        ・解凍先ディレクトリー名がスペースを含むものである場合
                          にも正常に認識できるようにした（FV32 1.4 下）。
Apr.12,1995  Ver 0.07   ・普通の FAT  ファイルシステム上でスペースを含むファイ
                          ル名を扱った場合のスペースの切詰処理を追加した。これ
                          によりＮＴでのＦＤや Win32s 下においてもスペースを含
                          むファイル名を扱えるようになった。
Apr.13,1995             ・解凍先ディレクトリー名にスペースが含まれ， 更に .lzh
                          の拡張子が省略されている場合にも正常に書庫ファイル名
                          を認識できるようにした。
Apr.14,1995 (Ver 0.14)  ・レスポンスファイルの仕様を Lha と同等のものとした。
                        ・FAT の場合の変換処理で '..\'  等のディレクトリー指定
                          を扱えなかったものを改善した。
Apr.17,1995             ・OpenArchive() 系で FileInfo メンバーに正常に値が書き
                          込めていなかったバグを修正した。
Apr.18,1995             ・リソースの一部修正。
Apr.26,1995  Ver 0.08   ・Ver 0.07 での変更のため， UnlhaCheckArchive() 時に書
                          庫を開けず必ず FALSE  を返してしまっていたバグを修正
                          しました。
May.19,1995  Ver 0.08a  ・複数のプロセスから呼ばれるとアクセス違反を起こしてし
                          まっていたものを修正した。
Jun. 3,1995  Ver 0.09   ・ディレクトリー付き解凍のデフォルトが「相対ディレクト
            (Ver 0.16)    リー」となってしまっていたものを修正した。
Jun. 5,1995  Ver 0.10   ・レジストリーを使用するように変更。
                        ・解凍ファイルの合計を 100% として進捗グラフを表示する
                          モードを追加。(Ver 0.15)
Jun. 8,1995  Ver 0.10a  ・ディレクトリー作成関係をランタイムライブラリを使用せ
                          ずに Win32 API を使用するように変更。
Jun. 9,1995  Ver 0.10b  ・UnlhaConfigDialog() に Ver 0.10 で追加した機能につい
                          ての項目を追加。
                        ・sprintf() を全て wsprintf() に変更。
                        ・一部 _lwrite() 等を使用していたものを WriteFile() に
                          変更。
                        ・解凍先取得ルーチンで末尾の '\0' を書き込んでいなかっ
                          たので，静的リンクによる仕様の場合に解凍先が正常に取
                          得できなくなっていたバグを修正した。
Jun.11,1995  Ver 0.11   ・細かな改良。
Jul.18,1995  Ver 0.12   ・ファイル名照合ルーチンのバグ修正。

  UNLHA32.DLL(New Version)
------------------------------------------------------------------------------
Sep.28,1995  Ver 0.19   ・圧縮に対応。 どうにか形になった。Win32SFX にはまだ未
                          対応である。基本的に UNLHA.DLL Ver 0.41 相当になって
                          いる。
Sep.29,1995             ・各種バグフィクス。いっぱいありすぎて覚えていない。
Sep.30,1995             ・'P' コマンド関係バグフィクス。
                        ・WinSFX  関連ダイアログのリソースを入れわすれていたバ
                          グフィクス。ダイアログが表示されないはずだわ。(^^;)
Oct. 2,1995  Ver 0.19a  ・スペースを含むファイル名の場合に圧縮・解凍ができな
                          かったものを改善した。
                        ・ファイル名照合ルーチンのバグフィクス。
                        ・メモリーへの copyfile() でバッファが足りない場合の処
                          理のバグフィクス。
Oct. 2,1995  Ver 0.19b  ・圧縮時に状況ダイアログで処理ファイル数を表示するよう
                          にした。
Oct. 3,1995             ・書庫ファイル名取得ルーチンの見直し。FV32 で圧縮を
                          行った場合に書庫ファイル名を誤認識しないようにした。
                          ただし，この変更により，スペースを含んだファイル名の
                          書庫を扱う場合には， 必ず「"」で括る必要がある仕様と
                          なっている（実際は基本ディレクトリーが指定されている
                          場合には括る必要はない)。
                        ・開放したポインタに関するフラグの設定が不完全だったた
                          め，エラー時に不正なポインタでメモリーを開放しようと
                          してしまっていたバグを修正した。
Oct. 4,1995  Ver 0.19c  ・WinSFX32 に対応した。WinSFX32 では h2 形式ヘッダなの
                          で，Win32s 環境で作成する場合には， 環境変数「TZ」の
                          設定を必ず行っておく必要がある。
                        ・書庫ファイル名取得ルーチンの改良。 「"」で括られてい
                          ない場合でも正常に取得できないかあがいている。(笑)
                        ・-jw スイッチと -gw  スイッチが排他的になっていなかっ
                          たバグを修正。
Oct. 4,1995  Ver 0.20   ・UnlhaGetSubVersion() の API を追加。
                        ・SFX 作成時に上書き確認が行われなかったバグを修正し
                          た。
                        ・SFX 作成時に構造体の値をクリアしていなかったために，
                          SFX 内に無意味なゴミが書き込まれてしまっていたバグを
                          修正した。
                        ・"-t"  オプション時にタイムスタンプの初期化を行ってい
                          なかったために，タイムスタンプがおかしくなってしまっ
                          ていたバグを修正した。
Oct. 7,1995  Ver 0.21   ・Win32s  以外の環境でも正しくタイムゾーンの変換が行わ
                          れるようにした。 これにより，Win32s 以外の環境では環
                          境変数 TZ を使用する必要がなくなった（注意：BC++  の
                          dostounix()，unixtodos() はヘルプ等の説明とは異なり，
                          実際には UTC←→ローカルタイム の変換を行う）。
                        ・SFX 書庫に対する書庫操作を行うと，ヘッダ形式が変わっ
                          てしまい，正常に解凍が行えなくなってしまっていたバグ
                          を修正した。
Oct. 8,1995  Ver 0.22   ・ファイル名コンバートルーチンのバグフィクス（'/' をパ
                          ス・セパレータとして認識していなかったために，ファイ
                          ル名が３文字に切り詰められてしまっていた。FAT 以外で
                          は発生しない…｡)。
Oct. 9,1995  Ver 0.23   ・解凍時のメッセージループのタイミング見直し(Win32s 以
                          外の場合について)。
Oct.10,1995             ・引き続き解凍時のメッセージループのタイミング見直し。
                          （Win32s の場合。Win32s 以外の場合については取り敢え
                          ず元に戻した）
                        ・レジストリーの Version 項目について， キーが "UNLHA"
                          になっていたバグを修正。
                        ・メッセージ等のタイトルが  "UNLHA" のままであった部分
                          を修正。
Oct.11,1995             ・CreateFile()  時のエラーチェック方法の間違いの修正。
                          NULL でエラーの判断をしてしまっていた。
Oct.12,1995             ・書庫操作の途中で中止した場合に，作成途中の書庫が残っ
                          てしまうことがあったバグを修正した。
Oct.14,1995             ・書庫ファイル名に拡張子を指定しなかった場合には，必ず
                          ".lzh" の拡張子を追加するようにした。
                        ・ヘッダ認識ルーチンで strlen() が一般保護エラーを起こ
                          す場合があったバグを修正した（書庫以外のファイルを書
                          庫として指定された場合）。
                        ・圧縮時のファイルサーチ時の漢字２バイト目の  '\' のバ
                          グフィクス。
                        ・"DirectoryMode" 及び "ExtractAttribute" の設定の取得
                          が間違っていたバグを修正した。
Oct.15,1995  Ver 0.24   ・ファイル名に '/' が含まれていると正常に解凍できなかっ
                          たバグを修正した。 UNLHA.DLL Ver 0.37 で対処したもの
                          と同じ。ロングファイル名関連の処理との絡みで不具合が
                          出る可能性があったので，このバージョンまで，あえてこ
                          の関係の部分をコメントアウトしていた。
                        ・ヘッダファイルでの宣言の変更。プログラマの皆さん，ご
                          めんなさい。でも，この変更は要望も出ていて，しかもご
                          もっともな意見でしたので…。

  UNLHA32.DLL(NT Version)
------------------------------------------------------------------------------
Oct.15,1995  Ver 0.25   ・圧縮ルーチンの I/O  書き込み部分についてマルチスレッ
                          ド化を行った。でも，書き込みキャッシュが効くので，ほ
                          とんど変わらないようである。(^^;)
                        ・引き続き読み込み部分についてもマルチスレッド化を行っ
                          た。先読み機能の関係で殆ど効果はみられない。(^^;)
                          上記２点については，メモリーの使用状況の関係でキャッ
                          シュ等が利かない場合には有効なので，そのまま実装して
                          おく事とする。
Oct.17,1995             ・Encode_Read() のバグフィクス。読み込み時にデータの配
                          列が変わってしまっていた。(^^;) なお，現バージョンで
                          はイベント等のエラー処理は手抜きしたままである。(^^;)
                        ・"-jyn-" といった '-'  による指定を行ったスイッチを正
                          しく判別できなかったバグを修正した。
                        ・エラー時の解放バッファのポインタ指定を間違えていたた
                          めに一般保護エラーとなってしまっていたバグを修正し
                          た（0.25.0.2 関係）。
Oct.18,1995             ・LHA32 Ver 2.67.32.00 でのスイッチの仕様に合わせて，
                          UNLHA32.DLL のスイッチの既定値と動作の変更を行った。
Oct.20,1995             ・イベント及びスレッドの作成が失敗した場合の処理を手抜
                          きしていた点を改善した。(^^;)
Oct.22,1995             ・書庫が見つからない場合と開けない場合でエラーコードを
                          区別するようにした。
                        ・ファイル名取得ルーチンの改善。
Oct.24,1995  Ver 0.26   ・エラー時に一部メモリーを重複して解放していたバグを修
                          正した。
Oct.25,1995             ・UnlhaCheckArchive() でスペースを含むファイル名の書庫
                          を扱えなかったバグを修正した。
Oct.26,1995             ・OpenArchive() で， 書庫の文字列が「"」で括られている
                          と書庫を開くことができなかったバグを修正した。
                        ・950922 でのファイル名取得ルーチンのバグフィクス。
Oct.31,1995  Ver 0.27   ・書庫指定で拡張子が省略された場合において，指定どおり
                          の省略された拡張子をもつファイルが既に存在している場
                          合には，拡張子の付加を行わないようにした。
                          （非公開。えむ氏に送付）
Nov. 4,1995  Ver 0.28   ・解凍状況ダイアログのリソースの修正。
Nov. 8,1995             ・Mydostounix() のバグフィクス。このため，月によっては
                          変換時に日付が一日ずれてしまっていた。
Nov. 8,1995  Ver 0.29   ・FV  モード時の解凍状況表示では進捗率をグラフのみで示
                          すようにした。
Nov.17,1995             ・inithdr() ルーチンのバグフィクス。
Nov.20,1995  Ver 0.30   ・unix←→dos 変換ルーチンのバグフィクス。
Nov.23,1995  Ver 0.31   ・↑…まだ直ってなかったの…。(:_;)  Ver 0.30 でもそう
                          だったけど，2000 年以降だと大丈夫なんだよね。(^^;)
                          2000 年を基準としていたため， それ以前に関しては減算
                          基調になっていたのが原因。そのため，基準を 2000 年と
                          1972 年の２つに分けて， すべて加算基調で行うようにし
                          た。
Nov.26,1995  Ver 0.32   ・2037 年以降だとタイムスタンプの変換時にオーバーフロー
                          を起こしてしまっていたバグを修正した。
Dec. 9,1995             ・書庫のタイムスタンプ変更時に，書庫ファイルを開けない
                          と一般保護エラーになってしまうことがあったバグを修正
                          した。
                        ・UNC 関連の不具合の悪あがき。でも結果は同じだったので
                          元に戻した。(笑)
Dec.10,1995             ・何と，ディレクトリー付き書庫の場合に，ファイル名だけ
                          の指定での選択が行えていなかった大バグを修正。はて？
                          でも大昔は行えていたような…。(^^ゞ
Dec.19,1995  Ver 0.33   ・大文字・小文字を区別しないモードにもかかわらず，別の
                          ファイルとして圧縮されてしまっていたバグを修正した。
Dec.20,1995             ・圧縮状況ダイアログにおいて，'f' コマンド時のファイル
                          名のパスセパレータが '/' で表示されるように改善。
                          ワークファイルの書き戻し時のパスについても同様。
Dec.24,1995  Ver 0.34   ・コンパイラーを変更したことに伴う修正。
                        ・不必要な代入を行っていた箇所を削除。
Dec.25,1995             ・Ver 0.33  でワークファイルの書き戻しルーチンを変更し
                          た際に，ワークファイルが残ってしまうバグを埋めこんで
                          しまっていた点を修正。（と，言うよりも，バグ付きだっ
                          たルーチンを通るようになってしまった。^^;）
Dec.28,1995             ・ディレクトリー付き情報付きの場合にスペースを含むファ
                          イル名だとマッチしなかったバグを修正した。
Dec.30,1995  Ver 0.35   ・makecrc()，fillbuf() 等の手直し。
Dec.31,1995             ・Ver 0.33  でオプションを書庫ファイルに誤認識するバグ
                          を埋めこんでしまっていたものを修正。
Jan. 1,1996             ・calccrc()，fillbuf(), getbits() を手始めにアセンブラ
                          化した。(^^;)
Jan. 8,1996  Ver 0.36   ・Win95 の場合に進捗バーが３Ｄ表示されるようにした（NT
                          版のみ)。
Jan.11,1996             ・ウィンドウズのバージョン取得方法の変更。
                        ・ケース変換の改善。
Jan.12,1996             ・FileSearchSub() 内でファイルリストの内容をそのまま
                          扱ってしまっていたために，一般保護エラーになってし
                          まっていたバグを修正した。
Jan.13,1996  Ver 0.37   ・書庫名取得ルーチンの改良（'"' で括られていない場合の
                          悪あがき。(^^;)
Jan.21,1996             ・コマンド文字列取得方法を基本的に LHA32  に合わせた。
                          このため， これまでの「"」で括られていない場合の悪あ
                          がきは一切無効となっている。 必ず「"」で括ること。
                          これに伴い，ファイルの指定数は malloc() の限界まで可
                          能となっている（レスポンスを使った場合）。また，レス
                          ポンスファイルの位置や指定の制限が緩和された。 "-jx"
                          スイッチでのファイルリストについても同様。
                        ・endpat()  でディレクトリー文字列のポインタを解放し忘
                          れていたバグを修正。
                        ・960121-1 での変更で，命令の省略が行えなくなってしまっ
                          ていたバグを修正した。
Jan.22,1996             ・960121 での変更のために，基準ディレクトリーのみでファ
                          イル指定がされなかった場合に処理が行われなかったバグ
                          を修正した。
                        ・レジストリーキーの見直し。及び必要ないキーを作成しな
                          いようにした。
Jan.23,1996             ・lstr*() をすべて str*() を使用するように変更した。そ
                          う言えば， lstrcat() と strcat()  の仕様の違いで昔ハ
                          マったんだった。今のところ問題は出てなかったけど…。
                          (^^;)
                        ・Win32s での RegSetValue() において，サイズに末尾の
                          NULL も含めてしまっていたものを修正した。
Jan.24,1996             ・pat リストにおいて，pbuf については nxt メンバー以外
                          が無効である点を考慮していなかったバグを修正した。
                        ・"-z<extension>" を指定すると一般保護エラーとなってし
                          まっていたバグを修正した。 ついでに，仕様を LHA に合
                          わせた。
Jan.25,1996             ・test() において， lh5 形式以外の圧縮形式のテスト時に
                          辞書サイズを正しく渡していなかったバグを修正した。
                        ・"-y"  スイッチを指定しても削除確認がされてしまってい
                          たバグを修正した。
                        ・EXTRACTINGINFO  構造体のポインタの初期化を行っていな
                          かったバグを修正した。
Jan.26,1996             ・"-o0" を指定した場合には h2 形式ヘッダとするように仕
                          様を変更した。
                        ・'v' 命令で "-l2" を指定した場合にヘッダ形式と作成 OS
                          を表示するようにした。
Jan.27,1996             ・試しに VC++ 用のライブラリを作成してみた。一応手元の
                          VC++2.0J で作成して通ることを確認したんだけど…。
Jan.29,1996  Ver 0.38   ・endfpat() で pfbuf を解放するところを，間違って pflst
                          を解放していたバグを修正した。
Jan.30,1996  Ver 0.39   ・h3 形式ヘッダの読み書きを可能とした。 基本ヘッダと拡
                          張属性ヘッダに対応。拡張ヘッダについては NT で意味の
                          ある atime と ctime のみ読み書きを行っている。これに
                          伴い，h3 形式ヘッダを指定する "-h3" スイッチを追加。
                        ・短い(8+3 形式の)ファイル名で書庫に格納する  "-ji" ス
                          イッチを追加。
                        ・短いファイル名で指定された場合に，そのままの名前で書
                          庫に格納してしまっていた点を改善した。
Jan.31,1996             ・ファイルを読み込みオープンできない場合のエラーの値の
                          修正。
                        ・格納ファイルの更新・作成・アクセス日時を UNIX 形式で
                          返す UnlhaGetWrite[Create|Access]Time() を追加。現在
                          の仕様では DOS のタイムスタンプの精度であるが， 将来
                          的には改善の予定。
Feb. 1,1996             ・Win32s の場合や FAT の場合には必ず短いファイル名に変
                          換するようにした。 これに伴い，ConvFileName() につい
                          ては単純に GetShortPathName() を使うように変更した。
                        ・lh0 形式ヘッダの場合ではＯＳの情報が記録されていない
                          ため，常にホストチェックがエラーとなってしまっていた
                          点を改善した。
                        ・bFunctionList[] に 960131 での新 API を追加。
                          （宮内氏に送付）
Feb. 1,1996  Ver 0.39a  ・"-ji" を解凍時にも有効なように拡張。 VFAT や NTFS で
                          あっても短いファイル名で解凍する。ただし，すでにファ
                          イルが存在する場合は長いファイル名のままとなる。
                        ・解凍時のスキップ表示でファイル名が表示されない場合が
                          あったバグを修正した。
Feb. 2,1996             ・ヘッダ用のバッファを取り敢えず 8KB に拡張。 コメント
                          ヘッダの実験のため。(笑) 960201(0.39) でコメントヘッ
                          ダの読み込み自体は可能となっている。
                        ・initfpat()  で構造体の範囲を越えて書き込みを行ってし
                          まっていたバグを修正した。 ついでに，endpat() 等でメ
                          モリを解放する前に念を入れてヌルチェックを行うように
                          した。ルーチンに入る前にチェックを行っているので，本
                          来なら必要ないところではあるが…。(^^;)
                        ・コメント付けを行う 'c' 命令を追加。 これに伴い，コメ
                          ントをファイルで追加するための "-jz" スイッチと， コ
                          メントを表示するための "-ja" スイッチも追加してある。
Feb. 3,1996             ・"-h" スイッチ取得のバグフィクス。
                        ・960130 で，Level1 ヘッダの際に Level3 ヘッダ用のヘッ
                          ダサイズ項目まで書き込んでしまっていたバグを修正し
                          た。
                        ・lh5，lh6  で共用していた圧縮ルーチンの一部を個別のも
                          のとした。これにより，圧縮サイズは LHA32 と同じになっ
                          ている。
Feb. 4,1996             ・場合によって，ファイル読み込みスレッドがデッドロック
                          に陥ってしまうことがあったバグを修正した。
Feb. 5,1996             ・"-jh" スイッチを追加し， WindowsNT/95 専用の OS マー
                          クを書庫に付けられるようにした。ただし，マークは正式
                          決定のものではない。
Feb. 5,1996  Ver 0.40   ・メインバージョンを 0.40 とした。 サブバージョンは 0.
                          39 からのものに変更。
                        ・圧縮形式を指定する "-jm" スイッチを追加。
                        ・Huffman  バッファサイズを設定する "-je" スイッチを追
                          加。ただし，UNLHA32.DLL の仕様として，メモリーが足り
                          ない場合は 4096 bytes まで縮小される。DOS と違って，
                          そのようなことは殆どないと思うが…。(^^;)
Feb. 7,1996  Ver 0.41   ・'a'，'u'  命令時に更新されなかった格納ファイルについ
                          てのカウント表示がされなかったバグを修正した。
Feb. 8,1996            (・解凍時にメモリマップドファイルを使用してみたが，却っ
                          て遅くなってしまうので，元に戻した｡^^;)
Feb.18,1996             ・条件付きコンパイルで英語版を作成可能なようにした。現
                          在の版では，SFX については非英語化。
                        ・960207 でフィクスしきれていなかったものを修正した。
Feb.19,1996             ・メッセージの変更。
Feb.21,1996             ・圧縮・解凍時に１ファイルの処理の終了時にしか取消ボタ
                          ンが有効になっていなかったバグを修正した。むむ…，い
                          つからだろう？
                        ・スペースを含んだファイル名の格納ファイルの検索につい
                          てのバグフィクス。
Feb.23,1996             ・圧縮時のマッチファイル一覧作成で，ファイルネームの
                          バッファがロングファイルネームに対応していなかったた
                          め，一般保護エラーになっていたバグを修正した。
Feb.26,1996  Ver 0.42   ・"-a3" スイッチを追加。"-a2" と基本的に同じであるが，
                          ディレクトリーに対して常に lhd ヘッダを作成する。
                        ・"-lhd-" の格納ファイルについて，圧縮時にマッチせず常
                          に追加されてしまっていたバグを修正した。
Feb.27,1996             ・960226-2 の変更で， 反対に通常のファイルに関してマッ
                          チしなくなってしまっていたバグを修正した。
Mar. 5,1996             ・英語版でも iskanji()  を行ってしまっていたバグを修正
                          した。
                          (EZMELT95 Ver 0.05 用として YUPO さんにメール)
Mar. 8,1996             ・英語版用に WinSFX にパッチを当てた。また，英語版につ
                          いても，ファイル名・モジュール名を UNLHA32  のままと
                          するようにした。
Mar.11,1996             ・Ver 0.37 での変更のため， SFX 作成時のディレクトリー
                          指定が無効になってしまっていたバグを修正した。
Mar.13,1996             ・'d' 命令時に "*.*" が指定された場合には， 削除確認を
                          するようにした。
                        ・'a'，'u'，'m'，'d'，'l'  コマンド時の "-jn" スイッチ
                          に対応。
                        ・空き容量チェックがオフになっている場合に，解凍のため
                          の空き容量が不足した場合には，処理を続けるか問い合わ
                          せるようにした。
                        ・古いタイムスタンプのものを選択するための "-u2"，"-f2"
                          スイッチを追加。
Mar.14,1996             ・'s' コマンド時のエラーにおいて，エラーログが出力され
                          ていなかったバグを修正した。
                        ・'-+' スイッチが機能していなかったバグを修正した。
Mar.16,1996             ・set_ftime_mode() において， fopen() で開いたファイル
                          に対して fileno() でハンドルに変換しタイムスタンプの
                          処理を行っていたため，場合によってはストリームバッフ
                          ァの確保ができずに  fopen() でお亡くなりになる場合が
                          あったので，open() を使用するようにした。
                          それにしても，DMLHA.DLL を LHUT で動作させていてこの
                          バグが発見できるとは…。(^^;;
Mar.30,1996  Ver 0.43   ・'l' 命令で，常に "-jn" スイッチ用のファイル存在チェッ
                          クが有効になってしまっていたバグを修正した。
Apr. 4,1996  Ver 0.44   ・圧縮時の作業ファイルコピーにおける空き容量チェックに
                          ついて，元の書庫のサイズを考慮していなかったバグを修
                          正した。
                        ・一部のアトリビュート設定やサイズ取得について  API を
                          使用するように変更した。
Apr. 7,1996  Ver 0.45   ・中断メッセージの修正。及び自己解凍書庫作成時のログ表
                          示とダイアログタイトルの改善(WinSFX，WinSFX32 の区
                          別を付けた)。
Apr.19,1996             ・ワークファイル名について LHA Ver 2.54 以降の仕様に合
                          わせた。
Apr.25,1996             ・ホストチェックのバグフィクス。 Ver 0.39 で直したつも
                          りでいたが，直っていなかった。(^^;;
Apr.30,1996             ・UNLHA32.DLL と UNLHA32S.DLL のソースを統合した。これ
                          のおかげで若干の UNLHA32S.DLL のバグが発覚。(笑)
                        ・解凍ファイルをディレクトリー付きで指定した場合に，拡
                          張子のないファイルが解凍されなかったバグを修正した。
                          他にも "*." と指定した場合にも解凍されなかったことが
                          判明。(^^;)
                        ・ドライブレターを省略して絶対ディレクトリーでの圧縮を
                          行った際に，ディレクトリー情報が正しく作成されなく
                          なってしまっていたバグを修正した。 Ver 0.39 で埋めこ
                          んだらしい…。
May. 1,1996             ・解凍時の "-r1"  スイッチが正常に機能していなかったバ
                          グを修正した。
May. 3,1996  Ver 0.46   ・WinSFX 設定ダイアログを中止したにもかかわらず， 自己
                          解凍書庫作成の後処理を行ってしまっていたバグを修正し
                          た。
May. 6,1996             ・bUseInit2Mem がセットされた後にクリアを行ってしまっ
                          ていたため， UNARJCOMMAND が解放されていなかったバグ
                          を修正した。
                        ・"-gj" スイッチが無効になっていたバグを修正した。
May.13,1996             ・いらなくなった  lpExtList の宣言が残っていたものを削
                          除。
May.16,1996             ・UnlhaFindFirst() 等で，M_CHECK_ALL_PATH 関連のフラグ
                          が正常に設定されていなかったバグを修正した。
May.17,1996             ・M_CHECK_ALL_PATH  の関係で UNLHA32.DLL Ver 0.45 以降
                          で問題が出るアプリ対策として，レジストリーで問題を回
                          避できるようにした。
May.21,1996  Ver 0.47   ・不必要な変数が宣言されていたものを削除。
May.27,1996             ・960521 で GetCommand() のバグが表面化したため， 圧縮
                          ・解凍が正常に行えなくなってしまっていたものを修正し
                          た。
May.28,1996             ・"-s" スイッチを指定すると "-t" まで有効になってし
                          まっていたバグを修正した。
                        ・GetCommand()  関係で endpat() において不正なポインタ
                          で解放しようとしてしまうことがあったバグを修正した。
May.30,1996             ・引き続き不必要な変数を削除。
Jun. 4,1996             ・OpenArchive() 系 API で， 書庫のオープンに失敗すると
                          一般保護エラーになってしまうことがあったバグを修正し
                          た。
Jun. 7,1996             ・Init2() での  UNLHA32.DLL の動作チェックがいつの間に
                          か抜けていたバグを修正した。(^^;)
Jun.12,1996  Ver 0.48   ・M_INIT_FILE_USE を指定しなかった場合の処理のバグを修
                          正した。
Jun.27,1996             ・read_c_len() において， WORD で代入するところを BYTE
                          で代入していたため，書庫の解凍に失敗することがあった
                          バグを修正しました。
                        ・ＮＴ等絶対ディレクトリーでの解凍を行った場合に正しく
                          ディレクトリーの構築が行われなかったバグを修正した。
                        ・格納ファイルを指定のファイルで置き換える  "-jr" ス
                          イッチを追加した。
Jul. 5,1996  Ver 0.49   ・コメントファイルを指定した場合の，ファイル名記憶用の
                          バッファの解放を忘れていたバグを修正した。
                        ・コマンドラインからリネームする名前を指定するための
                          "-gr" スイッチを追加した。
Jul.26,1996             ・ようやく懸案事項の UNC を解決。 空き容量チェック等ま
                          だ修正箇所があるが，山は越した。(^^;)
Jul.27,1996             ・空き容量チェックに関しても UNC に対応。
Aug. 1,1996  Ver 0.50   ・ChangeSep() 等の NULL ポインタチェックが抜けていたバ
                          グを修正。
                        ・基準ディレクトリーを指定しなかった場合にディスク容量
                          チェックが行えなくなってしまっていたものを修正。
Aug. 3,1996  Ver 0.51   ・Unlha() でのバッファの 64KB の制限を外した。
Aug. 3,1996             ・UnlhaExtractMem() を追加。'p' コマンドを実行するだけ
                          だが，UnlhaCompressMem() と合わせるために実装。
Aug. 4,1996             ・UnlhaCompressMem() を追加。 メモリーバッファを圧縮し
                          て書庫に格納する。
Aug. 4,1996  Ver 0.60   ・UnlhaCompressMem() 等で， 書庫とファイルを別々のパラ
                          メータとしていたものを，Unlha() と同様のコマンド文字
                          列として指定する仕様に変更した。スイッチ指定を数値の
                          フラグで行うのが不可能なので，そうなるとコマンドとし
                          て一つのパラメータにするのが分かり易いので。
                          API 追加のため，Ver 0.60 とする。
Aug. 5,1996             ・UnlhaExtractMem()，UnlhaCompressMem() のバグ修正。
Aug. 6,1996             ・上記２つの API を変更し， タイムスタンプ，属性，及び
                          書き込みサイズの取得・設定が可能なようにした。これに
                          伴い UnlhaGetWriteSize() は削除。
Aug.31,1996             ・内部ルーチンで，'+' がワイルドカードとして使用されて
                          しまっていたままになっていたものを修正した。
                        ・'l'  命令でファイル数が 999 を越えるとトータル表示で
                          きなかった点を改善した。通常は 99999 まで。 拡張表示
                          時は 80桁までの制限の関係で 9999 まで。 ただし，ソフ
                          トによってはログからの読み込みに失敗する可能性がある
                          （999 までの３桁と決め打ちしているもの）。
Sep.11,1996             ・ディレクトリー作成ルーチンのバグフィクス。
Sep.13,1996             ・UnlhaOpenArchive() において， モードの設定を行ってい
                          なかったバグを修正した。
Sep.25,1996             ・複数の拡張子をもつファイルに対して，LHA と同様に最後
                          の拡張子を認識するようにした。
Sep.26,1996             ・現在の仕様でのマルチスレッドは特に効果がみられないの
                          で，取りやめた。(^^;;
                        ・WM_ARCEXTRACT で送られる格納ファイル名については，パ
                          ス情報を含むようにした。ダイアログ表示は今までどおり
                          ファイル名のみ。
Oct. 1,1996             ・Unlha() 等で，バッファに NULL を指定すると一般保護エ
                          ラーになってしまっていたバグを修正。
Oct. 4,1996             ・UnlhaSetOwnerWindow() で指定したウィンドウをダイアロ
                          グの親ウィンドウとする "-go" スイッチを追加。
                        ・親ウィンドウの Disable 処理を行わない "-gp" スイッチ
                          を追加。
                        ・WM_ARCEXTRACT に書庫ファイルの処理の開始を示すモード
                          ３を追加。
Oct.10,1996  Ver 0.61   ・ファイル名の 8+3  文字への切り詰め時のピリオドの扱い
                          を LHA と同じにした。
Oct.12,1996             ・Extractsub において， メッセージ表示時にバッファが溢
                          れることがあったバグを修正した。
Oct.14,1996  Ver 0.62   ・lh5， 6 形式について圧縮ルーチンをすべて共用するよう
                          にした。
Oct.17,1996             ・GetVolumeInformation() 呼び出し時のバグフィクス。
Oct.18,1996             ・lh7 形式の圧縮・解凍に対応した。これに伴い "-jm4" を
                          追加し， また解凍ルーチンについても lh5，6，7 で共用
                          するようにした。
                        ・WM_ARCEXTRACT にワークファイルの書き戻しを示すモード
                          ４を追加。
Oct.19,1996             ・スイッチ読み取りルーチンの細かなバグフィクス。
Oct.20,1996  Ver 0.62a  ・CRC チェックルーチンで jcxz のままになっている箇所が
                          あったために， lh7 の圧縮・解凍時に正常な CRC 値が得
                          られなかったバグを修正した。
Oct.23,1996  Ver 0.63   ・解凍状況表示ダイアログについて，複数書庫を扱う場合に
                          書庫ごとにダイアログを閉じないように改善した。
                        ・"-m2" を指定したにもかかわらずタイムスタンプの比較が
                          行われてしまっていたバグを修正した。
Oct.24,1996             ・バッファ溢れを起こしそうな箇所を修正。
Oct.26,1996  Ver 0.64   ・書庫ファイルの書き込み保護チェックのバグフィクス。
Oct.29,1996             ・ERROR_ARC_READ_ONLY  を返すところを  ERROR_READ_ONLY
                          を返してしまっている箇所があったものを修正した。
Oct.31,1996             ・カーソルリソースの開放し忘れを修正。
Nov. 4,1996  Ver 0.65   ・UnlhaOpenArchive() 系の初期化処理のバグフィクス。
Nov. 8,1996  Ver 0.66   ・ディレクトリー指定を行わなかった場合に，ディレクト
                          リーが存在しないものと判断してしまっていたバグを修正
                          した。しかし， なんで UNLHA32.DLL だけバグってたんだ
                          ろう？ ほかのは大丈夫なのに…。(^^;)
                        ・「未対応の圧縮法」のエラーメッセージの修正。
                        ・Win32 版と Win32s 版を統合。
                        ・NT の場合の３Ｄ表示については， 4.0 以降の場合に有効
                          となるようにした。
Nov.19,1996  Ver 0.67   ・"-jx" スイッチのバグ修正。それに伴いファイル名検索
                          関係の一部見直し。
Dec. 5,1996             ・解凍時に基準ディレクトリーとして UNC  を使用すると，
                          正常に解凍が行えなかったバグを修正した。
Dec. 6,1996             ・ハンドルが開放されないために，呼び出しアプリが終了し
                          ないとデバイスが開放されなかったバグを修正した。初期
                          の DOS  環境の感覚のままになっているランタイムという
                          のもなぁ…。(--;)
                        ・DosSFX，WinSFX に全てのファイルを格納させる "-gu" ス
                          イッチを追加。
Dec. 7,1996             ・UnRegistHandle() のバグフィクス。 わっはっは。これだ
                          と圧縮時は大抵お亡くなりですな。(笑)
Dec. 9,1996  Ver 0.68   ・"*.*" により全てのファイルを削除しようとした際に，格
                          納ファイル毎に必ず削除確認を行ってしまっていたバグを
                          修正した。
Dec.10,1996             ・書庫を連結する 'j' 命令を追加した。
Dec.11,1996             ・'j' 命令関係の手入れ。以後も継続。
Dec.13,1996             ・h3 形式ヘッダサイズ読み込みのバグフィクス。
                        ・ヘッダを変換する 'y' 命令を追加。
Dec.15,1996             ・API 呼び出し時におけるセパレータ変換のし忘れていた箇
                          所を修正。まだあるんだろうなぁ。(^^;)
                        ・SFX 上書き時のメッセージ修正。
Dec.17,1996             ・進捗グラフをプログレス・バーで表示するモードを追加し
                          た。通常は FV モードのときのみこれで表示する。これに
                          伴い， プログレス・バーを有・無効にする "-jp" を追加
                          した。 UseProglessBar で強制的に生むを指定することも
                          可能。こちらは一応非公開。(笑)
Dec.18,1996             ・圧縮・解凍時の np の計算のコードを見易いように改善。
                        ・GetDialogBaseUnits() 周りの改善。
Dec.22,1996             ・ダイアログ表示に使用する文字について，アイコン・フォ
                          ント設定を反映するようにした。
Dec.24,1996             ・"-a2" の仕様が LHA(32) と違っていたものを修正。でも，
                          昔の仕様って今までの  UNLHA32.DLL のものだったような
                          気がしないでも…。2.60 で変わったのかしら？
                          とにかく， この変更により "-a3" はほとんど意味をなさ
                          なくなったので削除した。
                        ・自己解凍書庫作成時のＤＯＳ名チェックルーチンのバグ
                          フィクス。ついでに，'lhd' ヘッダの場合に警告を出して
                          しまっていたバグも修正。
Dec.26,1996             ・プログレス・バーについて NT3.51 以降で有効となるよう
                          にした。
Dec.26,1996  Ver 0.70   ・エラー時の EXTRACTINGINFO 関連のメモリー開放し忘れの
                          バグフィクス。
                        ・UNZIP32.DLL に合わせ，UnlhaSetOwnerWindowEx() を追加
                          した。
Dec.28,1996             ・ダイアログ・フォントについて，NT での対応を改善した。
                          ついでに，フォント変更をし忘れていたダイアログの箇所
                          を修正した。(笑)
                        ・lh0 形式圧縮時にメモリーリークしてしまっていたバグを
                          修正した。
Dec.29,1996  Ver 0.71   ・進捗バー用フォント作成のバグフィクス。わはは。ポイン
                          トをそのまま高さとしてしまってた。(^^;)
Jan. 1,1997             ・上書き確認メッセージをダイアログに変更。「全て上書
                          き」等の選択が可能とした。
Jan. 2,1997             ・コンパイラーを BC++5.01J に変更。 EXE と違って NOEH.
                          LIB が無効である点が…15KB もサイズが増えてやんの。
                          (T_T)
                        ・破損ヘッダを読み飛ばす "-jc" スイッチを追加。
                        ・error() でのメモリーリークのバグフィクス。
Jan. 7,1997  Ver 0.72   ・ダイアログ表示について，デフォルトでは Win32s の場合
                          には System， NT3.51 では「ＭＳ Ｐゴシック」を使用す
                          るように変更。
Feb.15,1997             ・エラー時の lpExtractingInfoExMem の解放処理のバグフィ
                          クス。
Feb.17,1997             ・FileSearchSub() で "*." のような「拡張子なし」の指定
                          の場合に正常にマッチしなかったバグを修正した。これに
                          伴い MyFindfirst() において， FindFirstFile() でマッ
                          チしたファイルについて，再度マッチングを行うように変
                          更。 "*." と "APPED.C" がマッチする  FindFirstFile()
                          は困り者ですな。(--;)
Feb.18,1997             ・DosSFX/WinSFX 作成の場合に "-i0"  を指定することで大
                          文字への変換を行えるようにした。
Feb.19,1997             ・SFX を作成時に，複数のピリオドをもったファイルの場合
                          に，最初のピリオドの後ろに ".EXE" を付加してしまって
                          いたバグを修正した。また， WinSFX32 以外の場合には，
                          短いファイル名に変換するように改善した。
                        ・アセンブラ化してあった一部のルーチンをＣに戻した。
                          i486 以降のマシンでは影響が表面化しないので…。
Feb.20,1997             ・例に WinSFX32 を BC++5.01J 作成版に差し替え。
                        ・"-gw" スイッチを拡張し，WinSFX32 と WinSFX32M の両方
                          を作成可能なようにした。
Feb.21,1997             ・作業ファイル書き戻し時エラーのメッセージを変更。
                        ・FileSearchSub() のバグフィクス。
                        ・WinSFX32M のバグフィクス。
Feb.23,1997             ・圧縮時にオープンできないファイルをスキップする "-jss"
                          スイッチを追加。あうう〜。スイッチ文字が足りないから
                          苦し紛れになってきた…。(笑)
Feb.26,1997  Ver 0.73   ・UNC 関係をちょっと改善。
                        ・WinSFX32M に自動実行機能を追加したことによる関係ダイ
                          アログの変更。また，ようやく属性関係の項目も追加。今
                          までは手抜きだったの。(爆)
Feb.27,1997             ・ワークディレクトリー取得方法の変更。
                        ・"-l2" を指定すると，'l' 命令等以外のログがおかしく
                          なってしまっていたバグを修正した。
                        ・自己書庫解凍書庫認識方法の変更。 ただし，LHA，ファイ
                          ルマネージャ拡張メニュー， そして UNLHA32.DLL で作成
                          された自己解凍書庫しか正常に認識できない。
                        ・あう。0.72.0.5 の変更で， 拡張子の無い名前の場合だと
                          SFX 作成時にファイル名を失ってしまうバグを埋め込んで
                          しまっていたものを修正。
                        ・CRC エラーが発生した場合に，処理を続行するかどうか指
                          定できるようにした。
                        ・"-gm" スイッチについて，すべての確認メッセージも抑止
                          するように仕様変更した。
Feb.28,1997  Ver 0.80   ・自己解凍書庫認識方法の改善とそれに伴う書庫操作処理の
                          修正。また，UnlhaIsSFXFile() の API を追加。API 追加
                          に伴いバージョンを 0.80 に変更。
                        ・UnlhaCheckArchive() で自己解凍書庫かどうかを返せるよ
                          うに仕様を強化。
                        ・UnlhaCheckArchive() で CHECKARCHIVE_RAPID が指定され
                          た場合には，先頭 128K の部分のみヘッダ検索を行うよう
                          にした。すべて検索させることも可能。これに伴い，検索
                          サイズを指定する "-gs" スイッチを追加。
Mar. 2,1997             ・自己解凍書庫認識について， LZHSFX と 1.0.0.2  以降の
                          LZHAUTO を新たに区別するようにし， これらでは lhd 形
                          式での格納を可能とした。
                        ・"*.*" により，サブパス内のファイルを一括削除した場合
                          に，lhd で格納されたパス情報メンバーの削除が行われて
                          いなかったバグを修正した。 ついでに，ログで lhd 形式
                          メンバーのファイル名が正常に出力されない場合があった
                          ものを修正。
Mar. 4,1997  Ver 0.81   ・WinSFXM32 について "lhd" に対応。
                        ・自己解凍書庫に対する圧縮形式チェックのバグフィクス。
Mar. 5,1997             ・lhd 形式に対する照合ルーチンの改善。
Mar. 6,1997             ・"C:" 等のドライブ・レター付きでカレントディレクトリー
                          を指定した場合に正常に解凍が行えなかったバグを修正し
                          た。
                        ・基準ディレクトリー記憶用メモリーがリークすることが
                          あったバグを修正した。
                        ・スイッチキャラ記憶関係のバグフィクス。
                        ・"-p" スイッチ初期化関係のバグフィクス。
Mar. 7,1997             ・0.72.0.3 での修正のため，MyFindFirst() が DOS 名に変
                          換されたファイル名に対応しなくなっていたバグを修正し
                          た。
Mar.10,1997  Ver 0.82   ・WinSFX32M の更新のみ。
Mar.12,1997             ・localtime()，mktime() を使わないようにした。
                        ・WinSFX32M の更新。
Mar.23,1997             ・LZHSFX 1.1.0.0 及び LZHAUTO 1.1.0.0 を認識できるよう
                          にした。
Mar.24,1997             ・おっと，UnlhaCheckArchive() での CHECKARCHIVE_SFX が
                          動作していなかったバグを直すのを忘れてた。(笑)
                        ・WinSFX32M に上書き確認抑止機能を付けたことに伴う変
                          更。
Apr. 1,1997  Ver 0.83   ・MyGetFullPathName()  で ".." や "." のディレクトリー
                          指定が正常に扱えなかったバグを修正した。
Apr. 7,1997             ・MyGetFullPathName() が UNC  に対応していなかったバグ
                          を修正した。
                        ・圧縮時の "-i" スイッチが正常に機能していなかったバグ
                          を修正した。
Apr. 9,1997             ・WinSFXM を追加。機能的には WinSFX32M と同じだが，lh7
                          形式の解凍が行えない。
                        ・WinSFXM を認識可能とした。
                        ・UnlhaQueryFunctionList() のフラグの修正。
Apr.14,1997  Ver 0.83a  ・うぎゃぁ〜。WinSFXM の書き換えポインタが以前のまま
                          だったぁ。(T_T)
May. 1,1997  Ver 0.84   ・WinSFX32M Ver 2.60 に更新。 インストール機能が追加さ
                          れている。
May. 5,1997  Ver 0.84a  ・いかんいかん。 WinSFX を削除するつもりで変更したコー
                          ドがそのままになってた。(^^;;
May. 6,1997  Ver 0.85   ・SFX 設定ダイアログで  'x' スイッチの指定を行えるよう
                          にした。
May. 9,1997             ・SFX 設定ダイアログに改竄チェックスイッチを追加。
May.14,1997             ・MakeDirectory() が  UNC に対応していなかったバグを修
                          正した。
May.19,1997             ・CheckDiskSpace()  をファイル名が付加された状態で呼ん
                          でいた箇所があったバグを修正した。
                        ・WinSFX32 作成時に「改竄チェック」が有効になってし
                          まっていたバグを修正した。
May.21,1997  Ver 0.85a  ・WinSFX32M のバグフィクス。
Jun.17,1997  Ver 0.86   ・CheckDiskSpace()  で数値が取得できなかった場合にいつ
                          もエラーとなってしまっていたバグを修正した。
Jun.19,1997             ・"-gr" スイッチ取得部及び，"-r2" 取得時でのフラグ設定
                          のバグフィクス。
                        ・WinSFXM，WinSFX32M のバグフィクス。
Jun.26,1997  Ver 0.87   ・"-r2" スイッチを指定した場合に，正常なフラグ設定がさ
                          れなかったバグを修正した。
Jun.30,1997             ・予期しない EOF  に遭遇した場合に一般保護エラーとなっ
                          てしまっていたバグを修正した。
Jul.16,1997  Ver 0.87a  ・UNLHAVC.LIB を更新。それだけ。(笑)
Aug.15,1997  Ver 0.88   ・UnlhaGetArcFileSize() が必ず 0  を返してしまっていた
                          バグを修正した。
                        ・UnlhaFindFist/Next()  等でファイル名がマッチしない場
                          合にヘッダ読み込み時のファイル名・バッファの解放をし
                          忘れていたバグを修正した。
                        ・UnlhaGetArcOriginalSize()  等の一部の API について，
                          UnlhaFindNext() での検索終了後も有効となるように改善
                          した。 ただし，当然ながら UnlhaCloseArchive() した後
                          は無効。(笑)
Sep. 1,1997  Ver 0.89   ・余剰データ警告について，自己解凍書庫のコードである場
                          合はその旨を出力するようにした。
                        ・"-o2" を指定した場合に h1 ヘッダとなってしまっていた
                          バグを修正した。
                        ・UnlhaCompressMem() による圧縮時に， lh0 での圧縮及び
                          圧縮率により lh0  へのメソッド変更が生じると一般保護
                          エラーとなってしまっていたバグを修正した。うう…，
                          fread() でそのまま読んでるわ， rewind() をそのまま実
                          行してるわ…。(^^;;;;
Sep.26,1997  Ver 0.90   ・格納ファイル名の '.'  によるカレントディレクトリー指
                          定文字列を削除するしようでありながら，検索ルーチンが
                          その点に対応していなかったバグを修正した。
                        ・"-jf0" を指定した場合に，解凍時の UNC 名の処理が正し
                          く行われなかったバグを修正した。
                        ・文字列を伴うスイッチ指定の場合に，最後の文字がスイッ
                          チと認識されてしまうことがあったバグを修正した。
Sep.27,1997             ・レジストリー設定について，省略値を指定する
                          "InitOption" と強制設定値を指定する "CauseOption" を
                          追加した。
                          "CauseOption" は，海外での使用等「アプリの動作に関ら
                          ず常に h0 形式ヘッダで処理させたい」といったような用
                          途のためのもの。
Oct.15,1997  Ver 0.91   ・解凍ルーチンを意味もなく一部  DosSFX 2.67 のものと合
                          わせた。(笑) 実は↓のバグフィクスのもがきの一つ。(爆)
Oct.16,1997             ・DJLHA Ver 2.51 で作成された旧 lh6 形式のファイルが解
                          凍できない場合があった不具合を改善した。何しろ，
                          DJLHA の配布ファイル自体が解凍できなかったからねぇ。
                          (笑)
                        ・CRC エラー時の処理続行メッセージボックスでの判定が逆
                          になってしまっていた大ボケバグを修正した。
Oct.21,1997             ・WinSFX32M について，unlha32.dll と同様  DJLHA 版 lh6
                          の解凍に対応した。
Oct.24,1997             ・WinSFX について lh7 形式の解凍に対応した。DJLHA 版で
                          の不具合も改善されている。
Oct.25,1997             ・WinSFX32M & WinSFX のサイズ縮小。
Oct.27,1997  Ver 0.92   ・decode() でのバッファ出力を SFX.ASM と同様の方法に変
                          更した。本来なら多少なりとも高速化が行えそうではある
                          が，グラフ表示と Win32s の際のタスク明渡しチェックの
                          せいで全然変わっていないようである。(^^;;
Oct.28,1997             ・lh7 形式ファイルが DosSFX に変換できなかったバグを修
                          正した。
Oct.29,1997             ・無圧縮格納が行われた場合のメモり解放フラグ設定ミスの
                          バグフィクス。
                        ・WinSFXM 作成時に改竄チェックを指定できなかったバグを
                          修正した。
Oct.31,1997  Ver 0.93   ・DosSFX 作成時に SFX のバッファを破壊してしまうバグを
                          修正した。
Nov. 2,1997  Ver 0.94   ・UnlhaGetVersion() が 92 を返していた大ボケのバグを修
                          正。(T_T)
                        ・'s' コマンドの際に  "-gr" スイッチで自己解凍書庫の名
                          前を指定できるようにした。
Nov.13,1997  Ver 0.95   ・WinSFX32M の修正。
                        ・検索文字列に "" が指定された場合には即  FALSE を返す
                          ように修正した。＞FileSearchSub
Nov.14,1997             ・UNC でのルートディレクトリー指定の場合に，ディレクト
                          リーチェックが失敗してしまっていたバグを修正した。
                         (とびたさんにメール)
Nov.17,1997             ・WinSFX32 について lh7 及び lhd に対応化。
Nov.19,1997             ・通常は WinSFX(32)M  の特殊ディレクトリー指定を解凍時
                          に無視するようにした。その上で，指定を解析させる
                          "-gt" スイッチを追加。
                        ・WinSFX を lh7 及び lhd に対応化。 ついでにファイル名
                          コンバートの処理も追加したので，サイズが肥大化してし
                          まったのがちょっと…。(T_T)
Nov.21,1997             ・ExtractCheck()  が特殊ディレクトリー指定に対応してい
                          なかったバグを修正。
Dec. 1,1997  Ver 0.96   ・MakeDirectory() のバグフィクス。
Dec.15,1997             ・FindDirectory() がルートディレクトリーに対応しなく
                          なってしまっていたバグを修正した。
                        ・依然として iskanji() を使用していた部分を全て IsDBCS-
                          LeadByte() を使用するように修正した。
Dec.28,1997             ・WinSFX32(M) が Win32s で動作しなくなってしまっていた
                          点を改善。
                        ・0.95 で DosSFX 作成時に lhd を通してしまうバグを埋め
                          込んでしまっていたものを修正した。
                        ・WinSFX(32)(M) に対して再度  'S' コマンドを実行した際
                          には，以前の設定が初期値として反映されるようにした。
Jan.15,1998  Ver 0.97   ・"-jc" スイッチが指定されている場合には，ハフマンコー
                          ドエラーが発生した際にも継続するようにした。
                        ・英語版 SFX の作成。ただし，DosSFX は日本語版のまま。
                          WinSFX(M) 以外は日本語環境で使用しても問題ないと思わ
                          れる。
Jan.17,1998              (小沢さんにメール)
Jan.19,1998  Ver 0.97a  ・UnlhaFindFirst/Next() 時に書庫ファイルのオープン・ク
                          ローズを行わないようにする AlwaysOpen をレジストリー
                          で設定できるようにした。 格納数約 3200， 圧縮後 21MB
                          の書庫で 1.4 倍程度の高速化を図れる。 ついでにデフォ
                          ルトを 1―つまり開きっぱなし―にした。(^^;; これまで
                          の版は 0 の動作に当たる。
                        ・ランタイムの remove() を使っていた箇所があったものを
                          DeleteFile() に変更。 なんか，この手のパターンがまだ
                          まだありそうだなぁ。(^^;;
Jan.27,1998             ・ディレクトリー作成時に「以降全て作成」の選択を行える
                          ようにした。
Jan.29,1998             ・解凍時にもカウント表示を行うようにした。また，圧縮・
                          解凍前のマッチング時にファイル名を表示するようにし
                          た。何も表示されないと不安になるので…。(笑)
                          これに伴い WM_ARCEXTRACT の mode 5 が追加されている。
                        ・WinSFX32 のタイムスタンプ周りを自前のルーチンに変更。
                          サイズは大きくなってしまうが， CRTDLL.DLL がバグって
                          いるのでは…。(^^;)
Feb. 1,1998             ・DWORD アラインメント及び i486 命令コンパイルに変更。
Feb. 2,1998             ・'T' コマンドの際の  CRC エラー表示が削除確認となって
                          いたものを改善。
                        ・SFX 判定のバグフィクス。WinSFX32M 2.60.0.16 以降がま
                          ともに判定できなくなっていたものを修正したのが主な変
                          更点。
                        ・暫定的に  LHarc や LARC の SFX， 及び Lhasa のインス
                          トーラを判別できるようにした。Lhasa についてはたけち
                          ん氏に打診後実際の処理を決定の予定。とりあえずは h1，
                          lh5，lhd なしで処理を行うようになっている。
                          LHarc，LARC についてはこの時点では  COM についてのみ
                          対応。
Feb. 3,1998             ・CheckSFX() のバグフィクス。 そう言えば GetBinaryType
                          は Win95 では使えないんだった。(^^;;  表面化はしてな
                          かったけど…。
                        ・EXE についても LHarc，LARC SFX を認識可能とした。
                         ("-jc" をデフォルトでオンにしようと思ったが， OpenAr-
                          chive() が破綻するので，やむなく中止。^^;）
Feb. 4,1998             ・DosSFX 自体は Ver 2.60 から lh7 が扱えるようになって
                          いた点に対応。
                        ・SFX への書庫操作について，'J' コマンド等についても対
                          応化を行った。
                        ・ファイル名の表示について，不正なポインタを使用してい
                          る箇所があったものを修正した。
Feb. 6,1998             ・WM_ARCEXTRACT において，圧縮結果を報告する mode 6 を
                          追加した。
                        ・ダイアログに対して SetForegroundWindow() を行う "-gq"
                          スイッチを追加。むぅ〜，こんなのが必要になる Win95 っ
                          てのは…。(--;)
Feb. 7,1998             ・"lhd" メンバーを指定するための "-gb" スイッチを追加。
                          本来なら '/'  を外したパス名でマッチするところなんだ
                          ろうけど…。まぁ，同じ名前の通常メンバーがあった場合
                          に両方マッチすると困るから，そういう仕様になっていた
                          のでしょう。タイプの指定なんて概念がないから。＞LHA
                        ・裏技モードで "-gc" スイッチを追加。 スイッチ文字で始
                          まる名前のファイルを指定したりするのに使用。↑の
                          "-gb" スイッチでもいいけど，書庫には使えないもんね。
                          「"」がどこでも括れる仕様ならこんなスイッチは必要な
                          いんだけど，既に変更は不可。(笑)
Feb. 8,1998             ・i386 命令コンパイルに戻した。 ほとんど差が出ないのな
                          ら，このほうが問題が少ない。(^^;;
                        ・いかん。 0.97.1.2 で DeleteFile() に変更したのはいい
                          が，その後の判定がそのままになってる箇所があった。
Feb.10,1998  Ver 0.98   ・ファイルによってメソッド等を自動的に変更する  "-jma"
                          スイッチを追加。 現在の版では UNLHA32.DLL が用意した
                          固定の設定による動作のみとなっている。いずれはレジス
                          トリーでユーザが指定できるようにする予定。
Feb.11,1998             ・"-jma"  におけるハフマン・バッファ設定が実質機能して
                          いなかったのと，サイズによるメソッド変更（lh4〜lh7）
                          を実装し忘れていたバグを修正。 ついでに，hb32List に
                          該当する場合はサイズが小さくても  lh1 としないように
                          した（高圧縮が見込める場合は lh4 のほうが有利）。
                        ・"-jma" について，lh1 への切り替えは単に 1000bytes 以
                          下の場合に lh4 と比較して切り替えるように変更した。
                          ３回圧縮を行うことになるが，このサイズでは余り問題と
                          はならないだろう…。
Feb.12,1998             ・ファイルを誤って削除してしまったので，コーディングし
                          直し。(笑)  ついでに，再圧縮を試みても 0.1% 程度の向
                          上に過ぎないので処理を簡略化。 lh1 への変更と BMP 等
                          の際の -je32768 のみを残した。
Feb.14,1998             ・重複ぎみとなっていた箇所の AllwaysMessage() を削除。
Feb.16,1998             ・Lhasa インストーラへの書庫操作を行えないように変更。
                          たけちん氏に問い合わせた結果なので，今後の変更はな
                          し。
Mar.11,1998             ・CheckMember() のバグフィクス。おかげで，通常の書庫を
                          DosSFX と認識してしまうことがあった。 単に条件式の間
                          違い。(^^ゞ
Mar.12,1998             ・タイムスタンプ関係を基本的に FILETIME で扱うように変
                          更。これに伴いヘッダに 0x41 メンバーを追加。
                          現バージョンでは SFX は未対応。また，Win32s の場合の
                          処理も未実装。 とりあえずは Win32 方面をちゃんとして
                          おかないと…。
Mar.12,1998  Ver 1.00   ・FILETIME 構造体でのタイムスタンプを得る UnlhaGet-
                          CreateTimeEx() 等を追加。これに伴いバージョンは 1.00
                          となる。
Mar.13,1998             ・h2 形式の場合でも 0xFF ヘッダを読み込めるようにした。
                          DOS 系ではまず存在しないが，ほかのものでは可能性があ
                          るので。
Mar.14,1998             ・Win32s の環境で  FILETIME でのタイムスタンプが正常に
                          扱えていなかった点を手入れ。それにしても，なんで Win-
                          32s だと FILETIME 回りも全部ローカルタイムで管理され
                          てるんじゃ。おかげで邪魔くさいったら…。変換するだけ
                          なんだから， API がちゃんと UTC で扱うようにすれば良
                          かったのに…。(--;)
Mar.16,1998  Ver 1.01   ・ファイルの読み込みオープン時に共用不可となっていた箇
                          所を修正した。
Mar.23,1998             ・lhd メンバーの格納時に「読み込みエラー」となってしま
                          うバグを修正した。
                        ・書き戻し時のオープンエラーと空き容量不足の際のエラー
                          コードを分けた。
                        ・エラーメッセージ表示時に参考値として  GetLastError()
                          の数値を表示するようにした。
                        ・エラー時に作業ファイルが失われてしまう場合があったバ
                          グを修正した。
Mar.24,1998             ・AllwaysMessage()，AllwaysMessage2() について，API 実
                          行により EBX レジスタが破壊されてしまい， その結果一
                          般保護エラーとなってしまう環境があった点に対応した。
                          う〜ん，しかし API が EAX レジスタ以外を保存してくれ
                          ると期待しているコードになっているからなぁ…。他のコ
                          ンパイラーではどうなんだろう？(^^;)
Mar.26,1998             ・error_mes() のバグフィクス。 GetLastError() が関係な
                          いときに表示されてた…。 0x8005 からのインデックスに
                          なってたんだった…。(^^;;
                        ・DWORD アラインメントがどうも無効みたいなので，  WORD
                          アラインメントに変更した。 ついでに Pentium 命令生成
                          ＆スケジューリングを有効にした。 .386 の範囲内で使用
                          命令が選択されるだけなので， i80386 等でも問題ないは
                          ずだから…。その代わりコードは 4KB 増加したけど。
Mar.27,1998  Ver 1.02   ・Win32s の場合にまで SetForegroundWindow() を実行しよ
                          うとしてしまっていたバグを修正した。
Mar.29,1998             ・作業ディレクトリーと同じディレクトリーに書庫を新規作
                          成しようとした場合にエラーとなってしまうことがあった
                          バグを修正した。
                        ・AllwaysMessage()，同2 について，レジスタ変数を一切使
                          わないようにした。どうやら，ESI や EDI でも API をま
                          たがると破壊されるようなので…。
Mar.31,1998             ・エラーコードについて ERROR_SHARING を追加。
Apr. 6,1998             ・FILE_SHARE_READ で開けないファイルについては
                          FILE_SHARE_READ | FILE_SHARE_WRITE  でのオープンを試
                          みるように変更。う〜ん，他人に書き込みを許すのは嫌な
                          のじゃが…。(^^;;
                        ・一応 CreateFile()  の際に SECURITY_ATTRIBUTES として
                          ダミーのポインタを渡すようにした。はて？ Win32s だと
                          大丈夫かしら？(笑)
                        ・FILETIME ヘッダを格納しないようにする  "-jst" スイッ
                          チを追加。デフォルトは "-jst1" で格納。
                        ・"-jx" スイッチについて，圧縮時に指定が正常に機能しな
                          かったバグを修正した。
                        ・メッセージループを一切回さないようにする "-jsb" ス
                          イッチを追加。
                        ・1.02.0.5 の変更に伴い， SH_DENYNO でのオープンを行わ
                          ない "-jso" スイッチを追加。
Apr. 7,1998             ・ログ出力関係のソース整理。ファイル出力への準備。(^^;)
Apr. 8,1998             ・Ver 1.01 において， 一部タイムスタンプ関係の処理が抜
                          けてしまっていたバグを修正（Win32s の部分）。
Apr. 9,1998             ・DriveLetterCopy() のバグフィクス。
Apr.13,1998  Ver 1.03   ・ディレクトリーの圧縮の際に「共有エラー」となってしま
                          うことがあったバグを修正した。
                        ・"*.txt" の指定で "my.file.txt" のようなファイルにマッ
                          チするように改善。 ただし，Win32s 的なのはこの『最後
                          の拡張子』についてのみ。
                        ・解凍時の共用オープンエラー等の場合にエラーを返すよう
                          にする "-jse" スイッチを追加。また，ディレクトリー作
                          成時のエラーは無条件にエラーとするように変更。
                        ・ディレクトリー作成確認ダイアログで「中止」を選んだに
                          も関らず処理が継続してしまっていたバグを修正した。
Apr.15,1998             ・UnlhaOpenArchive() で "-jsb"  相当の操作を行えなかっ
                          たものを改善。コマンド指定が行えないのをすっかり忘れ
                          てた。こっちでの指定が本命だったのに。(笑)
                        ・「リードオンリー・ファイル上書き確認」メッセージをダ
                          イアログに変更。
                        ・ファイルにログを出力する "-gl" スイッチを追加。
                        ・隠し・システム属性のファイルを圧縮した場合にタイムス
                          タンプが破壊されてしまうバグを修正。
Apr.21,1998  Ver 1.04   ・ファイル名検索について， 基本的に Win32 API の指定方
                          法を採用するようにした。とは言うものの，実際には '*'
                          が '.' にもマッチするようにしただけ。(笑) ただし，
                          "*.*" はこれまでどおり「全てのファイル」を意味する。
                          もちろん "*" でも同じ意味。また，"*." というような指
                          定で「拡張子をもたないファイル」の指定が可能。
Apr.22,1998             ・h0，h1 形式書庫作成時に  "-i" スイッチが機能していな
                          かったバグを修正した。
                        ・取り敢えずディスク空き容量チェックについて  64bit 化
                          を行った。
                        ・OpenArchive() 系でのカーソル表示の改善。
Apr.24,1998             ・WinSFX32M について，Win32s 環境で SHARE.EXE が実行さ
                          れているとエラーとなってしまう不具合を改善。
Apr.27,1998  Ver 1.05   ・取り敢えず reneme() を単純に MoveFile() に変更。元々
                          MoveFile() 用のコードになっていたし…。(^^;;
                        ・うぎゃぁ〜。格納ファイルの検索時に，ことごとくワイル
                          ドカードがマッチしてしまっていたぁ〜。(^^;;;;
Apr.28,1998  Ver 1.06   ・UnlhaGetAttribute() について全てのフラグを返すように
                          改善。
Apr.28,1998  Ver 1.10   ・UnlhaGetArcCreateTimeEx() 等を追加。これに伴いバー
                          ジョンを 1.10 に更新。また，UnlhaGetArcTime() 等が正
                          常な値を返していなかったバグを修正。
Apr.30,1998             ・基本的に書庫の作成日付を保存するように改善。
                        ・上書き時のタイムスタンプ表示の改善（ftime から行って
                          いたものを SYSTEMTIME から行うように変更）。
May. 1,1998             ・GetTempPath() の代わりに自前のルーチンを使用するよう
                          に変更。『テンポラリ』のくせに簡単にカレントを使用さ
                          れたのでは困り者なので。
May. 4,1998             ・1.10.0.3 において， 書庫操作の結果空となり削除された
                          ときにまでタイムスタンプを読み込もうとしてしまってい
                          たバグを修正。
May. 5,1998             ・Win32s  上で作成日時等がサポートされていない点に対応
                          できていなかったバグを修正。
May. 7,1998  Ver 1.11   ・UnlhaOpenArchive() について， モードのチェックを行う
                          前にそのまま UnlhaGetVersion()  が呼ばれてしまってい
                          たものを改善。
                        ・UnlhaQueryFunctionList() のバグフィクス。
May. 8,1998             ・根本的に  UnlhaGetRunning() においてループを回さない
                          ように変更。それが必要な環境のときのみレジストリー設
                          定で回すことができる仕様とした。
                        ・DOS 名に変換されたファイル名が渡された場合に検索が失
                          敗してしまっていたバグを修正．
                        ・OpenArchive() 系が呼ばれている間に Ulha() 系が呼ばれ
                         た場合に ERROR_ALREADY_RUNNING を返すようにした。
May.11,1998  Ver 1.20   ・UnlhaSetEnumMembersProc()，UnlhaClearEnumMembers-
                          Proc() の API を追加。これに伴い 1.20 に更新。
May.12,1998             ・変名の際など，必要なさそうな場合は，EnumMembersProc()
                          から帰ってきた後に即処理を行うようにした．
May.13,1998             ・MakeDirectorySub() のバグフィクス。lpb の NULL チェッ
                          クが抜けていた。
May.14,1998             ・FileSearchSubSub() のバグフィクス。おかげで -p スイッ
                          チが効かなくなってしまっていた。
May.25,1998  Ver 1.21   ・"..\" に検索が対応できていなかったバグを修正した。
May.31,1998             ・検索時に大文字・小文字が区別されてしまうことがあった
                          バグを修正した。
                        ・lhd メンバーが存在する場合に CHECKARCHIVE_FULLCRC で
                          のチェックに失敗することがあったバグを修正した。
Jun. 3,1998             ・WinSFX で， 上書き確認メッセージボックスの表示がファ
                          イル名だけになってしまっていたバグを修正した。
Jun. 7,1998  Ver 1.22   ・searchfile() について， 一旦検索でマッチしたものまで
                          毎回検索してしまっていたバグを修正した。
Jun.23,1998  Ver 1.23   ・「合計で表示」をオフにしている場合には総数表示を０で
                          はなく '-' で表示するようにした。
Jul. 2,1998             ・FindDirectory() をルートディレクトリーにも対応した。
Jul. 4,1998             ・gethdr() で  hpb.pathname のアロケートを行わないよう
                          にした。
Jul. 9,1998             ・日本語以外の環境の場合に英語で表示を行うようにした。
                        ・上記に伴い副産物として "-jw"，"-gw" スイッチで日本
                          語・英語版を指定して SFX の作成を行えるようにした。
                          でも，SFX ルーチンのせいで 40KB 以上サイズが肥大化し
                          てしまってますぅ〜。(^^;;
                        ・UnlhaSetEnumMembersProc() を使用した場合に一般保護エ
                          ラーで落ちることがあったバグを修正した。
Jul.12,1998              (β1 非公式ＵＰ)
Jul.22,1998             ・Ver 0.98.0.8 で CheckTime() がおかしくなってしまって
                          いたものを修正。 うげげ，BYTE でキャストしたせいで，
                          一旦 BYTE に丸められてしまっていたの…。(^^;;
                        ・英語版 WINSFX32M について，タイトル省略値が "LZH LZH
                          V2.60.w32.0017" となってしまっていたものを修正。(^^;;
Jul.23,1998              (β2 公式ＵＰ)
Aug. 2,1998  Ver 1.24   ・LZHSFX 1.2.1.0 を認識できるようにした。
                        ・解凍時の空き容量チェックのバグフィクス。
Aug. 4,1998             ・WinSFX32M について，日英双方のバージョンが異なってい
                          たものを改善した。
                        ・WinSFX32M について，$AskRegist コマンドを追加。 何の
                          ことはない，複数の関連付けを行う際にその都度問い合わ
                          せを行わせるためのもの。２つか３つ程度なら問い合わせ
                          てもそんなに煩わしくはないであろう…。(笑)
                        ・フォント関係について，LHMelt と同様の改善を行った。
Aug.18,1998  Ver 1.25   ・"-gl" スイッチでの出力が API  で指定されたバッファサ
                          イズに影響してしまっていたバグを修正した。
Aug.19,1998             ・WinSFX(32)(M)  作成時の初期値を指定する "-gx" スイッ
                          チを追加。
Aug.24,1998             ・"-r2" スイッチ指定時に，".TXT" のような '.' で始まる
                          名前のファイルを正常に扱えなかったバグを修正した。
Aug.26,1998             ・FindDirectory() の改善。
Sep. 3,1998  Ver 1.26   ・regfile() 時にロング及びショート名を得て同時に登録す
                          ることにより， searchfile() 内で MyGetFullPathName()
                          を呼ばずに済むようにした。これに伴い，regfile() にお
                          いてショート名での照合も行われるので，"-ji" で格納し
                          たファイルについても正常に扱えるようになっている。照
                          合回数が倍となるわけだが，MyGetFullPathName() を指数
                          関数的回数で呼ぶ以前のルーチンからみれば些細な処理時
                          間の増加であるはず…。(^^;)
Sep. 4,1998             ・うげげ。↑では絶対ディレクトリーのパス名が正常に扱え
                          ていなかった…。(^^ゞ
                        ・圧縮・解凍時等のカウント表示の改善。
Sep. 6,1998             ・"-jr" スイッチが機能しなくなってしまっていたものを修
                          正。
Sep. 8,1998             ・いつの間にか格納時の検索においても解凍時と同じ照合と
                          なってしまっていたバグを修正した。
Sep.12,1998              (HP:βUP)
Sep.15,1998  Ver 1.26a  ・BC++ 5.01 においては，レジスタ変数を使用した場合，必
                          ず変数の破壊が生じることが判明したので，一切使用しな
                          いようにした。
                         (HP:β2 UP)
Sep.19,1998  Ver 1.26b  ・とりあえずスタックフレームの生成を行うと大丈夫みたい
                          なのでコード生成を元に戻した。
                          これに伴い，AllwaysMessage()  等のルーチンについては
                          本来のものに戻してある。
Sep.26,1998             ・'l' コマンドでのリスト表示時にバッファ溢れを起こすこ
                          とがあったバグを修正した。
                        ・UnlhaCompressMem() の場合に「ファイルが見つからない」
                          のエラーとなってしまうバグを修正した。  ShareCheck()
                          を呼んでしまっていたのが原因。(^^;;
Sep.27,1998             ・SFX 作成時の上書き確認メッセージを，解凍時のものと同
                          じダイアログに変更した。
                        ・作業ファイルについて，大文字のファイル名とした。
Oct. 1,1998              (HP:正式版UP)
Oct. 4,1998  Ver 1.26c  ・'l' コマンドの際にファイル名しか表示されなくなってし
                          まっていたバグを修正した。はて？ 1.26.2.8 での変更の
                          際で大丈夫だったのに，どこでバグを埋めこんだんだろ？
Oct. 6,1998  Ver 1.27   ・CreateFile()  での書き込みオープン時のフラグ設定の改
                          善(と言うかちょっと変更してみただけ)。
Oct. 8,1998             ・WinSFX32M について，昔のコードが混入してしまっていた
                          ものを修正。
                        ・WinSFX32M について，SFX 設定ダイアログでタイムスタン
                          プチェックの有無を指定できるように改善。
Oct.13,1998             ・ファイルを閉じる前に明示的にバッファのフラッシュを行
                          うようにした(SystemDoctor 対策)。
                         (HP:β0 UP)
Oct.14,1998  Ver 1.27a  ・SFX 設定ダイアログについて，エディトボックスにスク
                          ロール属性が設定されていなかったバグを修正した。
Oct.18,1998             ・"-jr" スイッチについて，パス付きの格納ファイルの更新
                          ができなくなってしまっていたバグを修正した。…私の環
                          境では再現できなかったんだけど…。(笑)
                         (1.27.1.6; HP:β1 公式UP)
Oct.21,1998  Ver 1.27b  ・sprintf() を使っていた箇所がまだ残ってたの…。(^^;;
Oct.26,1998             ・regfile() のバグフィクス。はて？ 1.26 の変更時にこの
                          バグに遭遇して修正したはずなのじゃが…。しくしく…。
                          LHMelt とセットで修正したはずのソースが失われたのね。
Oct.27,1998  Ver 1.27c  ・ひ〜。↑で大ボケしてた〜。(T_T)
                         (1.27.3.9; 正式版UP)
Nov. 2,1998  Ver 1.28   ・1.27.0.1 での CreateFile() の変更を戻してみた。(^^;;
                          いくらなんでも FlushFileBuffers() が問題になるとは思
                          えない…。(^^;;;;
                        ・set_ftime_mode()  でのタイムスタンプと属性の書き込み
                          順を変更。 処理上は READ ONLY であってもタイムスタン
                          プの書き込みには問題ないはずだが，何らかの関係で順序
                          が問題になっているとしか思えない…。(^^;;;; あぅ〜。
                          こんなのばっかし…。(笑)
                        ・LogCheck() のバグフィクス。
                         (1.28.0.3; HP:β UP)
Nov. 6,1998              (同; Nif にβ公開)
Nov. 9,1998  Ver 1.28a  ・freeze_fb() において，バッファ溢れをおこすことがあっ
                          たバグを修正した。
                         (1.28.1.4; HP&Nif:β UP)
Nov. 9,1998  Ver 1.28b  ・'"' の取り扱いの変更。そろそろ仕様変更を行っても問題
                          ないであろう…と言うことで，ごく普通に位置に関係なく
                          指定できるようにした。でも，"""" とかやって '"' の文
                          字自体を扱うことはできないのぉ〜。(^^;)
Nov.10,1998             ・WinSFX32M の更新("%WinRoot%" の追加)。
Nov.11,1998             ・小文字の拡張子を付加する "-jsz" スイッチを追加。
Nov.13,1998             ・読み込みオープンのときまで FlushFileBuffers() してし
                          まっていた大ボケを修正。(^^;)
                         (1.28.2.8; HP:βUP)
Nov.17,1998  Ver 1.28c  ・書庫の検索において，ディレクトリーが検索されてしまっ
                          ていたバグを修正した。
Nov.24,1998             ・MakeDirectory() のバグフィクス。
                         (1.28.3.10; HP&Nif:β UP)
Dec.14,1998  Ver 1.28d  ・一部のコード変更のついでに，裏技でバッファのフラッ
                          シュを行わない設定を可能とした。
Dec.15,1998             ・mobio で試したところ，今回のコード変更でバッファをフ
                          ラッシュしなくても SystemDoctor による不具合を回避で
                          きているようなので，デフォではフラッシュしない設定と
                          した。要公開テスト。
Dec.16,1998             ・一部ルーチンの変更(なるべくランタイムを使わないよう
                          にした。以降継続)。
                        ・UnlhaCompressMem()  で圧縮サイズが得られなくなってい
                          たバグを修正した。
Dec.20,1998              (1.28.4.14; HP&Nif:β UP)
Dec.22,1998  Ver 1.28e  ・ルーチンの手直し。
Dec.24,1998             ・エラーで処理を終えた際にビジーフラグがリセットされな
                          いことがあったバグを修正した。
Dec.25,1998             ・WinSFX32 のバグフィクス。
                        ・ちゃんとタスクバーを考慮してウィンドウを表示するよう
                          にした。(爆)
Dec.26.1998              (1.28.5.18; 正式版 UP)
Jan. 1,1998  Ver 1.29   ・手抜きしていた UNLHAVC.LIB を更新。(^^;;;;  それにし
                          ても VB や Delphi 使いならまだしも， VC++ 使いからの
                          要望がなぜこんなに多いのだろう？  UNLHA32.H のプロト
                          タイプを使って適当に 0 でも返す関数を書いて， 最適化
                          を OFF にしてコンパイルすれば LIB が手にはいるのに。
                          10 分と掛からないはず…。(^^;;
                        ・MyFree() を呼んでいるにもかかわらず  NULL チェックを
                          行っている箇所が存在していた点を改善。
Jan.18,1999             ・"-j(g)w4" スイッチを指定した場合に，"-gx" スイッチが
                          無効となってしまっていたバグを修正した。
Jan.20,1999             ・ルーチンの手直し。
                        ・FreeResource()  し忘れている箇所があったバグを修正し
                          た。
Jan.22,1999              (1.29.0.5; 正式版 UP)
Jan.23,1999  Ver 1.30   ・"-gb" スイッチのバグフィクス。と言うか，"-gc" スイッ
                          チと全く同じ処理にしただけ。実際，これで何の問題もな
                          いし…。(爆)
                        ・下手をすると必要ないところで，NULL ポインタのメッ
                          セージが表示されてしまう可能性があったものを修正。
                        ・オペランド数を倍の 2048 まで可能とした。それくらいに
                          なればレスポンスファイルを使うはずなので問題ないはず
                          なのではあるが，ついでだし…。(^^;;
                        ・解凍時ファイル名変更ダイアログのバッファの拡張。UNI-
                          CODE アプリ絡みで一抹の不安があるので…保険モード。
Jan.25,1999             ・書庫格納ファイル検索ルーチンの改善。 "-p" スイッチ使
                          用時等再検索されることがないリストについてチェックし
                          ないようにした。更新を伴わない場合は，残りリストがな
                          くなった時点で検索を打ち切る。
Jan.27,1999             ・まだ "-gx"  スイッチが利かなくなることがあったバグを
                          修正した。
Jan.29,1999             ・圧縮・解凍途中に SetParcent() を必要以上に呼び出さな
                          いようにした。 これに伴い， UnlhaSetBackGroundMode()
                          での設定が無意味となる副作用が発生。実質大きい問題と
                          はならないのではないかと…。(^^;)
                        ・Win98 & NT5 の場合に  SetForegroundWindow() を呼び出
                          さないようにした。
Feb. 1,1999             ・1.30.0.7 の修正で SFX 作成時に正常にファイル名等の表
                          示がされなくなってしまっていたバグを修正した。
                        ・'f' コマンド時に "NULL pointer" のメッセージが表示さ
                          れてしまっていたバグを修正した。
                         (1.30.0.10; 正式版 UP)
Feb. 4,1999  Ver 1.31   ・解凍時等について，解凍できなかったファイル数を返す仕
                          様に戻した。 ただし，以前の経緯 (単純に 0 と比較して
                          いるアプリがあまりにも多かったために，0 を返す仕様に
                          変更したもの) を考慮して， "-jsc" スイッチが指定され
                          た場合のみファイル数を返す仕様となっている。
Feb. 5,1999             ・"-gb" スイッチのバグフィクス。 1.30.0.1 の変更でディ
                          レクトリ指定として認識されてしまうようになっていたも
                          の。
Feb. 7,1999             ・CheckSFXType() において， ファイルの範囲外読み込みが
                          発生する可能性のあったものを修正した。
Feb. 8,1999             ・WinSFX32M の修正。
Feb.10,1999             ・regfile() の改良。固定ではなく，一旦バッファ上で処理
                          した結果に基づいたサイズでアロケートするように変更。
Feb.12,1999             ・ルーチンの手直し (以後継続)。
                        ・SFX 設定ダイアログに， 既存 SFX の属性保存指定が反映
                          されるようにした。また，"-gx" スイッチでも指定が可能
                          とした。
                        ・SFX 設定ダイアログ等での属性保存指定関係のバグフィク
                          ス。
                         (1.31.0.8; HP: βUP)
Feb.16,1999  Ver 1.31a  ・"-jx" スイッチが正常に機能しなくなっていたバグを修正
                          した。常にワイルドカード相当の扱いにも関わらずファイ
                          ル指定と同様のフラグ処理を行ってしまっていたもの。
                        ・freeze_fb() を呼び出した後に解放済みのバッファを使用
                          してしまう可能性のあったバグを修正した。
                        ・関数内の一時的なものについては，バッファをスタック上
                          にとるようにした (以後継続)。
                         (1.31.1.11; HP: βUP)
Feb.17,1999  Ver 1.31b  ・NULL をオーナとして  CreateDialogBox()  する可能性が
                          あったものを修正した。
                        ・タイムスタンプ関係の処理改善。 これに伴い  "-job" ス
                          イッチ等が拡張されている。
Feb.18,1999             ・WinSFX32M について， h2 形式の 0x41 拡張ヘッダに対応
                          した。
Feb.19,1999             ・解凍時に通常スキップされるだけの軽微なエラーの場合に
                          も処理を中断するようにする "-jse2"  スイッチを追加。
Feb.22,1999             ・"-x" スイッチが指定されているにもかかわらず  regfile
                          ()  内で同名ファイルチェックを行ってしまっていたもの
                          を改善した。このため，ファイル数が多くなると指数関数
                          的に処理が遅くなってしまっていた。
Feb.23,1999             ・h3 形式以外の場合に  UnlhaGetAccessTime() 等で値が得
                          られなくなってしまっていたバグを修正した。
                         (1.31.2.17; HP&NIF βUP)
Mar. 3,1999  Ver 1.31c  ・リード・オンリー・ファイル上書き確認ダイアログで「以
                          降すべて上書き」等の選択が正常に機能しなかったバグを
                          修正しました。
Mar. 7,1999             ・WinSFXM で「属性を復元」が機能していなかったバグを修
                          正した。
Mar.10,1999             ・ERROR_CANNOT_READ 及び ERROR_CANNOT_WRITE について細
                          分化した。
Mar.12,1999              (1.31.3.20; 正式版 UP)
Mar.12,1999  Ver 1.32   ・不必要な "-jx" 用カウントルーチンを削除。
                        ・ファイル数カウント表示の初期値表示の改善。
Mar.18,1999             ・エラーの細分化とチェックの強化。
                        ・MyFileTimeToDosDateTime() を使用するように変更した。
                          Win98 のタコぉ〜!! (^^;;
Mar.19,1999             ・Win98 の場合のみ  MyFileTimeToDosDateTime() を使用す
                          るようにした。
                        ・内部処理としては ftime←→time_t 間のコンバートを
                          time_t の範囲内で可能とした。 一応，これで UNIX 起源
                          のファイル (1980 以前のもの) でも大丈夫なはず…。
                        ・後面防止について，LHMelt と同じ処理とした。
                         (1.32.0.7; HP βUP)
Mar.20,1999  Ver 1.32a  ・ERROR_GET_ATTRIBUTES  以降でエラーコードが表示されな
                          かったバグを修正した。
                        ・"-t" スイッチについて， 書庫を閉じる前にタイムスタン
                          プを書き込むようにした。
Mar.21,1999             ・copyfile() での転送サイズの変更。
                        ・UnlhaCheckArchive() の場合にログバッファ出力を行って
                          しまうことがあったバグを修正した。
Mar.22,1999             ・ローカル設定ダイアログに『バッファをフラッシュ』の項
                          目を追加。この設定でやはり改善するようであれば，某
                          SystemDoctor の問題はかなり深刻といえる。(--;;  うん
                          にゃ， 下手をすると『某 NT4.0 SP3/SP4 の…』となる可
                          能性も…。(^^;;
                         (1.32.1.12; HP βUP)
Mar.23,1999  Ver 1.32b  ・なぜか NT 4.0 SP3/4 でだけ SystemTimeToFileTime() 等
                          が Invalid Parameter でエラーとなる不具合に対応。 バ
                          グ…ですかねぇ，やっぱり…『だけ』ってことは。(笑)
                         (1.32.2.13; HP βUP)
Mar.24,1999  Ver 1.32c  ・SYSTEMTIME  への代入・初期化の改善 (単に  wDayOfWeek
                          も設定するようにしただけ ^^;)
                        ・WinSFX32M のバグフィクス。
                         (1.32.3.15; HP&NIF βUP)
Mar.31,1999  Ver 1.32d  ・FindDirectory() の余計なコードを削除。
Apr. 8,1999  Ver 1.33   ・CheckDirectory() にディレクトリーメンバー ("DIR/"
                          等) が渡されるとチェックに失敗することがあったバグを
                          修正した。
                        ・"-t" スイッチのバグフィクス。
Apr.13,1999             ・ディレクトリーと同じ名前の書庫を開こうとした場合に圧
                          縮処理が行われてしまっていたバグを修正した。 (単に処
                          理前にエラーとなるようにしただけ)
                         (1.33.0.3; 正式版 UP)
Apr.14,1999  Ver 1.34   ・試しに static 宣言してあった SYSTEMTIME 構造体等の
                          ローカル変数を auto に戻してみた。
Apr.15,1999             ・英語版 SFX のスペルミスを修正。(爆)
                        ・CheckDirectory() のバグフィクス。
                         (1.34.0.3; 正式版 UP)
Apr.19,1999  Ver 1.35   ・ソースの細かな修正(メンテ用)
Apr.23,1999             ・ヒープ関係のエラーチェックの強化。
Apr.26,1999             ・ログバッファ用のポインタが未初期化で使用される可能性
                          のあったバグを修正した。
                        ・ショートカット等の一部変更(主に英語版)。
                         (1.35.0.4; HP βUP)
May. 3,1999  Ver 1.35a  ・UnlhaGetRunning() のチェック強化。
                        ・UnlhaOpenArchive() について， エラーの発生した場合に
                          もハンドルが返されてしまうことがあったバグを修正し
                          た。
May. 6,1999              (1.35.1.6; HP βUP)
May. 8,1999  Ver 1.35b  ・UnlhaOpenArchive() がエラーとなった場合に， 内部フラ
                          グが BUSY のままとなってしまうことがあったバグを修正
                          した。
May. 9,1999             ・Myunixtodos() のバグフィクス。
                        ・Win32  環境で正常に扱える範囲 (Jan.1,1980 00:00:00〜
                          Jan.19,2038 03:14:07) 外のタイムスタンプについて，エ
                          ラーとせず丸めさせるための "-jsf" スイッチを追加。
                          NTFS 上への書き込みの場合には  Jan.1,1970 00:00:00〜
                          Jan.19,2038 03:14:07 となる。 Win32 API が内部処理で
                          time_t を利用している事実がその理由。環境と API に
                          よって，0x7fffffff (2038 年) と 0xffffffff (2106 年)
                          のどちらかで破綻する。(^^;;  例えば， DosDateTimeTo-
                          FileTime() 等はヘルプ等では DosDateTime の範囲である
                          Dec.31,2107 23:59:58  まで扱える説明となっているが，
                          Win98 においては，上記の time_t == 0xffffffff である
                          Feb.7,2106 06:28:15 を超えると正常に変換されないのが
                          実際の動作である。(^^;;
                        ・裏技で↑の扱いを Feb.7,2106 06:28:15  までに拡張でき
                          るようにした。(笑)
May. 9,1999              (1.35.2.10; HP βUP)
May.10,1999  Ver 1.35c  ・"-d"  スイッチ付きで 'm'  コマンドを実行した場合に，
                          ファイルのつもりでディレクトリーを削除しようとしてし
                          まっていたバグを修正しました。
                        ・UnlhaOpenArchive()  に書庫以外のファイルを渡した場合
                          に，ヒープの開放し忘れが発生していたバグを修正した。
                         (1.35.3.12; HP βUP)
May.16,1999  Ver 1.35d  ・一応デバッグ情報表示ルーチンを条件コンパイルで削除で
                          きるようにした。 が，10KB と違わないので，とりあえず
                          はそのまま入れておくものとする。(^^;;
May.18,1999             ・Unlha() において，szCmdLine に NULL を渡すと一般保護
                          エラーとなってしまっていたバグを修正した。
Jun. 9,1999              (1.35.4.14; 正式版 UP)
Jun.11,1999  Ver 1.36   ・基本的にファイル操作をすべて  API ベースのものに変更
                          した。唯一の例外は一ヶ所の access()。(^^;;
Jun.16,1999             ・h0 形式でのディレクトリー・セパレータが '/' となって
                          しまっていたバグを修正した。
                         (1.36.0.2; HP βUP)
Jun.19,1999  Ver 1.36a  ・書庫のワイルドカード指定時の検索に再びディレクトリー
                          が引っかかるようになってしまっていたバグを修正した。
                        ・Myfclose() に不正なハンドルが渡された場合に， エラー
                          の無限ループとなってしまっていたバグを修正した。
                         (1.36.1.4; HP βUP)
Jun.20,1999  Ver 1.36b  ・Ver 1.36 以降，lh0 形式のメモリーへの展開ができなく
                          なっていたバグを修正した。
                         (1.36.2.5; HP βUP)
Jun.24,1999  Ver 1.36c  ・書庫更新時に作成日時等が書き込めなかった場合にエラー
                          としていたものを，解凍時等と同じく二次的処置として更
                          新日時を書き込むように改善した。DOS 起源の書庫等作成
                          日時が不明のものが扱えなくなる環境が存在するようなの
                          で…。(^^;;
Jul. 4,1999  Ver 1.36d  ・タイムスタンプの範囲チェックについて，UTC ではなく，
                          ローカルタイムでチェックするように改善した。FAT にお
                          いてはローカルで記録されるので…。(^^;)
Jul.26,1999  Ver 1.36e  ・UnlhaConfigDialog() で返されるスイッチ文字列の改善。
Jul.29,1999             ・WinSFX32 について， WinSFX32M のサブセットのものに更
                          新した。しかし…サイズが 22KB と 4KB 肥大化してしまっ
                          ている。(T_T)
Jul.30,1999             ・WinSFXM のバグフィクス。
Aug. 1,1999             ・WinSFX32M の仕様追加 ($GroupTitle 及び $Class におい
                          てオン・オフの省略値を指定できるようにしたもの)。
                         (1.36.5.11; 正式版 UP)
Aug.16,1999  Ver 1.37   ・MyGetTempPath() を使用していたものを， GetTempPath()
                          を使用する仕様に戻した。
Sep. 6,1999  Ver 1.40   ・言語指定を行う SetLangueJapanese() 等を追加した。
                        ・MyGetTempPath() を再び使用するように変更した。仕様は
                          以前のものとは若干異なっている。
                         (1.41.0.2; 正式版 UP)
Sep.15,1999  Ver 1.41   ・Win2000 の場合にフォントサイズが正常に取得できていな
                          かったバグを修正した。
Sep.17,1999              (1.41.0.1; 正式版 UP)
Oct. 5,1999  Ver 1.42   ・WinSFX32M について， $GroupTitle=，$ClassTitle= が指
                          定されていない場合には，未チェック状態でチェックボッ
                          クスを表示するようにした。
                        ・WinSFX32/WinSFX32M について，$WindowTitle=，$Install-
                          Title= の指定可能文字数を 80 バイトに増やした。
Oct. 6,1999             ・既存の定義済みの SFX 書庫について， 正常に認識できな
                          いものがあったバグを修正した。
Oct.13,1999             ・"-ga2" スイッチの追加。 この "-ga2" スイッチを指定し
                          た状態が LHA 本来の動作 (つまり，リードオンリー属性
                          のファイルについては，常に上書き展開しない)。
Oct.17,1999              (1.42.0.4; 正式版 UP)
Oct.22,1999  Ver 1.42a  ・ひ〜。 公開版で 1.42.0.6 の内，Lhasa Ver 0.13 インス
                          トーラ認識部分のコードが抜けてしまってたぁ〜。(T_T)
Nov.11,1999             ・SFX  設定ダイアログにおいて， WinSFXM に対して『古い
                          ファイルも更新』の設定が行えなくなってしまっていたバ
                          グを修正した。むぅ〜，いつからじゃぁ？
Nov.22,1999             ・DosSFX  が正常に認識できない場合があったのと， 1.36e
                          以降で WinSFX32M Ver 2.60.w32.34 以降の SFX が正常に
                          認識できていなかった 2 つのバグを修正。
Nov.22,1999             ・copysfx() で文字列が未代入のままバッファが使用される
                          可能性のあったバグを修正した。
Nov.23,1999              (1.42.1.8; 正式版 UP)
Nov.27,1999  Ver 1.43   ・特に問題ないようなので，"-p2" スイッチの動作を "-r2"
                          と同じにした。 従って，"-p2" スイッチについては，ARJ
                          と異なり，'a' コマンド等についても有効となっている。
                          ARJ では，"-p1" スイッチは書庫内の格納ファイルの検索
                          にのみ有効となる。
Dec. 5,1999             ・文字列コピー時等のチェック強化。
                        ・エラーログについても GetLastError() のコードを出力す
                          るようにした。
Dec. 6,1999              (1.43.0.3; 正式版 UP)
Dec.15,1999  Ver 1.44   ・SFX への変換時のファイル名チェックを強化。…って，手
                          抜きしていた部分に手を入れただけ。(笑)  SFX 側で対応
                          したいところではあるが，相当肥大化してしまったので見
                          送り…。(T_T)
                        ・RenameFile() 及び CheckEnumMember() のバグフィクス。
                          うるうる…。頭の中からすっかり『対象』として抜けてし
                          まっていたおかげで結構悲惨な状態だった…。(T_T)ダー
Dec.19,1999              (1.44.0.2; 正式版 UP)
Dec.25,1999  Ver 1.44a  ・Myfopen() のバグフィクス。ただし，現バージョンでは表
                          面化しない。UNLHA32.DLL においては，その部分のコード
                          を通ることがあり得ないので…。あ，コード領域が壊れる
                          とかスタックが壊されるとかで，偶然その部分にジャンプ
                          してくることは考えられるか…。(笑)  まぁ，バグといっ
                          てもキャッシュの方法が変わるだけで，要は効率の問題な
                          んだけど…。
                        ・動作確認として，読み込みの場合に，常に FILE_SHARE_
                          WRITE を付加してファイルを開くようにするレジストリー
                          項目を追加。しっかし，こんなのが必要になるようなら，
                          そのシステムの変更を考えたほうがいいと思うが…。(--;;
                          ご同様に，"-jso1" を指定して問題が発生する環境につい
                          ても，その環境及びプログラムの仕様変更を考慮したほう
                          が得策。巷の圧力で "-jso0" が初期値となっているのは，
                          個人的には納得できないものが…。(T_T)
                         (常に FILE_SHARE_WRITE としたものを実験場に UP)
Jan. 3,2000             ・動作確認第 2 段として，ファイル処理のバッファを 32KB
                          に縮小。
                         (実験場に UP)
Jan. 5,2000             ・バッファのサイズを指定できるように変更。…って，最初
                          からこのつもりだったわけだけど…。3 日の変更が手抜き
                          モードだっただけぇ。(笑)
                        ・どうやら 64KB 以下なら大丈夫そうなので，初期値をとり
                          あえず 64KB とすることにした。再現率が違うだけで，や
                          はりというか LaVie でも 4050X でも再現が可能であった
                          のが…。(^^;;  それにしても，64KB を超えて一気に読み
                          込むだけで，キャッシュを含めてそのメディアからの読み
                          込みすべてが化けるようになる  Win95/98 って…。(--;;
                          おそらく不安定な 1.2MB FDD で顕著化するだけで， 他の
                          1.44MB FDD どころか HDD でも再現するんだろうなぁ…。
                          その点， とりあえずは自他の環境で再現できていない NT
                          はしっかりしているということが言えるのかな？ (^^;)
Jan. 6,2000             ・ヘッダ形式やデバイスに従ってタイムスタンプの有効範囲
                          を変更するように改善した。 ただし，2038 年以降のデー
                          タに関しては，  これまでどおり 2038 年に丸める仕様と
                          なっている。
                        ・ファイルコピー等でもそうなっていることから，タイムス
                          タンプの丸めを行う  "-jsf1" を初期値とするように変更
                          した。
                          ついでに，以前の版では無条件に丸めていたものを書庫の
                          情報やデバイスに従って範囲を変更して丸めを行うように
                          改善した。
Jan. 7,2000             ・↑について，下位ルーチンのバグのため，常に補正を行っ
                          てしまっていたバグを修正した。
                          補完範囲のための実験をしていたところ，Win95 系での
                          Y2K 問題が発覚。というか，おそらく過去に MS が行った
                          2000/02/29 問題が， 『修正』ではなく単なる『手抜き』
                          だったことが証明されたというか…。(笑)  具体的には，
                          Win98 では  DosDateTimeToFileTime() が 2100/02/28 を
                          超えた時点で破綻する。 実際には変換後には日付が 1 日
                          進んでしまっている。ただし，それは 2100/02/28 近辺で
                          の話であって，オーバーフローが原因している関係から限
                          界 (であるはず) の 2107/12/31 辺りでは全く脈絡のない
                          数値に変換されてしまっている。(爆)
                          なお，この 2100 年問題は NT 系では見られないが， dir
                          コマンド等が 2100 年以降で正常に動作しないところをみ
                          ると 2100 年以降のタイムスタンプはやはり扱わないほう
                          がよさそうである。(T_T)
Jan. 8,2000             ・しくしくしく…。UNLHA32.DLL の Y2K 問題が発覚。(T_T)
                          Mydostounix() 及び Myunixtodos() において，『2000 年
                          のうるう年』を考慮し忘れていたために 2100/1/1 以降の
                          時間を示す time_t の数値がすべて  1 日ずれて扱われて
                          しまっていたもの。100 年毎の処理の際に通常どおりの数
                          値である 36524 を引いてしまっていたのが敗因。(T_T)
                          なお，100 年処理の部分での間違いなので，2000-99 年の
                          100 年間については (それ以前も含めて) 全く問題ない。
                        ・7 日のテスト結果を考慮して，2099/12/31 23:59:58 で丸
                          め処理を行うように変更した。こと FILETIME 構造体を
                          使っての処理に関しては，システム自体に 2038 年問題が
                          存在しないようなので…。ランタイムや他のアプリがどう
                          転けようと，それはそっちの問題…ということで，DLL 側
                          では余計な丸めは行わないこととする。これに伴い，隠れ
                          スイッチの Use2106 は意味をなさなくなっている。 指定
                          は可能だけど…。(笑)
Jan. 9,2000              (1.44.1.12; 正式版 UP)
Jan.12,2000  Ver 1.45   ・最終的にテキストとして利用される場合を考慮して，表示
                          の際の改行を "\r\n" に変更。
                        ・あうぅ〜。LHA の隠しスイッチまで網羅してないぞ。調べ
                          ている暇がないから，突っ込まれたものについて対応する
                          ことにしよう…。(笑)
                          ということで，'l' コマンド時の "-n" スイッチについて
                          対応。
Jan.16,2000              (1.45.0.2; HP βUP)
Jan.18,2000  Ver 1.45a   (UNLHAVC.LIB を更新)
Jan.19,2000             ・BackSep() のバグフィクス。
Jan.22,2000              (1.45.1.3; 正式版 UP)
Jan.28,2000  Ver 1.46   ・書庫が空になった場合や新規書庫を作成した場合に，タイ
                          ムスタンプの設定に失敗してしまうことがあったバグを修
                          正した。
                        ・WinSFX32 について， 対応していない項目が設定ダイアロ
                          グで指定できてしまうバグを修正した。というか，SFX の
                          ほうで対応化してしまった。(笑)
                        ・WinSFXM，WinSFX32(M) について， 『自動実行』を指定し
                          た場合にコントロールを無効とするようにした。
Jan.31,2000              (1.46.0.3; HP βUP)
Feb. 6,2000  Ver 1.46a  ・"-u2" スイッチが正常に機能しなくなっていたバグを修正
                          した。
Feb. 9,2000             ・UNC で指定された場合に，正常に解凍先ディレクトリーを
                          作成できないことがあったバグを修正した。
                        ・"-jf2" スイッチがちゃんと機能するようにした。(^^;;
Feb.10,2000             ・ヘッダサイズの下位が 0x00 となる場合の処理が見事に抜
                          けていた大バグを修正した。 LHx 2.02 の頃って，まだ対
                          処されてなかったのね。(^^;; むぅ〜。LHA 2.11b のソー
                          スを見落としてたのか…。(^^;;;
                        ・自己解凍書庫作成時において，処理中断が発生すると作業
                          書庫が残ってしまっていたバグを修正した。
Feb.11,2000              (1.46.1.8; HP βUP)
Feb.14,2000  Ver 1.46b  ・ログ出力の改行コードについて， "\n" と "\r\n" の選択
                          を設定ダイアログで行えるようにした。しっかし，改行
                          コードの決め打ちを行っているソフトって多いのね。(T_T)
                          裏技で， "\n" を使用するモジュール名を指定できるよう
                          になっている。
                        ・GetExeName() のバグフィクス。
Feb.15,2000              (1.46.2.10; 正式版 UP)
Feb.15,2000  Ver 1.47   ・"-ga" スイッチのバグフィクス。
Feb.16,2000             ・DLL のロード時にウィンドウクラスの定義を行うように改
                          善した。
Feb.23,2000             ・VC++ 4.0 に移植。(^^;; どうも BC++ は Inprise のその
                          他のコンパイラーと同様， malloc() 周りにメモリーリー
                          クとおぼしき挙動が見受けられるので。(^^;;;
                          VC++ 『4.0』である理由は単純で，『それを使わないと，
                          Win95/NT4.0 以降でしか動作しないものが出来上がる』か
                          らだったりする。(^^;)  とは言うものの，4.0 は std し
                          か持っていないので，CL だけ 5.0 pro にご登場願ってい
                          る。(爆) リンカは 5.0 のを使うと Win32s 等が嫌がるみ
                          たい。(^^;)
Feb.24,2000              (1.47.0.3; HP βUP)
Feb.29,2000  Ver 1.47a  ・書庫操作後に  CRC チェックを行う "-jsv" スイッチを追
                          加。
                        ・WinSFXM，WinSFX32(M) での『自動実行』のバグフィクス。
                        ・UnlhaOpenArchive() でエラーが発生した場合に， 書庫が
                          開かれたままになってしまうことがあったバグを修正し
                          た。
                        ・基準とするフォントの変更。
Mar. 5,2000              (1.47.1.7; 正式版 UP)
Mar. 7,2000  Ver 1.47b  ・1.47.1.4 の修正で，書庫が空となったにもかかわらずチェ
                          ックを行おうとしてしまっていたバグを修正した。
Mar. 8,2000              (1.47.2.8; 正式版 UP)
Mar.13,2000  Ver 1.48   ・Myfopen() 等の関数を UNARJ32.DLL のものに変更した。
                        ・『異なったファイル』を指定する  "-u3"，"-gf3" スイッ
                          チを追加した。
Mar.14,2000              (1.48.0.2; HP βUP)
Mar.16,2000  Ver 1.48a  ・Myfseek() のバグフィクス。
Mar.18,2000              (1.48.1.3; HP βUP)
Mar.24,2000  Ver 1.48b  ・フォント取得関係を，ちこっと修正。
Apr. 6,2000  Ver 1.49   ・MAC 起源の書庫で 0x20 未満のコードが埋め込まれている
                          と解凍できなくなってしまっていた不具合に対応した。
                        ・書庫 CRC  チェックの前に『取消』ボタンを無効とするよ
                          うにした。
May.18,2000               (1.49.0.2; 正式版 UP)
May.23,2000  Ver 1.49a  ・NT の場合に， 可能であれば解凍時にディレクトリーのタ
                          イムスタンプを復元するようにした。
                        ・ディレクトリーの属性が復元されていなかったバグを修正
                          した。(^^;)
                         (1.49.1.4; 正式版 UP)
May.26,2000  Ver 1.50   ・WinSFX32 2.14 に対して  lh7 形式での格納が行えなかっ
                          たバグを修正した。
Jun. 5,2000             ・'a' コマンド等で  "-u2" スイッチ等が機能していなかっ
                          たバグを修正した。
                        ・'f' コマンドで  "-u2" スイッチ等を使用できるようにし
                          た。
Jun.12,2000             ・WinSFX32(M) について UNC に対応した。 ただし，"-jf2"
                          スイッチによるドライブレター付きパスには対応していな
                          い。また，WinSFXM について自動実行の設定の場合に
                          『ディレクトリー指定エラー』が発生するとハングしてい
                          たバグを修正した。
                         (1.50.0.4; 正式版 UP)
Jun.27,2000  Ver 1.51   ・"-u" 及び "-gf" スイッチの仕様を ARJ に合わせた。 と
                          いうか，今までが，ある意味バグ…。(^^;;
Jul.16,2000              (NOTE.TXT を追加。)
Jul.23,2000              (1.51.0.1; 正式版 UP)
Jul.25,2000  Ver 1.52   ・DialogBoxIndirect()  等をまじめに GlobalAlloc() して
                          呼び出すように改善。(^^;;  Win32s を含めて問題は出て
                          いないわけだが，お作法に従わないとダメなプラット
                          フォームがあるかもしれないし…。
                          しっかし，『GMEM_MOVEABLE だとダメ』ってんじゃ，なん
                          のためにグローバルメモリーを使わせてんだ？ ＞API
                        ・malloc() 呼び出し等のチェックを強化。とは言うものの，
                          自前でリストを作成して管理したりしている関係上，時と
                          場合によっては『死ぬほど遅くなる』可能性が…。(^^;;
                          DLL の解放時にリークを見つけると『問答無用でメッセー
                          ジ表示する』ので，見かけたら連絡してね。(爆)
                          1.52 の正式版か 1.53 までに，レジストリーで (この
                          件の) チェックの有無を指定できるようにはする予定…。
                          ついでに，ファイルハンドル等『リーク』の発生しそうな
                          一連について御同様のチェック処理をつけよう
                          かと…。(^^;;
                        ・結局その日のうちにレジストリーで↑のチェックの有無を
                          指定できるようにしてしまった。(^^;; 重さが気になって
                          かつ指定による改善が見込めるのなら  "HeapCheck" を 0
                          にしてくんろ。
Jul.26,2000             ・ダイアログでのファイル数表示が WORD で行われてしまっ
                          ていたものを改善した。
Jul.27,2000             ・API 終了時にリークチェックを行うようにした。あんまり
                          これのお世話にはなりたくないなぁ。(^^;;
Jul.28.2000             ・リークチェックについて，レジストリーで 2  を指定した
                          場合のみメッセージを表示するようにした。1 ではチェッ
                          ク (と解放) のみ。
Jul.29,2000             ・Ver 1.51 の仕様変更により WinLM32 等が正常に動作しな
                          くなってしまっていた。 これに伴い Ver 1.46b での変更
                          と同様，設定ダイアログで新・旧の動作の選択を行えるよ
                          うにした。レジストリーでソフトの個別指定を行ったほう
                          がいい…という点についても同じ。(^^;)
                         (1.52.0.7; HP βUP)
Jul.31,2000  Ver 1.52a  ・邪魔臭いので， WinLM32，WinFM32，WinFM2K の 3 つにつ
                          いては強制的に旧仕様で動作するようにした。あくまでも
                          暫定措置。ついでに GV についても旧ログ改行で動作する
                          ように変更。将来的にその措置が影響して反対に不具合が
                          発生しても，私の与り知らぬことじゃ。(笑)
                          ということで，安定度にいまいち不安があるが，さっさと
                          暫定正式版 UP とする。1.51 の公開時期から考えて， 今
                          公開しておけば雑誌収録の影響は比較的少ないはず…。
                         (1.52.1.8; 正式版 UP)
Aug. 5,2000  Ver 1.52b  ・スイッチ関係のログ出力を追加。
Aug. 7,2000             ・圧縮を中断するとメモリーがリークしてしまっていたバグ
                          を修正した。一応 Ver 1.52 以降では自己診断機能で自動
                          的に解放されていたりする。(笑)
Aug.12,2000             ・スイッチ関係のコードを全面改訂。(^^;; コードはすっき
                          りしたが，サイズは肥大化。(爆)  これに伴い，未定義の
                          スイッチが指定された場合にログを出力するようになって
                          いる。
                        ・"-d0" が指定された場合の動作を， 実質 lhd メンバー作
                          成の有無のみが影響する "-a1" 相当とした。要は "-d1a1"
                          と同じ。
                        ・不正な日付の書式指定についてエラーとしていたものを，
                          警告ログを出力するのみとした。データについては補正が
                          行われる。年は 00 (2000年)，それ以外は正常な範囲への
                          丸め処理となる。
                        ・格納時にファイル名のケースを区別してしまうことがあっ
                          たバグを修正した。
                         (1.52.2.14; HP β版UP)
Aug.23,2000  Ver 1.52c  ・格納時にパスを含めてすべて小文字に変換する  "-i3" ス
                          イッチを追加した。
Oct.12,2000             ・空きサイズを取得できなかった場合の処理を指定する
                          "-jsd" スイッチを追加。
Oct.17,2000             ・WinSFX32(M) について，lhd メンバーのタイムスタンプ及
                          び属性の復元に対応した。ようやくサイズの増加を抑えて
                          の実装に成功。その代わりコードはぐちゃぐちゃ。(笑)
                        ・格納ファイルが全く SFX に格納されなかった場合に， 作
                          業ファイルのコピーを行おうとしてしまうことがあったバ
                          グを修正した。
                         (1.52.3.18; 正式版 UP)
Oct.20,2000  Ver 1.53   ・状況ダイアログでのサイズ表示を 3 桁位取りにした。
Oct.26,2000             ・'l' コマンド等によるリスト出力以外のすべての箇所で位
                          取りを行うようにした。付随して，進捗グラフの小数点も
                          ちゃんと地域設定を反映するようにした。(^^;)
                          なお，地域設定は DLL ロード時に決定される (手抜き)。
Oct.27,2000             ・上書き確認時の日付表示がおかしくなっていたものを修正
                          した。(日本語設定なら年が 2 桁で表示されるだけだが，
                          他の設定だと意味不明に…。^^;)
                        ・"-jn" スイッチの存在確認処理のバグを修正した。
Oct.30,2000             ・格納ファイル検索打ち切り処理がワイルドカードの有無に
                          頼ったものとなってしまっていたバグを修正した。これの
                          せいで，"-r2" などとともにディレクトリーを直接指定し
                          た場合などは完全敗北していた。(T_T)
                        ・"-p"  スイッチを使用すると状況表示ダイアログが表示さ
                          れてしまっていたバグを修正した。なんで，あんなところ
                          にあんなコードがまぎれていたのじゃろう？ (^^;;
                         (1.53.0.6; 正式版 UP)
Oct.31,2000  Ver 1.53a  ・WinSFX(M) について，"lhd" メンバーが正しく復元されて
                          いなかったバグを修正した。
Nov. 2,2000             ・1.53.0.3 について， SFX の上書き確認のほうをすっかり
                          忘れていた…。(^^;;
Nov. 3,2000              (1.53.1.8; HP β版UP)
Nov. 8,2000  Ver 1.53b  ・1.52.2.11 で "-l" スイッチがバグってしまっていたもの
                          を修正。やっぱり仕込んでたかぁ。まだありそうだなぁ。
                        ・"-l1" を指定した場合に，不正な値がカウント表示される
                          ことがあったバグを修正した。
Nov.10,2000             ・いつの間にか解凍時のタイムスタンプチェック (ただし，
                          "-u" 時)  が無効となってしまっていたバグを修正した。
                          …というか， 少し記述を変えて (といっても !E を E ==
                          FALSE とした程度) みたら，正常動作したので，その後元
                          に戻してコンパイルしてみたら…ちゃんと動作した。(^^;)
                          SP をちゃんと適用してあるものであるが，VC++ 5.0 には
                          まだしゃれにならないバグが潜んでいるらしい…。しっか
                          し if (!E) を if (1)  のように文字化けコンパイルしな
                          いで欲しいぞ。(笑)
                        ・リードオンリーファイル上書き確認ルーチンの整理。無駄
                          なフラグが使用されていたもの。
                        ・1.52.2.11 以降で数値指定なしの  "-jd" スイッチが正常
                          に機能しない可能性のあったバグを修正した。
Nov.11,2000             ・おっと， ParseDirectory() がバグりかけていた…。危な
                          い危ない…。(^^;;
                         (1.53.2.14; 正式版 UP)
Nov.13,2000  Ver 1.53c  ・WinSFX32(M) 以外の自己解凍書庫の作成に失敗する上に，
                          ヒープをぶち壊してしまう， 原因不明のバグが 1.53b で
                          発生したので， 一思いに Ver 1.53a からソースを起こし
                          直した。(T_T)
                        ・ウィンドウクラスの登録に失敗した場合に，不正なポイン
                          タを解放する可能性があったバグを修正した。裏技で
                          チェックを無効にしていない限りは表面化しないはずでは
                          あるが…。(^^;)
                         (1.53.3.16; 正式版日替わりモード UP)
Nov.14,2000  Ver 1.53d  ・ソースを元に戻してしまったので，再びマジックナンバー
                          の定義化開始。(^^;;
Nov.17,2000             ・1.53.2.11 でフィクスし切れていなかったものを修正。し
                          かし，このコードだと『発生するなら 100% 発生』のはず
                          なのに，なんで環境によるんだ？ (^^;;
                         (1.53.4.18; 正式版 UP)
Nov.28,2000  Ver 1.53e  ・WinSFX32(M) について，lhd メンバー絡みのバグフィクス
                          を行った。
Nov.29,2000             ・1.31.2.16 のコード変更に伴い，同じファイルが重複して
                          格納されてしまっていたバグを修正した。これにより，お
                          そらく再び検索処理がリスト照合数に応じて指数関数的に
                          遅くなるはず…。試してみたところ，4,000 くらいから気
                          になる速度低下が出初め， 10,000 を超える頃には無視で
                          きない (我慢できない ?) 速度低下が…。(^^;;
                          たとえ検索速度の劇的低下を伴うとしても，必要な処理で
                          あれば，仕方のないところ…。(T_T)
                          重複チェックを行わせない "-jsl" スイッチを追加してお
                          いたので，重複指定の発生が少ないと思われる一般のアー
                          カイバ・アプリでは， "-jsl" スイッチを付加しておくの
                          もよいだろう。時間が獲れたときにでもリスト作成ルーチ
                          ンの改善を行わないと…。単純な線形リストを，ハッシュ
                          で  512 くらいに振り分けた上での線形リスト…なんての
                          に変更しただけでもかなりの改善が見込めるはずなので。
                         (1.53.5.20; HP β版UP)
Nov.30,2000  Ver 1.53f  ・というわけで，ハッシュによる振り分けを行った。いくつ
                          かハッシュ関数を試したところ結構偏りが出たので，『下
                          手な関数よりマシ』ということで CRC を使用， 実に均等
                          に振り分けられた。(爆)  1,024 の振り分けで 60,000 弱
                          のファイルが 50〜60 ずつになれば十分じゃろう。(^^;)
                          ファイル名を調べる以上，同じファイル名のものが多数存
                          在し，結果として同じハッシュ値 (CRC 値) ばかりになる
                          可能性は当然ながらあるわけだが，そこは仕方がない。
                          例えば， ↑の実験は WEB ページをローカルに再構築した
                          ものなので，"index.html" なんてファイルが 2,000 個く
                          らい存在するわけだが，少なくともパス情報付きで格納し
                          た限りは偏りが発生しなかった。パス情報を無視させた場
                          合は， (リストに追加されれば) 一つのハッシュに 2,000
                          個がぶら下がる結果となるわけだが，リストに追加されな
                          いかエラーとなるかなので，実害は少ないと思われる。
                          しっかし， 10 分でコーディングできるくらいなら，ここ
                          までやってからβ公開すればよかった…。ま，実験が結構
                          時間を食うものだから，無理なんだけどね。(笑)
                         (1.53.6.21; HP β版UP)
Dec. 1,2000  Ver 1.53g  ・リークチェック等の管理においても，ハッシュ振り分けを
                          採用した。 Ver 1.52 以降でメモリー解放時の時間的コス
                          トがべらぼうに高くなっていたが，これで相当改善された
                          はず…。 80,000 個ほどのポインタの解放で 1/10 くらい
                          に時間短縮されたので，とりあえずはこんなもので
                          しょう。
                         (1.53.7.22; HP β版UP)
Dec. 3,2000  Ver 1.53h  ・WinSFX32 において，ファイルを 1 つ解凍し終えた時点で
                          終了してしまっていたバグを修正した。 break 文が 1 行
                          ずれていたのが敗因。それもこれも DynaBook のチャタリ
                          ング現象が悪いのじゃ。苦情と請求は東芝まで。ヾ(^^;)
                          「テクノセンター持ち込みしか対応しない」って，どうせ
                          現場でファーム書き換え FD を使うくらいなら， FD の送
                          付くらいしろっての。(^^;; HDD の不具合といい，利益を
                          全部吐き出した  FDC の不具合に匹敵するものばかりでっ
                          せ。判ってんのかなぁ〜，ほんとに。不具合付きの仕様の
                          まま 2 年も 3 年も何十種類と製品を出して…。HDD のほ
                          うなんて，OEM 供給した他の企業からも請求される可能性
                          があるってのに。横の繋がりが悪いから，きっとそれぞれ
                          の開発実動部隊には伝わっていないに違いない。(笑)
Feb. 4,2001  Ver 1.54   ・1.52b 以降で，"" 等空の文字列が指定されると， ゴミが
                          まぎれることがあったバグを修正した。
                         (1.54.0.1; HP β版UP)
Feb.16,2001  Ver 1.54a  ・MakeDirectorySub() のバグフィクス。 シングルバイトし
                          か考慮していない箇所があったため，たまにディレクト
                          リーの作成に失敗してしまっていた。
                         (1.54.1.2; 正式版 UP)
Mar. 7,2001  Ver 1.54b  ・WinSFX32M について，日本語版と英語版を統合した。これ
                          に伴い，英語環境用の $ コマンドが追加されている。
                        ・WinSFX32M について，インストール情報を記録する $File-
                          Info を追加した。汎用ではなく，殆ど LHMelt 付属の
                          DELREG.EXE 専用。作者の特権である。(笑)
Mar. 9,2001              (1.54.2.4; HP β版UP)
Mar.12,2001  Ver 1.54c  ・WinSFX32M をさらに更新。が，でかくなってしまったのが
                          難点。(^^;;
Mar.14,2001             ・WinSFX32M のサイズ縮小化…。500 バイトだけど。(笑)
                          現状ではこれが限度。
Mar.16,2001              (1.54.3.6; 正式版 UP)
Mar.18,2001  Ver 1.54d  ・DELREG.EXE のバグフィクス。 ついでに，WinSFX32M にも
                          DELREG 用のレジストリー設定を行う改善を施した。
                         (1.54.4.7; 正式版 UP)
Mar.25,2001  Ver 1.55   ・WinSFX32M について，.inf ファイルを使用するための
                          $UseInf を追加。Ver 1.54b 以降の変更は，はっきりいっ
                          て LHMelt，UNLHA32.DLL，etc...  のインストール対策の
                          変更ばかり…。(笑)
Mar.27,2001             ・WinSFX32M について，Win32s 用のコマンドを追加。 殆ど
                          使われることがないだろうし，混乱の素なので，非公開。
                          …にしようと思っていたのだが，NT3.x でも必要になるの
                          で，やっぱり公開。(笑)
Mar.28,2001             ・WinSFX32M のバグフィクス。
                        ・WinSFX32 をバイリンガル化。また，WinSFX32M の修正点
                          を適用。
Mar.31,2001             ・WinSFX32M / WinSFX32 の更新及びバグフィクス。
Apr. 2,2001             ・WinSFX32M / WinSFX32 について，Win32s 方面のバグフィ
                          クス。ふぅ〜。Win32s の版によっても異なるわ，ベン
                          ダーによっても異なるわ…。以前の版では『たまたま』動
                          いていただけなのね…。(^^;;
                        ・DELREG.EXE について，WinSFX32M 等の変更等に対応。
Apr. 3,2001              (1.55.0.7; 正式版 UP)
Apr. 5,2001  Ver 1.55a  ・FindFirst() 時の検索について，UNZIP32.DLL と同じよう
                          に，"-r" 指定相当の動作を基本とするようにした。 ある
                          意味これはバグ。(^^;;
                        ・FileSearch() 関係のバグフィクス。
                        ・はうん。WinSFX32(M) にバグを仕込んでしまった。(T_T)
Apr. 6,2001             ・基準パスを付加する "-jb" スイッチを追加。
                         (1.55.1.11; 正式版 UP)
Apr.10,2001  Ver 1.55b  ・WinSFX32(M) について， $Command 等のコマンドではセパ
                          レータ変換を行わないようにした。
Apr.11,2001              (1.55.2.12; HP β UP)
Apr.18,2001  Ver 1.55c  ・64KB  超のスライド辞書を利用したメソッドを追加するた
                          めの下準備。(^^;;
Apr.19,2001             ・ファイル名サブヘッダが存在しない h2 形式書庫に対応し
                          た。って，それって『不正な書庫』以外の何物でもない気
                          がするぞ。(^^;; オリジナルのソースを見れば，書庫作成
                          時に無条件に付加されているのが解るはずなのに…。とい
                          うか， h2 形式には基本ヘッダにファイル名項目が存在し
                          ないから嫌でも必要になるのじゃが？ たとえ lhd メンバー
                          でも…。lhd メンバーをまともに扱えない (または無視す
                          る) プログラムで読んだら間違いなく落ちることじゃろう。
                          反対に，こっちが落ちるのは，それはそれでタコなので，
                          対処療法は施しておくけど…。(笑)
                        ・続けてディレクトリー名サブヘッダに末尾のセパレータが
                          存在しない場合について対処。これも本来なら不正ヘッダ
                          なのじゃが…。(--;)
                          しっかし，さすがというか，かなりあとまでその辺りの
                          コードがなかったはずの  LHA は Ver 2.13 の頃には全部
                          対処済みになっていた。過去ログを見ると，確かに有名に
                          なるにつれて，わけの解らない書庫が登場してきているよ
                          うで…。(^^;;
Apr.23,2001             ・64KB 超関係でこの週末ごちゃごちゃやっていたが， とり
                          あえずコードを全部削除。(笑)
                        ・lh6 の場合のコードをちこっと修正。多少のメモリー効率
                          以外表面化なしなので，別に修正しなくてもいいわけでは
                          あるが…。(^^;;
Apr.24,2001             ・リーク報告を目にすることが皆無だったので，デフォでは
                          チェックを行わないようにした。
Apr.25,2001             ・実験用にスライド辞書を 512K にしただけのメソッドを復
                          活。当然ながら圧縮率は悪くなっている。(^^;; この辺り
                          については，COMMAND.TXT の考察を参照。
Apr.26,2001             ・未知の圧縮形式が記録されたヘッダに対してエラーとして
                          いたものを，通常のヘッダ読込時には正常読み込み扱いと
                          するように改善した。
                        ・128K〜512K 用のヘッダを  "lhx" に変更。 他のアーカイ
                          バーと同様，辞書サイズにかかわらず一定のヘッダを使用
                          するように変更した。CAB 等のようにヘッダに辞書サイズ
                          の記録がないので，展開時には『ハフマン木を構築してみ
                          て初めてサイズが判明』という実は結構恐い仕様だった
                          り…。AR950528  のように『とりあえずメモリーを最大値
                          確保しておく』というルーチンでないと，確実に一般保護
                          エラーとなるであろう。ま，DJLHA 対策を施してあるエン
                          ジンなら当然そうなっているはずだし…。(笑)
                          巷には lh7 の延長としての lh8/lh9 形式を実装している
                          エンジンもあるようだが，このメソッドヘッダは使わない
                          ものとする。LHA Ver 2.6x で lh7 までは半分保証された
                          感じではあるが， 同じアルゴリズムで lh8/lh9 が実装さ
                          れるとは限らないので…。
                        ・"lhx" 用の辞書サイズを指定する "-jmm" スイッチを追加
                          というか復活した。12〜19 の指定が可能。省略値 19。小
                          さいサイズでは既存のメソッドのほうが有利なので，実際
                          には指定するとしても 17〜19 しか意味がない。
                        ・ExtractCheck()  がファイルサイズを返していなかったバ
                          グを修正。げ，結構いろんなところに影響を及ぼしていそ
                          うな…。
Apr.27,2001             ・圧縮の際にアラインメントの関係でバッファオーバフロー
                          を起こすことがあった大バグを修正した。まれにヒープが
                          壊れていたのは，全部この関係？ (^^;;
                        ・API 等に値を渡す前に  ftime について範囲チェックを行
                          うようにした。通常は丸めを行い，"-jsf1" でエラー扱い
                          となる。
Apr.30,2001             ・↑について， ちゃんと 100 年対策等を行うように修正。
                          今のままだと 2100 年で倒けます。(笑)  他の同様の箇所
                          も『右に同じく。』 (^^;;
                        ・うぎゃぁ〜。SFX 方面のメソッド番号を変更するの忘れて
                          たぁ〜!!  おお，よくぞエラーとならずに展開できないだ
                          けで済んでいた…。(^^;;
May. 1,2001              (1.55.3.27; 正式版 UP)
May. 3,2001  Ver 1.55d  ・"lhx" の場合にハフマンバッファがオーバーフローを起こ
                          すことがあったバグを修正。そう言えば，1 バイト余計に
                          書きこんでるんだった…。(^^;;
                        ・ftime の範囲チェックが正常に行われないことがあったバ
                          グを修正。 しっかし，警告を最大にしているのに， VC++
                          は『The function should return a value.』の類いを報
                          告しないのかぁ？(--;; 1.55c のときは BC++ でのチェッ
                          クを忘れてたしぃ〜。お約束のように，そういう時に限っ
                          てバグを仕込むしぃ〜。(^^ゞ
                         (巷のルーチンには結構 downheap() でソートの類いを行っ
                          ているものがあるので，試しにいろいろやってみた。予想
                          どおりオリジナルのほうがマシという結果に。(^^;)
                          オリジナルの優先待ち行列は， (結果として) ヒープソー
                          トの計算量を減らしたものという様相を呈している。従っ
                          て，挿入ソート付きの相当高速なクイックソートやマージ
                          ソートに登場願っても，そのままでは太刀打ちできない。
                          どころか，一旦ソートしてしまえば以降ソートしなくて済
                          む点を利用して downheap() の呼び出し回数を抑えても，
                          まだ勝てない。downheap() を呼ばない代わりに，heap の
                          シフト等が必要になるが (シフトをしない場合は，比較時
                          のアドレシングの計算量が増え，シフトするのと大差なく
                          なる)， このシフトのコストとオリジナルの  downheap()
                          のコストの差が小さいことから，最初のソートのコストが
                          高くつき過ぎるのである。
                          downheap() 周りについては， 下手に小細工するよりも，
                          オリジナルのままにしておくのが賢明である。ダテにあの
                          ルーチンを採用しているわけではないのであった。^^;)
May. 5,2001             ・1.55.3.24 の修正の結果メモリーリークを起こす可能性が
                          あった不具合を修正した。
                         (1.55.4.30; 正式版 UP)
May. 5,2001  Ver 1.55e  ・UNLHA.DLL Ver 0.22 で行った， 圧縮時のファイル書き出
                          しのオーバヘッド軽減措置と同様の処理を，展開時の読み
                          込みの際にも行うようにした。が，元々自前の入出力ルー
                          チン (Mygetc，etc...) は 64KB のバッファをもっている
                          し，API は当然ながらシーケンシャル用のバッファを使っ
                          ているし，システムはふんだんにメモリーキャッシュを
                          行っているし…で，全く効果が見られない。(笑)
                          まぁ，1 バイトごとに getc() するよりは，何がしかのサ
                          イズごとに fread() するほうがマシじゃろう…。(^^;;
                        ・表面化していなかったのじゃが，Myfread() のバグフィク
                          ス。(T_T) 1.55.5.1 で初めて表面化。(^^;;
                        ・AR950528 用の NTP 定義としてしまったために，lh1 形式
                          の展開で一般保護エラーを起こすようになってしまってい
                          たバグを修正した。むぅ〜，そのための 0x80 であったの
                          か。(^^;;
May. 6,2001              (1.55.5.33; 正式版 UP)
May. 7,2001  Ver 1.55f  ・とりあえず 1.55.5.31 用のバッファを 32KB に拡張。が，
                          DynaBook A1/570PMC だと， 3.5MB のファイルで 50ms し
                          か差がない。(笑)  圧縮で平均 2050ms が 2000ms になっ
                          ただけぇ。(^^;; ちなみに，ファイルがキャッシュされて
                          いない 1 回目は 2100ms 超ってとこ。 あ，もともとのサ
                          イズは 8KB でし。ちなみに^2，MK3017GAP の HDD 内部の
                          バッファ吐き出しが入ると，これが一気に 2300ms くらい
                          になる。こっちのほうがよっぽど深刻。(爆)  たぶん非力
                          な (というか，実害が出ていた) DynaBook 4050X  辺りだ
                          と 3400ms くらいになるのではないかと…。(T_T)
                          今は DJSA-220 にしちゃってるから確かめられないけど。
May. 8,2001             ・"-jx" スイッチを含むファイル指定でのパス連結関係のバ
                          グフィクス。
May.27,2001             ・GetExistDirectory() のバグフィクス。
                         (1.55.6.36; 正式版 UP)
Jun. 1,2001  Ver 1.56   ・4GB の壁を取っ払うべく，API を使用していた部分につい
                          ても自前のルーチンを使用するようにした。そのおかげで
                          というか， MyWriteFile() とかの擬似 API が増殖。(笑)
Jun. 3,2001             ・Myfseek() のバグフィクス。何を思ってか SEEK_END のと
                          きだけ lToMove の正負が逆になっていた。(^^;;
                        ・MYFILE.C のコードの整理。
Jun. 4,2001             ・ファイルハンドルについてもリークチェックを行うように
                          した。
Jun. 6,2001             ・1.56.0.1 の変更で， ディレクトリーに対してファイルと
                          同じ扱いをしてしまっていたバグを修正した。
                        ・Myfread()/Myfwrite() が API 的になっていたものを，無
                          難に標準ランタイム的なものに改善した。 返却値が n で
                          なく n * size ってのは，罠となりかねないし…。(笑)
                        ・1.56.0.3 辺りから展開時等の更新時間設定が利かなく
                          なっていたものを修正。そりゃ，設定した後にフラッシュ
                          すればねぇ…。(^^;) でも，そうしないとウィルスバス
                          ター等のせいでタイムスタンプ設定が無効になっていたの
                          よね…。今回のでまた表面化しないかしらん？ 2000 で改
                          善されたはずだから，大丈夫…と思いたい。(笑)
Jun. 7,2001             ・当然の帰着として， MyCreateFile() 系がルーチンの主体
                          となるように MYFILE.C を変更。
Jun.14,2001             ・楽ちんモードでファイル周りの 64 ビット化を行うべく，
                          64 ビット整数については  LONGLONG を使用するように変
                          更した。BC++ では FPU 命令が使われてしまうが，すでに
                          コンパイラーを変更しているので影響なし…というこ
                          とで，無視。(笑)
Jun.17,2001  Ver 1.56a  ・API との絡みもあるので，ヘッダを含めて格納ファイルに
                          ついては置いておいて，ファイル関係の処理を 64 ビット
                          化。とりあえず以前は (当然ながら) エラーが返っていた
                          2.5GB の書庫の作成は行えている模様。
                          一部の構造体等に影響している可能性があるので，要βテ
                          スト。変更箇所が多岐にわたるので，改版扱い。
                          ここへ至って， BC++ ではコンパイルすらできなくなって
                          しまった…。 LONGLONG を倍精度実数扱いする BC++ が悪
                          いのじゃ。(^^;;
Jun.18,2001             ・DWORD 単位の MySetFilePointer() だと煩わしいので，直
                          接 LONGLONG でやりとりを行う  MySetFilePointer2() を
                          使用するように改善。
                        ・LONGLONG でサイズを返す  UnlhaGetOriginalSizeEx() 等
                          の API を追加。
Jun.20,2001             ・BC++ 5.01J を見捨てた代りに C++Builder 5.0J でコンパ
                          イルするようにした。 って，C++B では VC++ 用のソース
                          がそのまま通ってしまうわけじゃが。(笑) ＞除く #pragma
                          C++B を逆輸入した  BC++ 5.5 でコンパイルできるのかど
                          うかは不明。 もっとも，今さら mak ファイルを最初から
                          起こす気にもなれないし， 不具合ネタのつきない 5.5 を
                          使う気もないが…。(^^;;
                          なお，本体のコンパイルを行わなくなったというだけで，
                          当然ながら WinSFX(M)  については BC++ 5.01J が引き続
                          き使用される。
Jun.21,2001             ・UnlhaGetOriginalSizeEx() 等について  64 ビット値では
                          なく， LONGLONG へのポインタで受渡を行うように変更。
                          とはいうものの，BC++ では『LONGLONG＝double』なので，
                          ヘッダ上では ULHA_INT64 という独自型での宣言にしてお
                          きますです。＞某氏
                          BC++ 以外の VC++ や C++Builder 等では LONGLONG (又は
                          それぞれでの __int64) なので， アプリ側では LONGLONG
                          のままぶん回しても構わないのではないかと…。(笑)
Jun.24,2001  Ver 1.60   ・UnlhaSetOwnerWindowEx64()，UnlhaSetEnumMembersProc64
                          ()等の API を追加。これに伴い Ver 1.60 に変更。
                         (1.60.0.15; HP β版 UP)
Jul. 3,2001  Ver 1.60a  ・カーソル表示の改善。
Jul. 5,2001             ・レター付きのカレントディレクトリー指定の場合に正常に
                          ディレクトリー作成できなかったバグを修正した。
Jul. 7,2001              (1.60.1.17; HP β版 UP)
Jul.13,2001  Ver 1.60b  ・IsCanUseLongFileName() について， 確実に情報が得られ
                          た場合のみ FALSE  を返すようにした (使用可能にもかか
                          わらず API がエラーとなる場合，アプリ側にとっては却っ
                          て不都合となることが多いため)。
                         (1.60.2.18; 正式版公開)
Jul.17,2001  Ver 1.61   ・GetVolumeInformation()  時のバッファサイズが昔ながら
                          の小さい値だったものを修正。そういえばすっかり忘れて
                          いました。(^^;;
Aug. 9,2001             ・少し手入れ。
Aug.10,2001             ・ログ関係が全滅していた大バグを修正。リリース版の #if
                          記述ミス。(^^;;
Aug.15,2001             ・CopySfx() での余計なコードを削除。と，ドキュメントの
                          "-i" スイッチの記述ミスの修正。 ついでにファイルサイ
                          ズのチェックを付加。
                        ・ファイルサイズ拡張ヘッダが正常に書き込めていなかった
                          バグを修正した。
                         (1.61.0.5; 正式版公開)
Aug.18,2001  Ver 1.61a  ・Ver 1.60 以降 "-n1" を指定した場合に一般保護エラーと
                          なってしまうことがあったバグを修正した。
Aug.20,2001              (1.61.1.6; 正式版公開)
Aug.21,2001  Ver 1.61b  ・"-d" を指定した場合に，必ず "-p" が有効となってしまっ
                          ていたバグを修正した。
Aug.22,2001             ・WinSFX32(M) の修正 (ディレクトリー参照ダイアログへの
                          初期値の継承)。
Aug.26,2001              (1.61.2.8; HP β版 UP)
Sep.13,2001  Ver 1.61c  ・"-gm" を指定しても特殊属性上書き確認が行われてしまっ
                          ていたバグを修正した。
Oct. 5,2001  Ver 1.62   ・'v' 命令を使用した場合に一般保護エラーとなってしまう
                          ことがあったバグを修正した。ついでに，一部のバッファ
                          に関して保険をかけておいた。(笑)
Oct. 7,2001              (1.62.0.1; 正式版公開)
Nov.11,2001  Ver 1.62a  ・'v' 命令によるファイル名出力について，FNAME_MAX32 に
                          よる制限を設けた。 FNAME_MAX32 決め打ちによる 'v' 命
                          令出力からのファイル名取得を行うアプリ対策。
Nov.12,2001              (1.62.1.2; 正式版公開)
Nov.12,2001  Ver 1.62b  ・WinSFX32(M) の 2100 年問題のバグ修正。(T_T)
                        ・Win32s 環境の場合に， WinSFX32M によるアイコン登録が
                          重複するバグを修正した。
Nov.14,2001              (1.62.2.4; 正式版公開)
Nov.25,2001  Ver 1.62c  ・Win32s  の一部の環境においてアイコンが登録されない場
                          合があったので，WinSFX32M の仕様を元に戻した。(T_T)
                          場合分けは可能だが，そのために 8K も肥大化したのでは
                          話にならないので。
                         (1.62.3.5; 正式版公開)
Nov.27,2001  Ver 1.63   ・状況表示ダイアログのクローズ時に親ウィンドウが後ろに
                          回ってしまっていたバグを修正。…とは言うものの，後ろ
                          に回ってしまう環境が存在するはず…Win95 以降では。
Nov.29,2001  Ver 1.63   ・Win32SFX(M) をちこっと修正 (というほどのものではない
                          ので SFX の版はそのまま)。
                         (1.63.0.1; 正式版公開)
Dec. 5,2001  Ver 1.63a  ・ヘッダ読み込み時のエラーチェックを少し強化。
Dec. 6,2001  Ver 1.64   ・メッセージボックス表示時に規定のサウンドを流す "-jsm"
                          スイッチを追加。バージョンチェックを考慮して 1.64 に
                          変更。
Dec.10,2001             ・ChangeMacChar() でのフィルタ文字を追加。
Dec.13,2001             ・入れ子の書庫に対応するため，書庫の後ろの余剰データを
                          許さない仕様に変更した。
Dec.14,2001  Ver 1.70   ・UnlhaOpenArchive() のフラグが破綻しているので， 逃げ
                          道として UnlhaOpenArchive2() を追加。 フラグの代わり
                          に  Unlha() 系と同じスイッチ指定を使うもの。
                          これに伴い 1.70 に改版。
Dec.15,2001              (1.70.0.4; HP β版 UP)
Dec.18,2001  Ver 1.70a  ・LHA オリジナルの配付書庫を含めて，書庫の後ろに固有情
                          報を付加しているものが多く存在しているので，簡易的な
                          他書庫のチェックをした上で余剰データの判断を行うよう
                          にした。
Dec.19,2001             ・↑に関連して，ヘッダ関係について，より詳しいエラー情
                          報を返すように改善した。
Dec.20,2001             ・↑について，エンドマーク系についてはエラーとしないよ
                          うにした。
                        ・ダイアログ関係にサウンドを付加していなかったバグを修
                          正した。すっかり忘れてました。(笑)
                         (1.70.1.8; HP β版 UP)
Dec.22,2001  Ver 1.70b  ・UnlhaQueryFunctionList() に ISARC_OPEN_ARCHIVE2 を追
                          加し忘れていたバグを修正。
Dec.23,2001              (1.70.2.9; 正式版公開)
Jan.23,2002  Ver 1.80   ・書庫を読み込んだサイズを返す   UnlhaGetArcReadSize()
                          及び 〜Ex() API を追加。はっきり言って LHMelt 用。
Jan.24,2002             ・WinSFX32M について， 限定的に '"' の文字が使えるよう
                          にした。
                         (1.80.0.2; HP β版 UP)
Jan.25,2002  Ver 1.80a  ・コンパイラーを VC++ 6.0SP5 に変更。ぐぅ〜。20KB 以上
                          も肥大化するとは…。(T_T)
Jan.26,2002             ・OpenArchive() 系 API について，UnlhaGetArcFileSize()
                          等が UnlhaFindFirst/Next()  でのサーチ中以外でエラー
                          を返してしまっていたバグを修正した。
                         (1.80.1.4; HP β版 UP)
Jan.26,2002  Ver 1.80b  ・拡張子が LZH 系以外の場合のみ 10MB  までチェックを行
                          うように改善した。今のままでは 10MB 以下の書庫につい
                          ては簡易モードが無効なので…。(^^;;
Jan.27,2002             ・作業ファイル削除のタイミング変更。ただし，最悪の場合
                          同一パーティション上に，LHTMP001.LZH (元の書庫を変名
                          したもの)，LHTMP002.LZH (操作した書庫)， ARCHIVE.LZH
                          (書き戻した書庫) の 3 つ分， 要は単純計算で 3 倍の空
                          き容量が必要になる。 GB 単位クラスの書庫を操作した場
                          合には空きが足りなくなるかもね…。元々こちらの仕様が
                          安全性の上では望ましいものなので，話に出たのを機会に
                          こっちにしてみた。
                          作業ファイルと操作する書庫が別のパーティションである
                          場合， 確実に約 2 倍 (元の書庫と操作後の書庫) の容量
                          を必要とする。 これまでは，書き戻しに失敗しても  LH-
                          TMP002.LZH は残るということで，LHTMP001.LZH を元の名
                          前に戻した上で上書きする仕様だった。
                          さらなる安全性を採るか，空き容量の実情を採るか (結構
                          空き容量が足りないことによる質問メールが多い)， 悩ま
                          しいところである。(笑)
Jan.28,2002             ・↑について，スイッチで選択できるようにした。 "-jsa1"
                          でコピー後削除となる。初期値は "-jsa0"。 また，FD 上
                          の書庫を操作した場合は， 無条件で "-jsa0" 相当の処理
                          となる。
Jan.29,2002             ・Win32s  の場合には FILE_END での SetFilePointer() を
                          使用しないようにした。 INVALID_FUNCTION でこけてしま
                          うので。(^^;)
                        ・Win32s について， MyFileTimeToLocalFileTime() が正常
                          な値を返さないことがあったバグを修正した。
Jan.31,2002             ・VC++ 6.0 を使っての  Win32s 適用可能なモジュール作成
                          に敗北し続けているので(笑)，とりあえず VC++5.0SP3 に
                          戻した。
Feb. 3,2002              (1.80.2.10; 正式版公開)
Mar. 9,2002  Ver 1.80c  ・格納ファイルのサイズが 2GB〜4GB の場合に，最適化の関
                          係で負数扱いとなってしまうことがあったバグを修正。
                         (1.80.3.11; 正式版公開)
Mar. 9,2002  Ver 1.81   ・LHMelt での現象確認に伴い， プラットフォームに関係な
                          く MyFileTimeToDosDateTime() を使用するように変更。
Mar.10,2002             ・格納時のファイル名決定について，指定されたものではな
                          くロングファイル名を使用するように仕様変更した。
                         (1.81.0.2; HP β版 UP)
Mar.13,2002  Ver 1.81a  ・access() を自前の関数に変更。
Mar.16,2002             ・ヘッダ読み込み時のチェック強化。特にオリジナル以来の
                          『負数位置へのファイルポインタ移動』の結果を利用して
                          のエラーチェック (そりゃ，エラーになります) というの
                          がとっても気持ち悪かったので…。(^^;;
Mar.17,2002              (1.81.1.4; 正式版公開)
Mar.18,2002  Ver 1.81b  ・エラーチェックの強化しすぎで 1.81 以降 h1 形式書庫が
                          読めなくなってしまっていた大バグを修正。
                         (1.81.2.5; 正式版公開)
Mar.20,2002  Ver 1.81c  ・コンパイル結果の影響で   MyFileTimeToLocalFileTime()
                          が期待どおりの動作をしなくなっていたバグを修正した。
                          レジストリーの追跡結果か何かの影響なの？ VC++ 5.0
                          SP1 on ME のときに大丈夫だったのは確かなので，SP3 に
                          変えたからなのか XP に変えたからなのか…。(^^;;
                         (1.81.3.6; 正式版公開)
Mar.21,2002  Ver 1.82   ・WinSFX32M の更新。
Mar.24,2002              (1.82.0.1; 正式版公開)
Mar.26,2002  Ver 1.82a  ・ドキュメントの変更(メールアカウント)。
                         (1.82.1.1; 正式版公開)
Apr.14,2002  Ver 1.83   ・4GB を超えるファイルの格納・展開が正常に行えなくなっ
                          てしまっていたバグを修正。
                         (1.83.0.1; HP β版 UP)
Apr.18,2002  Ver 1.83a  ・使えるはずが不具合のでる環境が存在したため使用を見合
                          わせていたが，時代の流れには逆らえず，空き容量取得に
                          ついて GetDiskFreeSpaceEx() を使うように改善した。
Apr.20,2002             ・WinSFX32M の更新。4GB の壁を取り払ったつもりではある
                          が，要テスト。
                         (1.83.1.3; HP β版 UP)
Apr.21,2002  Ver 1.83b  ・WinSFX32M の更新(ダイアログ表示の改善)。ただし，肥大
                          化は甚大。(^^;;
                        ・オーナーウィンドウ処理のバグフィクス。
Apr.28,2002              (1.83.2.5; 正式版公開)
May. 1,2002  Ver 1.83c  ・Ver 1.83a 以降， 一部の NT4.0 環境で一般保護エラーと
                          なっていたバグを修正。
May. 2,2002              (1.83.3.6; 正式版公開)
May. 8,2002  Ver 1.84   ・UnlhaFindFirst() について， 空白を含んだファイル名を
                          扱えないことがあったバグを修正。
                         (1.84.0.1; HP β版 UP)
May.22,2002  Ver 1.84a  ・Win98〜WinME  で一般保護エラーとなることがあったバグ
                          を修正。…というか，API のバグなんだけど…。Win95OSR
                          と NT 系では SDK どおりなのに， Win98 以降で勝手に仕
                          様が変わっているという，MS お得意の仕様バグパターン。
                          (笑)
                          おまけに『常に』でない点で凶悪度を上げてある。(^^;;
May.24,2002             ・WinSFX32M の更新。(SHBrowseForFolder() 適用)
                         (1.84.1.3; 正式版公開)
May.26,2002  Ver 1.84b  ・Ver 1.81c 以降テスト用のコードが入ってしまっていたバ
                          グを修正。
May.27,2002              (1.84.2.4; 正式版公開)
May.28,2002  Ver 1.85   ・ログファイルを使用している場合に，エラーが発生すると
                          ログファイルのハンドル解放がされなかったバグを修正。
                         (1.85.0.1; HP β版 UP)
May.31,2002  Ver 1.85a  ・Ver 1.84  の変更で反対に問題が生じるアプリが結構存在
                          するようなので，仕様を元に戻した。
Jun. 1,2002              (1.85.1.2; 正式版公開)
Jun.10,2002  Ver 1.85b  ・自己解凍書庫作成時の上書き確認で『中止』を選択すると
                          一般保護エラーになってしまっていたバグを修正。
Jun.17,2002  Ver 1.86   ・指定したファイルのみを扱う "-jtc" スイッチを追加。
Jun.18,2002             ・WinSFX32M の更新。(NT3.51/Win32s  アイコン登録バグ修
                          正)
                         (1.86.0.2; 正式版公開)
Jul.21,2002  Ver 1.86a  ・1.86  以降デバッグモード時に落ちてしまうようになって
                          いたバグを修正。 なんで，こんなところに 2 次元配列の
                          FAQ ミスが…本人以外絶対再現しないからよかったけど。
                          (笑)
                        ・"x dir/" といった相対ディレクトリー指定のみの場合に，
                          絶対ディレクトリー情報をもつメンバーを正常に展開でき
                          なくなっていたバグを修正。
                         (1.86.1.4; 正式版公開)
Jul.24,2002  Ver 1.86b  ・Ver 1.63 以降  UNLHA32.DLL で処理を行った後に，WinFD
                          のフォーカスが混乱してしまっていた不具合を改善した。
                          が， Ver 1.63 で不具合を解消したソフトの面々で問題が
                          再発する恐れあり。(^^;)
Jul.25,2002              (1.86.2.5; HP β版 UP)
Jul.30,2002  Ver 1.86c  ・WinSFX32M の更新。 (パス付きメンバーグループ登録バグ
                          修正)
Sep.23,2002              (1.86.3.6; 正式版公開)
Oct.17,2002  Ver 1.86d  ・UnlhaConfigDialog() について，取り消し終了したにもか
                          かわらず TRUE が返されることがあったバグを修正。
Nov.13,2002             ・WinSFX32M の更新。 (タイムスタンプの書き込みタイミン
                          グの調整)
Nov.17,2002              (1.86.4.8; HP β版 UP)
Jan.21,2003  Ver 1.87   ・travel() 終了時に FindFirst() のハンドルを解放し忘れ
                          ていたバグを修正。なお，API 終了時のデストラクタが解
                          放を行うので，リークは発生しない。
                        ・'m' 命令において，書庫の書き戻しに失敗したにも関わら
                          ずファイルが削除されてしまっていたバグを修正した。
                         (1.87.0.1; 正式版公開)
Feb.17,2003  Ver 1.87a  ・状況表示ダイアログの子ウィンドウ位置を改善した。
Feb.20,2003             ・↑の表示微調整。
Jul.20,2003  Ver 1.87b  ・SFX の各種パラメータを設定する "-gy" スイッチを追加。
Nov.16,2003  Ver 1.88   ・ファイルのオープン時に FILE_FLAG_BACKUP_SEMANTICS を
                          付加する "-jtb" スイッチを追加。ただし，現状ではディ
                          レクトリにアクセス権がないと，  ハンドルを経由しない
                          API 群でアクセス・エラーになってしまう。
Nov.26,2003             ・↑に少しでも抵抗すべく，"-jtb" 時には MyGetFileAttri-
                          butes() を呼び出すように変更。ファイルを開き GetFile-
                          InformationByHandle() しているだけぇ〜。(笑)
                          ちなみに，対象がネットワーク上だと，ディレクトリーに
                          アクセス権がなくても，あっさりと API が通る。 仕様な
                          のかバグなのか解らん挙動じゃ。(^^;;
Nov.27,2003             ・ShareCheck()  について， MyFindfirst()  で検索されな
                          かった場合にもエラーとしていたものを，共有不可扱いと
                          するように変更した。ワイルドカード指定した中に  Uni-
                          code  名のファイルが含まれていた場合にエラーとなって
                          いた問題への対策。
                          しかし…。CreateFile() 等主要 API で扱えないにもかか
                          わらず Findfirst()  等でリストアップされるというのも
                          困りものである。リストアップしたい気持ちは解るが…。
                          ＞Unicode 名
                          なお， UNLHA32.DLL での Unicode 名の取り扱いについて
                          は，書庫を Unicode 対応にした上で Unicode 版モジュー
                          ルを使わない限り意味がなく，中途半端に文字変換された
                          りされても却って困るだけ。さらにアプリ側の対応も必要
                          だから，DLL だけ対応しても無意味……というご意見多数
                          により遠い昔に却下済み。(^^;;
Dec. 2,2003              (1.88.0.3; 正式版公開)
Dec.16,2003  Ver 1.88a  ・LHA OS/2 及び  LHa for UNIX のパーミッション項目等の
                          パーミッション情報を参照して，ディレクトリーとリード
                          オンリー属性を設定するように改善した。
                        ・デバッグ情報を出力させようとした場合に一般保護エラー
                          になってしまっていたバグを修正した。そう言えば，この
                          辺のことを忘れてコードを弄ったような…。(^^;;
Dec.17,2003             ・ARJ と ZIP 書庫に対する入れ子判断のチェック強化。
Dec.19,2003             ・WinSFX32(M) について， 展開先の初期表示が '"' で括ら
                          れていないために，そのままでは展開できないことがあっ
                          たバグを修正した。
                        ・新属性ヘッダに属性から変換したパーミッションを書き込
                          むようにした。
                        ・共通ヘッダに付加情報を書き込むようにし， 30 分ずれ等
                          の特殊タイムゾーン地域の場合には，識別子 0x43 のタイ
                          ムゾーンヘッダを書き込むようにした。
Dec.20,2003              (1.88.1.9; 正式版公開)
Dec.28,2003  Ver 1.88b  ・WinSFX32(M) について， デスクトップの "%Desktop%" と
                          マイドキュメントの "%Documents%" を追加した。
                        ・一部の特殊変数が正常に機能していなかったバグを修正し
                          た ("%ProgramFiles%" 等)。
                        ・UnlhaOpenArchive()，UnlhaFindFirst()，UnlhaFindNext()
                          についてもレジストリー設定の InitOption と Cause-
                          Option が機能するようにした。
Dec.31.2003              (1.88.2.12; 正式版公開)
Jan. 6,2004  Ver 1.88c  ・UnlhaConfigDialog() でのダイアログ終了後処理の微修正。
Jan.11,2004             ・UNLHA_ENUM_MEMBER_INFO64 構造体等について， 追加格納
                          時に uCommand に正常な値が格納されなかったバグを修正
                          した。
                        ・UNLHA_ENUM_MEMBER_INFO64 構造体等について，  szFile-
                          Name  で指定したメンバー名が正常に機能していなかった
                          バグを修正した (パス名は機能するが，ファイル名が実際
                          に格納するファイルのものになってしまう)。
Mar. 4,2004  Ver 1.88d  ・WinSFX32M について，ファイルの削除を行う "$DelFile="
                          を追加。
May.31,1004              (1.88.4.16; 正式版公開)
Jun. 6,2004  Ver 1.88e  ・ヒープ及びファイルリスト管理用のハッシュエントリ数の
                          拡大を行った。効果は微々たるものだが，少しエントリ数
                          が少なすぎる気がしたので。
Jun. 7,2004             ・1.2MB FD  対策を施した上でファイルバッファの初期値を
                          256KB に拡張。対策が必要である以上，最終的に 64KB 単
                          位で書き込むことに変わりはないので，効果は関数呼び出
                          しのオーバーヘッド分くらいしかない。
Jun. 9,2004             ・get_next() を encode() 内に展開。 サイズ的には不利だ
                          が，さすがに回数を考えると，呼び出しのオーバーヘッド
                          すら馬鹿にならないので…。…とは言うものの，GHz クラ
                          スの MPU ともなると…。(^^;;  とりあえず様子見。
                        ・match_insert() 内のせこいコードを止めて， 基本的にオ
                          リジナルのものへ戻した。
Jun.11,2004             ・encode() 内に展開していた  get_next() を関数呼び出し
                          の形に戻した。オーバーヘッドについては『一応大きいと
                          言えそう』であるが，それでも 100MB 程度で 1 秒と違わ
                          ないようでは…。(^^;;
                        ・↑とも絡むが，結局最大の要因は状況表示…ということで
                          状況表示ダイアログの更新 (のみ) を秒間 30 フレーム程
                          度で行うように変更した。メッセージループやコールバッ
                          ク，メッセージ送出のタイミングは従来どおり。
Jun.12,2004  Ver 1.89   ・ファイル周りの変更等が環境によっては影響が大きいと考
                          えられるので，版を 1.89.0.6 に改めた。
                        ・WinSFX32(M) について， $Language= が指定された際にも
                          表記を切り替えるようにした。  現在のところは， LANG_
                          JAPANESE が指定されたときには日本語表記に， それ以外
                          の時には英語表記に切り替えるのみ。
                         (1.89.0.7; 正式版公開)
Jun.20,2004  Ver 1.90   ・スロバキア語対策の要望メールを機会に，大多数の文字列
                          についてストリングテーブルを使用するように変更した。
                          対応リソースは "LANG_JAPANESE, SUBLANG_DEFAULT" 及び
                          "LANG_ENGLISH, SUBLANG_ENGLISH_US" のみ。 リソースの
                          ロードに失敗した場合は， 従来の文字列 (日本語・英語)
                          を使用する。
                          う〜ん。ストリングテーブルだけで 13KB の肥大化かぁ。
                          予想以上に文字列でサイズを食ってる。(^^;;
                        ・↑に伴い，リソースが追加された場合を想定して，指定し
                          た言語のリソースに切り替える SetLangueSpecified() を
                          追加した。
                         (1.90.0.2; β版公開)
Jun.24,2004  Ver 1.90a  ・作業ファイルを  GetTempFileName() API を使用して作成
                          するように変更した。これで競合の問題が軽減されるのか
                          は謎である。過去の版との互換性が懸案事項。もっとも，
                          過去 (LHA 時代) にも仕様変更が行われていて，そもそも
                          本来残るはずのない作業ファイルについて前提条件をつけ
                          ても…ということで，気にしないことにする。(笑)
                          ただ，GetTempFileName() がファイルを一旦作成して閉じ
                          た直後に，実際の作業用ファイルとして再度開くことにな
                          る関係上，以前の報告例からすると，監視ソフト絡みの共
                          有エラーが発生する可能性あり。
Jun.26,2004             ・"-gm1" を指定した場合に "-ga" スイッチが効かなかった
                          バグを修正。 もしかして…当初の 1.61c での変更時から
                          既にそうだったのかしら？  確か当時は期待どおりに動作
                          していたはずなんだけど…。
                         (1.90.1.4; β版公開)
Jun.29,2004  Ver 1.90b  ・今更だが，状況表示でのパス名について省略記号 ("...")
                          を用いて，なるべくファイル名が表示されるように改善し
                          た。
Jul. 2,2004             ・とりあえず状況表示ダイアログのみリソースを一本化した。
                          正常にロードが可能かどうかのチェック用なので，ダイア
                          ログ及び項目サイズの調整については未着手。
Jul. 3,2004             ・1.90.2.6 での変更について， サイズ等の調整を行ってい
                          なかったのではなく，実は以前から調整済みで，バグで期
                          待どおりに調整が行われていないだけであった。(笑)
                          というわけで，修正。
                        ・レジストリーに登録されている場合は，リソースのストリ
                          ングテーブルを使わずに，優先して登録文字列を使用する
                          ようにした。ダイアログの一本化が終了していないので，
                          現時点では半分意味がない。テスト用。
                          HKEY_CURRENT_USER 上のものが HKEY_LOCAL_MACHINE に優
                          先して使用される。
Jul. 4,2004             ・引き続きローカル設定ダイアログの共通化を行った。行う
                          のは，いいとして，ダイアログ方面のストリングテーブル
                          化はコードの肥大化が甚だしいなぁ…。文字列を登録しな
                          きゃいけないは，サイズの調整をしなきゃいけないは…。
                         (1.90.2.9; β版公開)
Jul. 5,2004  Ver 1.90c  ・VC++ 5.0 の罠にはまり，日本語環境で SFX 設定ダイアロ
                          グが表示できなくなっていたバグを修正した。勝手に
                          DIALOGEX にリソースを変更しないでほしいなぁ…。 名前
                          も勝手に『全部大文字』にするしぃ〜。って，5.0 を使っ
                          ているからだが， Win32s + Win95 のしがらみから解放さ
                          れない限り 5.0 を使い続けるしか…。(T_T)
                         (1.90.3.10; β版公開)
Jul. 5,2004  Ver 1.90d  ・上書き確認及びファイル名変更ダイアログの共通化を行っ
                          た。ローカル設定ダイアログも同様だが，比較的レイアウ
                          トに余裕があることから，これらでは今のところサイズ調
                          整を行っていない。
                        ・1.88.5.18 の変更について，FileOpenSub() 内の Create-
                          File()  でエラーとなった場合 (開けるかどうかでチェッ
                          クを行った場合などを含む) にバッファを解放し忘れてい
                          た大バグを修正した。 例のごとく (UNLHA32.DLL の) API
                          終了時にデストラクタが解放を行うので，レジストリー設
                          定でメモリーリーク申告を有効にしない限り表面化し
                          ない。
Jul.10,2004             ・ディレクトリー作成確認ダイアログの共通化を行い，
                          リソースを上書き確認ダイアログと統合した。
Jul.11,2004             ・残りのダイアログについても共通化。↑を含めて相変わら
                          ずサイズ調整は行っていない。(^^;)
                         (1.90.4.14; β版公開)
Jul.16,2004  Ver 1.90e  ・一部のダイアログについてラジオボタン等のサイズを調整。
Jul.18,2004             ・1.90.4.14 以降で，リードオンリー上書き確認関係の修正
                          を忘れていたために，文字列が全く設定されていなかった
                          大バグを修正した。
                        ・残りのダイアログについてもラジオボタン等のサイズを調
                          整。
                         (1.90.5.17; β版公開)
Jul.19,2004  Ver 1.90f  ・1.90.5.15 以降で， 環境によっては WinXP 以外でコント
                          ロールの右端が切れてしまっていたバグを修正した。
                        ・すぅ〜っかり忘れていたのだが，GetTextExtentPoint32()
                          を使うように修正した。 ただし，Win32s では却って不具
                          合が生じるので，引き続き GetTextExtentPoint() を使用
                          している。
                         (1.90.6.19; β版公開)
Jul.20,2004  Ver 1.90g  ・1.90.5.16 以降で，一部のダイアログのタイトルがおかし
                          くなってしまっていたバグを修正した。
                         (1.90.7.20; β版公開)
Jul.26,2004  Ver 1.90h  ・1.90.4.11 以降で，特殊属性上書き確認ダイアログのタイ
                          トルが設定されていなかった (通常確認のタイトルのまま
                          だった) バグを修正した。
Jul.28,2004             ・一部のエラーについて返却エラーコードの見直しを行った
                          (ただし， アプリ側を含めて動作に影響を及ぼさない箇所
                          に限定)。
Jul.29,2004             ・引き続き返却エラーコードを一部変更。
                        ・某所に載っている不正パス問題に対応。『セキュリティ
                          ホール  memo』辺りにもネタが上ったことが影響している
                          のか，これだけ問い合わせが増えてくると，やっぱり対応
                          しておいたほうがいいでしょう。
                          多くの方が勘違いしているようだが，UNLHA32.DLL は未対
                          応組である。LHA を含めて確かにサンプル書庫での展開は
                          行えないし，リスト表示さえされないが，それは件のサン
                          プルが不正な書庫であるからに過ぎない。
                          h2 形式のヘッダであるにもかかわらず， パス情報を  h0
                          形式で基本ヘッダに書き込んだ上， ヘッダの CRC すら調
                          整していないようでは，よほどチェックの甘いツールでな
                          い限り，扱えなくて当然である。しかも，最初のメンバー
                          が不正なので，大抵のツールでは当該メンバーの部分が
                          (書庫前部の) 余剰データと見なされてしまう。 そのため
                          リスト表示すらされないのである。
                          なお，『多くの DLL やアプリで』というのは， ある意味
                          当然で，これは Win32 の大多数の API が，そのように解
                          釈 (過剰な ".." を単に無視するだけ。別に強引に，どう
                          こうしているわけではない) した上で正常終了するのが原
                          因であり，根本的な解決は OS 側で行うしかない。
                          API が当てにならない以上，チェックするには自前でのパ
                          ス解読が必要となるが，これは多くの技術書等で避けるべ
                          き事項として記載されているものであり，別のバグを生み
                          やすい処理でもある。
                          さらに，UNLHA32.DLL (LHA) を含めて，多くのツールでは
                          絶対パスによる書庫への格納が可能であることから，この
                          問題に対応したところで全体としてはあまり意味がない。
                          (攻撃する側にしても)  素直に絶対パスで格納しておいた
                          ほうが，よほど簡単で確実である。
Jul.30,2004             ・不正パス警告を『メッセージボックス + (通常の) ファイ
                          ル名変更処理』としていたものを，上書き確認等と同様の
                          ダイアログを使用したものに変更した。 "-jyn" スイッチ
                          にかかわらず，変更ダイアログが呼び出される。これに伴
                          い "-jyb" スイッチを追加。
Jul.31,2004             ・恐ろしいことに， travel() でのパス名チェックが，いつ
                          の頃からか h2 用のものだけになってしまっていた大バグ
                          を修正した。
                         (1.90.8.26; 正式版公開)
Aug. 1,2004  Ver 1.90i  ・不正パス関連について，専用の ERROR_INVALID_PATH を返
                          すように仕様変更した。
                        ・Ver 1.90h で，書庫の新規作成でエラーとなった場合に，
                          本来正常終了すべき状況でも『作業ファイルコピー』のエ
                          ラーで終了してしまっていたバグを修正した。
                        ・圧縮時のスキップ表示の改善。
                        ・Ver 1.90h で上書き確認ダイアログが正常に動作しなくなっ
                          てしまっていたバグを修正した。
                        ・上記 3 つのエラーのお詫びというわけではないが， おま
                          けとして，一番影響が大きいと思われる展開時について，
                          『指定先以外の展開先へ展開が行われる脆弱性』と絶対パ
                          ス関係の問題に対応する "-jsp" スイッチを追加した。
                          あくまでも暫定的なものなので，展開時の，しかも格納
                          ファイルのパス情報についてのみのチェックである。
                          拙作 LHMelt のような直接アプリ側でスイッチ文字列の設
                          定を行える場合は，それを使っても良いし，API.TXT を参
                          照して UNLHA32.DLL のレジストリー設定を利用しても
                          良い。
                          スイッチの仕様は以下のとおり：

                                -jsp0 : BPL_NORMAL

                                        通常モード。従来の仕様と同じで，ルート
                                        を越えるパス指定のみ不正となる。

                                -jsp1 : BPL_DENY_TOO_MANY_PARENTS

                                        基準ディレクトリーモード。基準ディレク
                                        トリーを越えるパス指定を不正とみなす。
                                        このスイッチを指定した場合は，"-jf2"
                                        指定で格納されたメンバーについても不正
                                        扱いとなり，特殊変数が使用されたパスを
                                        もつメンバーも，その多くが不正となるの
                                        で注意が必要。

                                        当然ながら，絶対パスで格納された書庫を
                                        展開する際には，展開先としてルートディ
                                        レクトリしか指定できなくなるので，この
                                        点についても注意が必要。

                                -jsp2 : BPL_DENY_ABS_PATH

                                        絶対パス拒否モード。"-jsp1" でのチェッ
                                        クに加え，絶対パスで格納されたメンバー
                                        をすべて不正とみなす。ルート記号を取り
                                        除いて扱うわけではないので注意が必要。

                                -jsp3 : BPL_DENY_PARENTS

                                        親ディレクトリー拒否モード。"-jsp2" ま
                                        でのチェックに加え， ".." のパス指定が
                                        含まれるメンバーをすべて不正とみなす。
                                        たとえ基準ディレクトリーを越えていなく
                                        ても，不正となるので注意が必要。

                          このスイッチを使用した場合，性格上絶対パスを扱ってい
                          る可能性の高いバックアップ系のソフトが，高い確率で正
                          常に動作しなくなる恐れがあるので，十分な注意と覚悟の
                          上で使用するようにしてください。
                        ・"-jsp" スイッチについて，パス無しの場合と 't' 命令に
                          対応。
                         (1.90.9.32; 正式版公開)
Aug. 2,2004  Ver 1.91   ・"-jsp" スイッチの仕様をレベル指定ではなく， フラグの
                          組み合わせでの指定に変更した。詳細については COMMAND.
                          TXT を参照。
                        ・『UNLHA32 設定ダイアログ』に "-jsp" スイッチ関係の設
                          定項目を追加。
                        ・"-jsp" スイッチの規定値を "-jsp1" に変更。このため，
                          絶対パスを前提としている場合は，適切に基準ディレクト
                          リをルートに設定しないと展開が行えなくなることから，
                          既存のアプリに少なからぬ影響を与えると予想される。
                          安全性を考えると致し方ないところであろう。
                         (1.91.0.3; 正式版公開)
Aug. 3,2004  Ver 1.91a  ・『不正パス確認ダイアログ』が正常に機能しない場合があ
                          るバグを修正した (式の記述ミスでした。が，この手のも
                          のは VC++ が警告を出すはずなんだけど，なんで出さな
                          かったんだろう…。他の箇所では出しているのに…)。
                        ・ChangeFileNameSub() 内でカレントディレクトリーが変更
                          されてしまうバグを修正した (自宅と，職場のいつも使っ
                          ているマシンでは大丈夫なのだが，職場の一部のマシンで
                          は再現した)。う〜ん。 GetSaveFileName() 辺りの大物辺
                          りに対しての退避だけになっていたのが敗因か。そう言え
                          ば，確かに，切り出す前の ChangeFileName() は全体に対
                          して退避を掛けてあるなぁ。
                        ・基準ディレクトリーが省略 (及びカレントを表す "./")
                          された場合に不正パスチェックが正常に働いていなかった
                          バグを修正。
                          ごめんなさい，ごめんなさい，ごめんなさい。『展開先が
                          省略』のパターンをすっかり忘れていました。LHA の
                          main() 辺りでも，そうなっていますが，"./" の指定は，
                          "" (つまり省略) に読み替えられます。昔，実際のパスを
                          示す文字列に変換する処理を入れたつもりでいたけど，入
                          れていなかったのね…。
                        ・基準ディレクトリーに対するチェックをコマンド解釈時に
                          行うようにした。
                         (1.91.1.7; 正式版公開)
Aug. 5,2004  Ver 1.91b  ・相対パスで書庫を指定できなくなっていたバグを修正し
                          た。"-jsp1" を指定してあるなら，ある意味正しい動作な
                          のだろうが，"-jsp0" で使えないようではダメダメであろ
                          う。
                        ・EnumMembersProc 系 API  で展開先が変更された場合に，
                          まだ Ver 1.91 と同じ問題が残っていたバグを修正した。
Aug. 6,2004             ・"..." のような 3 つ以上 '.' の続く不正パスがチェック
                          をすり抜けてしまっていたバグを修正した。
                        ・BPL_DENY_ABS_PATH が指定されていない場合，絶対パスに
                          ついての以降の扱いを選択できるようにした。
                        ・1.91.2.8 の修正について，UnlhaOpenArchive() 等に適用
                          し忘れていたバグを修正した。
                        ・確認ダイアログ関係の細かな修正。
                         (1.91.2.13; β版公開)
Aug. 8,2004  Ver 1.91c  ・不正パスチェックをオフにしているにもかかわらず『絶対
                          パス警告』ダイアログが表示されてしまっていたバグを修
                          正した。
Aug. 9,2004              (1.91.3.14; β版公開)
Aug. 9,2004  Ver 1.91d  ・ChangeFileNameSub() で，初期ディレクトリーが正しく設
                          定されていなかったバグを修正した。
Aug.13,2004             ・ルートディレクトリーが基準となっているにもかかわらず，
                          『絶対パス警告』ダイアログが表示されてしまっていたバ
                          グを修正した。
                        ・サウンドが重複しないように， MyMessageBox() ではサウ
                          ンドを鳴らさないようにした。
                         (1.91.4.17; 正式版公開)
Aug.17,2004  Ver 1.91e  ・不正パスチェック関係にバッファオーバーフローを仕込ん
                          でしまった大バグを修正。
                        ・Myfindfirst() のパスチェックを改善。
Aug.18,2004              (1.91.5.19; 正式版公開)
Aug.20,2004  Ver 1.91f  ・lhd メンバーが含まれた書庫をテストした際に，一般保護
                          エラーの発生してしまうことがあったバグを修正。なんと，
                          4 年以上も前の 1.46 で仕込んでから，ずっと，そのまま
                          だったらしい…。(T_T)
                        ・展開時ログ出力の改善。
Aug.23,2004              (1.91.6.21; 正式版公開)
Aug.23,2004  Ver 1.91g  ・1.88a 以降，新属性ヘッダが正しく書き込めなくなってい
                          たバグを修正。
                         (1.91.7.22; 正式版公開)
Aug.26,2004  Ver 1.92   ・レスポンスファイルが開けなかった場合に，メモリーリー
                          クが発生していたバグを修正。API 終了時のチェックで自
                          動解放されるので，表面化はしない。
Sep.22,2004             ・UnlhaSetLangueSpecified() 等の API を追加。  "Unlha"
                          付きの名前も用意しただけで， SetLangueSpecified() を
                          呼び出しているだけ。
Sep.23,2004             ・実験的に UnlhaSetPriority() API と "-jtp" スイッチを
                          追加。むぅ〜。SetThreadPriority() API だと，他に負荷
                          が高めのものが存在しないと，違いが現れないなぁ。
Sep.25,2004             ・UnlhaSetPriority()  等が指定されていない場合には，既
                          存の版と同等の処理を行うように変更した。無指定の動作
                          が THREAD_PRIORITY_NORMAL を指定した場合と同じという
                          のは問題があるでしょう，やっぱり。
Sep.26,2004              (1.92.0.4; β版公開)
Oct. 7,2004  Ver 1.92a  ・h3 ヘッダの場合に ERROR_LONG_FILE_NAME が返されなかっ
                          たバグを修正。
                         (1.92.1.5; 正式版公開)
Oct.23,2004  Ver 1.93   ・UnlhaMain() 内でエラーが発生した場合に，メモリーリー
                          クが発生していたバグを修正。
                         (1.93.0.1; β版公開)
Nov. 3,2004  Ver 1.93a  ・VC++，BC++  以外のコンパイラーで報告される軽微な警告
                          に対する修正。
                         (1.93.1.2; 正式版公開)
Nov.15,2004  Ver 1.94   ・WinSFX32(M) について，ボリューム情報が正常に取得でき
                          ないことがあったバグを修正。
Nov.18,2004             ・作業書庫からの書き戻しが MoveFile() API で行われる場
                          合に，作業書庫のアクセス権が引き継がれてしまっていた
                          バグを修正。
                          これに伴って，新規書庫作成時には，直接作成先に書庫を
                          作成するよう改善した。
Nov.19,2004              (1.94.0.2; β版公開)
Nov.25,2004  Ver 1.94a  ・優先度設定が THREAD_PRIORITY_BELOW_NORMAL となってい
                          る場合のウェイトを下げることで， NORMAL，LOWEST 間と
                          の調整を図った。
                        ・ソースの微修正 (一部，直接数値指定されていたものをマ
                          クロ定義に改善)。
Nov.29,2004              (1.94.1.4; β版公開)
Dec. 5,2004  Ver 1.94b  ・正式版として公開 (1.94.2.4)。
Dec. 7,2004  Ver 1.94c  ・Ver 1.94 以降， 格納するファイルと同じディレクトリー
                          に新規書庫を作成しようとすると，新規書庫自体を格納し
                          ようとしてエラーとなってしまうことがあったバグを修正。
                         (1.94.3.5; 正式版公開)
Dec.13,2004  Ver 1.95   ・タイムスタンプ関係下請けルーチンの整理。
Dec.14,2004             ・圧縮を打ち切った後にヒープ解放のフラグを設定し損ねて
                          いたために，その後の操作時に『ヒープメモリーエラー』
                          が表示されていたバグを修正 (表示だけで二重解放やヒー
                          プの破壊は発生しない)。
Dec.17,2004             ・一部の関数を統合。
                        ・ディレクトリーの格納を行った場合に，
                          "UNLHA32/UNLHA32/"  といった重複した名前が生成されて
                          しまうことのあったバグを修正。
Dec.20,2004             ・新規書庫が作成された場合に，作業書庫が残ってしまうこ
                          とのあったバグを修正。
                         (1.95.0.5; β版公開)
Dec.20,2004  Ver 1.95a  ・圧縮・展開ルーチンでのファイルバッファを 64KB に拡張
                          した。
Dec.21,2004             ・一部のルーチンについて，オリジナルで行われている手動
                          最適化 (共通部分式のループ外への移動と，オフセット→
                          ポインタの直接加算) を本来の (ものと思われる) コード
                          に戻した。そのほうが速かったので。i386 や 486 辺りだ
                          と効果があったのかもしれないけど…。
                        ・一部のルーチンについて，速度優先でコンパイルされるよ
                          うにした (/Os →/Ot)。とは言うものの，周りの負荷に吸
                          収されてしまう程度の違いしかないのが…。ただ一つの関
                          数 (match_insert) だけは劇的に改善したけど…。
Dec.22,2004             ・引き続き↑の速度変化試験。"/Ot" のほうが遅くなるルー
                          チンのほうが多いのでは…という状況だったので，昨日の
                          適用状態 + α で打ち止めにした。
                          ついでに，一部のスイッチを変更 (/Oa，/Oi の指定。/Ow
                          の削除)。
                          もっと周りの影響を受けない環境でテストを行った上で，
                          さらに適用ルーチンを絞り込む必要がありそうなのだが，
                          それとは別に，ダイアログの負荷を半分でも下げる方法が
                          ないものかしら。書込サイズ表示の SetDlgItemText() と
                          (プログレスバーへの) SendMessage() だけで 10% ほど改
                          善されるんですけど…。
Dec.24,2004             ・結局， 一定の効果がある 2・3 の関数のみ "/Ot" を適用
                          するに止めた。あとは環境によっては『改悪』になりかね
                          ないので…。ほぼ 3 日前に戻った…ってこと？ (^^;;
                        ・メモリーリーク以外のデバッグ用出力ルーチンを含めない
                          ようにした。
                        ・Ver 1.95 以降， h2 形式書庫について，UNIX 形式でのタ
                          イムスタンプが正常に記録されない環境の発生していたバ
                          グを修正。 手元では再現できなかったのだが， FILETIME
                          からの変換が正常に行われていなかった模様。API を使用
                          しないことで回避 (幸い単純な四則演算で変換が可能)。
Dec.25,2004              (1.95.1.12; 正式版公開)
Dec.26,2004             ・AR.EXE の putbits() での展開コード，_fastcall 呼び出
                          し等を試してみたが，全くの無駄だったので元に戻した。
                          _fastcall なぞは却って遅くなりました。(笑)
Dec.28,2004  Ver 1.95b  ・進捗表示において， 処理開始を示す 0 表示が重複して行
                          われている箇所のあったバグを修正。
Dec.30,2004             ・負荷低減よりも処理速度を優先する向きが多かったので，
                          THREAD_PRIORITY_NORMAL 以上の優先度の場合は， バック
                          グラウンドモードが指定されている場合のみウェイトを入
                          れるようにした。
                         (1.95.2.14; 正式版公開)
Jan. 5,2005  Ver 1.96   ・圧縮時の進捗表示が  4GB 境界で行われてしまっていたバ
                          グを修正。
                        ・上書き確認ダイアログ等について，ファイル名に従って
                          ウィンドウサイズを変更するように改善した。
Jan. 6,2005             ・↑について，折り返し表示でも収まりきらない場合のみに
                          サイズを変更するようにした。
Jan. 7,2005             ・3 年半の間，特に要望がなかったので，うっちゃっておい
                          たのだが，ネタに上ったので，展開時等にファイルサイズ
                          のチェックを行うようにした。ちなみに，各ファイルシス
                          テムにおける (UNLHA32.DLL での) 制限は以下のとおり：

                                FAT                 : 2 GB 未満
                                FAT32 (Win9X)       : 2 GB 未満
                                FAT32 (Win2K 以降)  : 4 GB 未満
                                NTFS                : なし

Jan. 8,2005             ・ファイルサイズチェックルーチン等，一部のルーチンの整
                          理。
Jan. 9,2005              (1.96.0.5; β版公開)
Jan.12,2005  Ver 1.96a  ・一部の処理数カウントの改善。
Jan.14,2005             ・書庫操作を伴う命令で "-jw" 及び "-gw" スイッチが指定
                          された場合に，自己解凍書庫が作成されるように仕様変更
                          を行った。
Jan.15,2005             ・↑について， 's' 命令以外の場合の SFX 上書きに対応。
                        ・↑について，'s' 命令以外の場合に未更新メンバーに対す
                          るチェックをしていなかったバグを修正。
                         (1.96.1.9; β版公開)
Jan.18,2005  Ver 1.96b  ・レスポンスファイルからの読込時にバッファオーバーフ
                          ローしてしまうことのあったバグを修正。
                         (β版については，デバッグ用出力ルーチンを含めるように
                          した)
                        ・'a' 命令等での自己解凍書庫作成時に設定ダイアログを終
                          了させると，メモリーリークが発生してしまっていたバグ
                          を修正。
                         (1.96.2,11; β版公開)
Jan.27,2005  Ver 1.96c  ・Ver 1.95 以降において， "-jo" スイッチで指定されたタ
                          イムスタンプが正しく取得されていなかったバグを修正。
Jan.30,2005              (1.96.3,12; β版公開)
Jan.31,2005  Ver 1.96d  ・"-r2" スイッチを指定した場合に，格納ファイルに対する
                          "Dir" といった一階層のみのディレクトリー指定による検
                          索が正常に行われないことがあったバグを修正。
Feb. 1,2005             ・Ver 1.90i 以降において， 削除時の "-jn" スイッチ等が
                          正しく機能していなかったバグを修正。
Feb. 2,2005              (1.96.4,14; β版公開)
Feb.11,2005  Ver 1.96e  ・正式版用にコンパイル。修正はなし。
Feb.12,2005              (1.96.5.14; 正式版公開)
Mar. 6,2005  Ver 1.96f  ・"-gw" スイッチ付き書庫操作で改竄チェック付きの自己解
                          凍書庫を作成する際に  CRC の計算が行われていなかった
                          バグを修正。
                        ・"-jw" 及び "-gw"  スイッチを使用して自己解凍書庫を作
                          成した際に，書庫前の余剰データが書き込まれてしまって
                          いたバグを修正。
                         (1.96.6.16; 正式版公開)
Mar. 7,2005  Ver 1.97   ・ファイル入出力のバッファサイズを一旦変更した後，元に
                          戻した。(^^;;
Jun. 1,2005             ・Ver 1.96d 以降  "-jx" スイッチが正常に機能しないこと
                          のあったバグを修正。
Jun. 2,2005             ・Ver 1.93 以降，DELREG.EXE が Win32s 環境で実行できな
                          くなっていたバグを修正。
                         (1.97.0,3; β版公開)
Jun.17,2005  Ver 1.97a  ・追加圧縮時のファイル数カウント表示の改善。
Jun.18,2005              (1.97.1.4; 正式版公開)
Jun.20,2005  Ver 1.98   ・WinSFX32M について， $Class による関連付け登録の際に
                          指定されたキーを利用して既存キーの簡易的なバックアッ
                          プを採るようにした。
Jun.29,2005             ・WinSFX32/M の微修正を行った。
Jul. 1,2005              (1.98.0,2; β版公開)
Jul. 2,2005  Ver 1.98a  ・DOS 系以外で作成された書庫の場合に， 識別子  0x42 の
                          ファイルサイズヘッダを読み込んでしまっていたバグを修
                          正。
Jul. 5,2005             ・Ver 1.90 以降  "d:" といったドライブのみの指定が不正
                          パスとして扱われてしまっていたバグを修正。
Jul.10,2005              (1.98.1,4; β版公開)
Jul.23,2005  Ver 1.98b  ・正式版としてコンパイル
                         (1.98.2.4; 正式版公開)
Aug. 7,2005  Ver 1.99   ・メモリマップドファイル化に備えてファイル入出力ルーチ
                          ンの再構成を行った。
Aug. 8,2005             ・ファイル入出力に関してメモリマップドファイル化を行っ
                          た。 Win2K 以降の場合に使用し， 書き込み時については
                          ローカルの固定ディスクでのみ有効。高速化を計っている
                          わけではないことから，マップのサイズを数 MB 程度にし
                          てある。 大きく確保 (数 100 MB) しても速度に変わりが
                          なく，一時的なファイルサイズの増大によるデメリットの
                          ほうが大きかったので。
                          新たに入出力ルーチンを書き起こしていることから，取り
                          扱いには注意が必要。手元の環境では正常に動作している
                          ものの，どのような不具合が生ずるか判らないので，この
                          β版については，テスト用ファイルでの使用をお薦めしま
                          す。
                         (1.99.0.2; β版公開)
Aug.12,2005  Ver 1.99a  ・メモリマップドファイル化に伴う， "-jtp" スイッチ関係
                          のウェイト処理の変更・調整を行った。
                        ・無圧縮メンバーに対する格納後の CRC チェック ("-jsv")
                          の際に進捗が表示されていなかったバグを修正。
Aug.20,2005             ・圧縮・展開時の状況表示ダイアログでの描画更新タイミン
                          グの調整。
Aug.21,2005             ・fillbuf() 等のシフト演算の簡略化を行った。が，GHz ク
                          ラスの CPU が相手では，効果なし。 …というか，演算以
                          外による負荷が大きすぎ。(笑)
Aug.22,2005             ・無圧縮格納 (単純コピー) 時の状況表示ダイアログでの描
                          画更新タイミングの調整。
                        ・入出力ルーチンの微修正 (呼び出し時の無駄を省く等)。
Aug.23,2005             ・fillbuf() 等の微修正 (展開・テストによる分岐をループ
                          外で行うようにした。コードが倍になってしまう点は無視
                          している ^^;)。
Aug.24,2005             ・メモリマップドファイルの使用の有無をレジストリーで指
                          定できるようにした。ネット環境等を含めて今のところ不
                          具合の発生がなく，不具合報告もきていないことから，
                          初期値は有効にしてある。
Aug.25,2005             ・fillbuf() 等のポインタ計算量の減少を図った。が，気分
                          だけでしかないのだが，減らして悪いことはないはずなの
                          で…。
Aug.26,2005             ・描画更新タイミングの最小値を 50ms とした。 が，100ms
                          としても，元々の 33ms としても，下記書庫の展開を例に
                          すれば 0.5 秒の差も現れないので， 気分的なものでしか
                          ない。
                        ・一部の高頻度関数について最適化の設定を見直し。
                          ここまでで， 手元の環境 (DynaBook G5 の 1.2GHz 動作)
                          上で  117MB の書庫 (135MB の MPG) を展開した結果は以
                          下のとおり：

                                Ver 1.98b     ：30s
                                Ver 1.99a     ：20s
                                LHA32 Ver 2.67：16s
                                解凍レンジ    ：10s

                          それなりに速くなってはいるものの，アセンブラ組には及
                          ばず，解凍レンジに至ってはダブルスコア…。
                         (1.99.1.13; β版公開)
Aug.26,2005  Ver 1.99b  ・最適化の設定を /G6，__fastcall に変更。
                          最適化の設定は，少なくとも主要関数について見直す必要
                          があるようだ。 例えば，fillbuf()，getbits() の両関数
                          については  /Ot を基調とした設定となっているが，これ
                          を /O2 にすると，上記のファイルの例では 25s 掛かって
                          しまうようになる。最低でも，『遅くなっている』関数の
                          有無をチェックする必要があるだろう。
                          ちなみに， DynaBook G7 の 1.2GHz 動作でも 20s と全く
                          同じ結果が得られるのだが，本来の 1.9GHz 動作にすると
                          11s となる。遅い Pen4 ノートでさえ，これなので，昨今
                          のマシンでは誤差程度の差でしかなく，無駄な努力のよう
                          な気がしないでも…。
                          主要関数の呼び出し回数は以下のとおり (これらから回数
                          が予想できるものは除いてある)：

                                calccrc                       2,170
                                fillbuf                 124,197,522
                                getbits                   2,887,234
                                read_pt_len                  17,040
                                read_c_len                    8,520
                                decode_c_st1            119,248,528
                                decode_p_st1              2,630,445
                                make_table                   25,560

                          まずは，この辺りについて吟味かしら？
Aug.27,2005             ・上記の各関数について最適化設定を微調整した上で，対象
                          CPU を /G6 からブレンドに戻した。下手をすると /G6 の
                          ほうが遅かったので…。
                          一部の関数をアセンブラで書き直したりしてみたのだが，
                          下手にコードの減少を図るよりも命令順の差による影響の
                          ほうが遥かに大きかったので，C に戻した。＞fillbuf()
                          各分岐先で純粋に重複しているコードを削除，重複ロード
                          等の削除…といった通常なら速くなるはずのものが，相当
                          (4s) 遅くなってしまう…など， /O2 とかやると遅くなる
                          理由が分かったような気がする。(笑)  インラインアセン
                          ブラで書かれた部分についても適切に並べ替えを行ってく
                          れれば良いのに…。＞VC++ 5.0
Aug.29,2005             ・昨日も悪あがきをしていてダメだったのだが，それならば
                          と LHA Ver 2.11 のアセンブラルーチンを基にしてみたと
                          ころ，多少改善された。＞fillbuf()
Aug.30,2005             ・あまり効果は上がっていないが，マイナスにならないよう
                          に改善できたので， decode_c_st1()，decode_p_st1() と
                          getbits() をアセンブラ化した。展開系はこれくらいで一
                          段落とする。ここまでで 18s フラットまで改善した。
Aug.31,2005             ・引き続き圧縮方面。 putcode() と putbits() を LHA Ver
                          2.11 のアセンブラルーチンを基調としたものに変更した。
                          効果は 74s→67s。 ちなみに LHA32 では 46s と相当の差
                          がある。圧縮系主要関数の呼び出し回数は以下のとおり：

                                match_insert            121,878,973
                                output_st1              119,248,528
                                putcode                 127,038,876
                                putbits                   2,887,235
                                encode_p                  2,630,445

                          一番影響大なのは，当然ながら match_insert なのだが，
                          ebp レジスタが使用されていることから，インラインアセ
                          ンブラを使っての変更は不可 (というか，変数名が使えな
                          くなるので非常に面倒なことに…)。
Sep. 2,2005             ・とはいうものの， match_insert() の改良は避けて通れな
                          いので，面倒だがアセンブラ化を行った。苦労した甲斐だ
                          けあって，67s→59s と，かなり効果が上がった。
                        ・ファイルハンドルのリークチェックルーチンがメモリマッ
                          プト版に対応していなかったバグを修正した。
                        ・CheckSFXType() で読み込みエラー等が発生した場合にファ
                          イルハンドルの解放し忘れが生じていたバグを修正した。
                        ・スペルミス等，メッセージ関係の修正。
Sep. 3,2005              (1.99.2.22; β版公開)
Sep. 5,2005  Ver 1.99c  ・ダイアログ更新＆メッセージ送出タイミングの基となる基
                          準サイズを調整。
                        ・展開関係アセンブラルーチンの命令順を調整。却って遅く
                          なるような CPU は存在しないはず…。18s→17s
Sep. 6,2005             ・圧縮関係アセンブラルーチンの命令順を調整。59s→58s
                        ・Ver 1.99b で，アルゴリズムテスト用のコードが混入して
                          しまっていたバグを修正 (圧縮率が若干下がる)。
Sep. 7,2005             ・メモリマップドファイル使用の有無を設定ダイアログで指
                          定できるようにした。 問題がある場合は， 通常の WIN32
                          API によるアクセスを選択することになるが，入出力ルー
                          チンが以前と異なっている点に注意。
Sep. 9,2005             ・"-jsp"  スイッチに実行可能ファイルの展開を抑制するた
                          めの BPL_DENY_EXECUTABLE フラグ (8) を追加し，規定の
                          拡張子をオーバライドする "-jtz" スイッチについても追
                          加を行った。
Sep.10,2005             ・"-jsp" スイッチで BPL_DENY_TOO_MANY_PARENTS が指定さ
                          れている場合に，拡張子偽造の疑われる連続したスペース
                          (規定では 8 文字以上) をもつ名前のメンバーを不正扱い
                          とするようにし，連続数を指定する "-jts" スイッチを追
                          加した。
                         (1.99.3.29; β版公開)
Sep.12,2005  Ver 1.99d  ・BPL_DENY_EXECUTABLE を有効とした場合に，環境によって
                          は拡張子にかかわらず警告が行われてしまっていたバグを
                          修正。環境によって，コンパイラーの追跡結果とは異なる
                          レジスタの保存状況となってしまうのが原因らしい。
                        ・『実行ファイル確認ダイアログ』で『展開する』が初期選
                          択状態となってしまっていた点を改善。
                         (1.99.4.31; β版公開)
Sep.14,2005  Ver 1.99e  ・WinSFX32M について，インストール関連情報のレジス
                          トリー保存先を変更した。
                        ・DELREG.EXE について，WinSFX32M 2.82 対応版への更新を
                          行った。
Sep.16,2005              (1.99.5.33; β版公開)
Sep.27,2005  Ver 1.99f  ・メソッド ID と実際のメソッドが異なる場合に，展開でき
                          ない (ERROR_HUFFMAN_CODE が返される)  ことのあったバ
                          グを修正 (h5/h6 間の不整合については，エラーとなるの
                          が正常)。
Sep.30,2005             ・'t' コマンド実行時にハフマンコードエラーのメッセージ
                          表示を行ってしまっていたバグを修正。
                         (1.99.6.35; 正式版公開)
Oct. 6,2005  Ver 1.99g  ・Ver 1.99 以降，Win 9X 系の場合にタイムスタンプが操作
                          時のものになってしまうことのあったバグを修正。
                         (1.99.7.36; 正式版公開)
Oct. 8,2005  Ver 2.00   ・メモリマップドファイルを使用しての書込オープン時に，
                          サイズが  4GB を超えると書き込みエラーの発生してしま
                          う環境があったバグを修正。
                        ・システムによるメモリーフラッシュの遅延により，ビュー
                          のコミットメモリーが蓄積され，結果，スワップの連続状
                          態に陥りハングアップ (に近い状態) してしまう環境が存
                          在するため，512MB 毎に強制的に FlushViewOfFile() API
                          でフラッシュを行うようにした。
Oct. 9,2005              (2.00.0.2; β版公開)
Oct.14,2005  Ver 2.00a  ・正式版としてコンパイル
                         (2.00.1.2; 正式版公開)
Oct.27,2005  Ver 2.01   ・メモリマップドファイルを使用していない場合に，ファイ
                          ルポインタの設定に失敗してしまうことのあったバグを修
                          正しました。
Oct.28,2005             ・UnlhaExtractMem() 等において，展開対象となるメンバー
                          のサイズが  64K 程度を超えると最後の部分が展開されな
                          いことのあったバグを修正。
                         (2.01.0.2; β版公開)
Oct.30,2005  Ver 2.01a  ・UnlhaExtractMem() 等において，特定の箇所が正常に展開
                          されない環境の存在していたバグを修正。原因不明で再現
                          不可能だったので，当該ルーチンを書き換えることで一応
                          対処。
Oct.31,2005              (2.01.1.3; β版公開)
Nov. 7,2005  Ver 2.01b  ・正式版としてコンパイル
                         (2.01.2.3; 正式版公開)
Nov.29,2005  Ver 2.02   ・デバッグログ出力ルーチンの変更 (以降，継続)。
Nov.30,2005             ・警告レベル  4 による警告が行われないように改善した。
                          ただし，ウィンドウプロシージャの lParam が内部で使用
                          されない，アセンブラ化されているために表面上未使用と
                          判断される，…といった一部の関数でのパラメータ未使用
                          警告や， 未返却値警告，VC++ 自身のヘッダ類での警告を
                          除く。
Dec. 2,2005             ・Outlook Express 6 のメール作成中に，添付元の書庫を別
                          のソフトで編集しようとした結果，共有エラーとなってし
                          まい，圧縮しようとしたファイル (おそらく指定リストに
                          より最後にマッチしたもの) が消失してしまうことのあっ
                          たバグを修正。
                          コンパイル時の (コンパイラーによる) レジスタ追跡とは
                          異なる結果となる一部の環境で発生するが，発生する環境
                          であれば，オリジナル書庫を退避する際の MoveFile() が
                          失敗すれば 100% 再現するはず…。 現在のところ，Win2K
                          上の Outlook Express 6 + (ExpLzh 4.6x | LHUT32 1.4x)
                          の組み合わせについて報告例あり。使用するアーカイバー
                          にもよるらしいのだが，共有エラー自体は Outlook
                          Express によるロックが原因らしい…。
Dec. 4,2005             ・SetLangueSpecified() API 等について， 同じ言語識別子
                          が指定された場合には，文字列の初期化を行わないように
                          した。
Dec. 5,2005              (2.02.0.4; β版公開)
Dec. 8,2005  Ver 2.02a  ・NT 系の場合に MoveFileEx() を使うことで， 書庫退避時
                          における名前衝突の回避を図った。
                        ・新規書庫の直接作成時に書庫を  OPEN_ALWAYS で開いてし
                          まっていたバグを修正 (直前で存在確認及び削除を行って
                          いるが，名前衝突の可能性がある)。
                        ・新規書庫の直接作成時などの際に，実際にタイムスタンプ
                          を書き込まない場合にも， (そのために) 書庫を再度開い
                          てしまっていたバグ (無駄) を修正。
Dec.10,2005             ・MyGetFullPathName() でのパス構築ループで，無駄にパス
                          を遡りながら構築が行われていた点を改善した。
                        ・MyGetFullPathName() においても連続スペースのチェック
                          を行うようにした。
                        ・MyGetFullPathName()， CheckPathName() でのバッファ溢
                          れチェック方法の改善。
Dec.11,2005             ・格納等の書庫操作時に，重複して書庫の存在チェックを
                          行っていたバグ (無駄) を修正。
                        ・UnlhaGetAttributes() API を追加。 それが本来の名前…
                          ということで，意外と "UnlhaGetAttributes" で呼び出そ
                          うとして失敗する例があるようなので…。
Dec.12,2005             ・ロング名とショート名  (8 + 3 文字)  が同じ場合には，
                          ショート名の記録を行わないようにして，検索時の無駄を
                          省いた。
Dec.13,2005             ・CheckSFXType() において， 本処理とは別にファイルを開
                          いてサイズを得ていた無駄を改善した。
                        ・MyGetFileAttributes() において FILE_FLAG_BACKUP_
                          SEMANTICS が有効となっている場合に，内部処理でエラー
                          となっても，極力ファイルハンドルを閉じるように改善し
                          た。
Dec.16,2005             ・圧縮時に，当該ファイルのファイルサイズを得るために無
                          駄なファイルオープンを行っていたバグを修正。
Dec.17,2005             ・UNIX 形式書庫の場合に， 拡張ヘッダ 0x54 を認識して読
                          み込んでいるにも拘わらず更新日時が反映されていなかっ
                          たバグを修正。他の拡張ヘッダとの記録順が定かでないた
                          め，あえて更新日時への反映のみに止めてある。
                        ・ヘッダ書込時に，拡張ヘッダ 0xFF のパーミッション情報
                          について，初期値を "rwxr-xr-x"，"rw-r--r--" に変更し
                          た (そうなっている書庫が多いようなので)。
Dec.18,2005              (2.02.1.18; β版公開)
Dec.24,2005  Ver 2.02b  ・Ver 2.02 以降，UnlhaGetArcOriginalSizeEx() と Unlha-
                          GetArcCompressedSizeEx() が  UnlhaGetArcFileSizeEx()
                          の返却値を返してしまっていたバグを修正。
                         (2.02.2.19; β版公開)
Dec.27,2005  Ver 2.02c  ・(システムによる)  メモリー解放の後にずれ込む環境が意
                          外と多いらしく，多数の小さなファイルを扱った場合など
                          に未解放のマップが蓄積された結果，メモリーを圧迫して
                          しまうことのあった点に対応。ただし，ファイルのクロー
                          ズ時に必ずメディアへの書き出しが行われるため，却って
                          アクセスが遅くなる場合もある点に注意。
Jan. 1,2006             ・↑で，部分的な書き出ししか行われていなかったバグを修
                          正。
                        ・環境によってはメモリーの圧迫がシステムの動作に影響を
                          与えてしまうようなので，FlushViewOfFile() API の間隔
                          を 256MB 毎に縮小した。
Jan. 2,2006              (2.02.3.22; β版公開)
Jan.22,2006  Ver 2.02d  ・正式版としてコンパイル
                         (2.02.4.22; 正式版公開)
Jan.31,2006  Ver 2.02e  ・Ver 2.02 以降， UnlhaCheckArchive() に空文字列が渡さ
                          れた場合等に TRUE を返してしまっていたバグを修正。
Feb. 2,2006  Ver 2.39    (Unicode 対応化作業開始)
                        ・とりあえず内部動作を Unicode ベースに変更。 今のとこ
                          ろは，Win2K 以降の NT 系 OS でしか動作せず，専用拡張
                          ヘッダや API の追加等も一切行われていない。
                        ・動作確認自体に必要となったので，拡張ヘッダの読み書き
                          を行うようにした。 ディレクトリーセパレータは 0xFFFF
                          を使用。h2 形式以降の書庫で必要な場合のみ追加される。
Feb.16,2006             ・WideCharToMultiByte() での変換時にシステム既定の文字
                          を使うようにする "-jtu" スイッチを追加。 UNLHA32.DLL
                          の既定値は '_'。
                        ・MyGetPrivateProfileStringA() のバグフィクス。 …とい
                          うか実装し忘れていて MyGetGenericProfileStringA() を
                          呼び出すだけになっていたものを修正。(^^;;
                        ・コンパイルオプションのファイル個別設定が掛かっていた
                          ため， SELF.C の修正が殆ど行われていなかったバグを修
                          正。
                        ・(特にログ関係で) Unicode  からマルチバイト文字への変
                          換し忘れの存在するバグを修正。以下調査・継続。
Feb.17,2006             ・動作全般に関わる指定であることから， "-jtu" スイッチ
                          を削除し，レジストリーで指定するように仕様変更した。
                        ・ヘッダ作成時に， ANSI 版のパス名・ファイル名について
                          Unicode での文字数に基づいて書込を行ってしまっていた
                          バグを修正。不整合の生じるような名前のメンバーについ
                          ては， 拡張ヘッダの Unicode による情報が使われるため，
                          表面化しなかったもの。
Feb.18,2006             ・ヘッダ読み込み時の  char→WCHAR 変換に伴う文字数確認
                          のバグを修正。
                        ・WinMe 用ダミー  API の作成を開始。(以下継続)
Feb.19,2006             ・WinMe 用ダミー API の作成。
Feb.20,2006             ・β版について， 各 API のエラーチェック用の確認コード
                          を追加。とりあえずは Unicode 方面から。(以下継続)
                        ・少々 Win95 での動作確認が必要となったことから，Wide-
                          CharToMultiByte() の Win95 対策コードの追加と，lstr-
                          cpyW() のダミー関数を追加した。
Feb.21,2006             ・WC_NO_BEST_FIT_CHARS が Win2K 未満でも無効であると忘
                          れていたバグを修正。
                        ・拡張ヘッダ 0x01  (ファイル名) の書込が正常に行われな
                          い可能性のあったバグを修正。
                        ・CheckWCharToCharN()  が指定されたものより 1 文字多い
                          文字数で変換チェックを行ってしまっていたバグを修正。
                          このため，不必要な 0x44，0x45 の拡張ヘッダを出力して
                          しまうことがあった。
Feb.22,2006             ・速度を犠牲にして DmCharUpper()，DmCharLower() の改善
                          を行った。
                        ・DmCompareString() について，正常な文字数による比較が
                          行われないことのあったバグを修正。
Feb.23,2006             ・デバッグログ出力の際に一般保護エラーとなってしまうこ
                          とのあったバグを修正。wsprintf() ('%s') のヌルポイン
                          タチェックって，Win9X，Win2K/XP では行われるのに，
                          NT4.0 だと落ちるのね…。手抜きはダメか。(^^;;
                        ・MyConvFileName()  が正常な変換を行っていなかったバグ
                          を修正。
                        ・MyGetFullPathName() が Unicode  専用版のままだったバ
                          グを修正。
                        ・GetExistDirectory() が Unicode  専用版のままだったバ
                          グを修正。
Feb.24,2006             ・Unicode 対応化に伴い追加したものの内，不必要だった関
                          数を削除 (以下継続)。
                        ・Win9X/Win32s  でロードエラーとはなっていない (使われ
                          ることもない) が，残りの Unicode 版 WIN32 API につい
                          て，ダミー API を作成 (以下継続)。
Feb.28,2006             ・ヘッダに書き込まれた名前のコードページを示す 0x46 の
                          コードページヘッダを追加。コードページが設定されてい
                          ない場合は書き込みを行わず，変換には CP_ACP を使用す
                          る。コードページの優先順位は今のところ ANSI→OEM→
                          CP_ACP となっているが， OEM の使用で却って問題の出る
                          環境があるのかも…。インド方面の各言語版って GetOEM-
                          CP() 等で何が返ってくるのかしら (UNLHA32.DLL  が使っ
                          ているのは GetLocaleInfo())？
                          既存ヘッダのための情報なので， h2 形式の場合に無条件
                          で書き込みを行う。ID 44/45 の Unicode ヘッダを常に書
                          き込めば必要ないわけで，そちらのほうがアプリ側共々数
                          段簡単な処理となるのだが， 名前情報が 3 倍になるので
                          は，考える間もなく却下でしょう。
                          あ，現在の版では，情報は読み込めども，そのコードペー
                          ジでの変換が当該システムで可能かどうかのチェックを
                          行っていない。ので，後で忘れずに実装すること。(笑)
                         (Vista β2 で，たまに展開終了時に一般保護エラーとなっ
                          てしまうのだが，現在のところ原因不明。一度他の言語版
                          の Win2K/XP でも試してみないと…)
Mar. 1,2006             ・引き続き Win9X/Win32s でロードエラーとはなっていない
                          Unicode 版 WIN32 API について，ダミー API を作成。
                        ・引き続き Unicode 対応化に伴い追加した中の， 不必要な
                          関数を削除。
Mar. 2,2006             ・引き続き Win9X/Win32s でロードエラーとはなっていない
                          Unicode 版 WIN32 API について，ダミー API を作成。
                          (今回で終了)
                        ・引き続き，ログ関係で Unicode  からマルチバイト文字へ
                          の変換し忘れの存在するバグを修正。
Mar. 3,2006             ・ヘッダに書き込まれた名前の読み込み時に使用するコード
                          ページを指定する "-jtl" スイッチを追加。
Mar. 5,2006             ・引き続き Unicode 対応化に伴い追加した中の， 不必要な
                          関数を削除。(今回で終了)
Mar. 7,2006             ・デバッグログ用関数の追加。
                        ・FddCheck() の改善。なお，以前は名前のとおりの関数だっ
                          たが，現在の仕様としては厳密に FD かどうかのチェック
                          を行っているわけではない。(笑)
                        ・Ver 2.02c で追加したファイルクローズ時の  FlushView-
                          OfFile()  の実行有無をレジストリーで指定できるように
                          した。MFNoFlush に 1 とすることで 2.02b までと同じ仕
                          様となるが，当然ながら 1 ファイル毎に最大 256MB の実
                          メモリが消費されたまま (システムによるフラッシュタイ
                          ミングを考慮すると『消費されたまま』と言っても過言で
                          はないのが実情) となるので，注意すること。多少の速度
                          改善は行えるかもしれないが，お勧めできないので，自己
                          責任の非公式扱い。(^^;)
                        ・↑について，さらに 2 で FlushViewOfFile() を全く行わ
                          ないようにした。
Mar. 8,2006             ・展開時の空き容量チェックの処理方法を改善。無視 (当該
                          ファイルの展開を試みる)， 継続 (当該ファイルの展開を
                          スキップ)，中止を選択できるようにした。 また，従来は
                          空き容量が足りない場合は無条件にスキップしていたもの
                          を，抑止されていない限りは警告ダイアログを表示するよ
                          うにした。
                        ・UNC パス名で書庫が指定された場合に，ロングファイル名
                          使用可否判定に失敗してしまっていたバグを修正。
                        ・ファイルオープン再試行時について，ファイルが見つから
                          なかったにも関わらず再試行を行ってしまっていたバグを
                          修正。
Mar.10,2006             ・デバッグ出力ルーチンの整理。
                        ・書庫更新時の作業書庫に対する NTFS チェックが正常に行
                          われないことのあったバグを修正。
                        ・空き容量取得関係ルーチンの統合。
                        ・DmFindNextFileW() において， 必要のない Unicode 用か
                          ら ANSI 用へのバッファ転送を行っていたバグを修正 (た
                          またま ERROR_INSUFFICIENT_BUFFER となっていたが， 一
                          般保護エラーとなる可能性が高かった)。
Mar.11,2006             ・"-jb" スイッチ用のポインタが初期化されていなかったた
                          め，スイッチを使用していない場合に一般保護エラーとな
                          ることのあったバグを修正。
                        ・Mylstrcpyn2W() を変更。 最適化の関係で  Win9X/Win32s
                          系でパラメータ変数の予期せぬ変更が起こってしまう。
                        (2.39.0.44; α版公開)
Mar.12,2006  Ver 2.39a  ・書庫ヘッダ読み込み時のコードページを指定する  Unlha-
                          SetCP() API を追加。UnlhaOpenArchive2() を使用しない
                          場合で， OpenArchive 系 API においても正常な情報を得
                          る必要があるのであれば，こちらを使用。ただし，一時指
                          定ではない点に注意。取得は UnlhaGetCP()。
                        ・DLL ロード時の米語用言語設定  (既定値記憶)  がおかし
                          かったバグを修正。このため，米語を指定した際に本来必
                          要のない再設定処理が行われてしまっていた。
                        ・SetLangueSpecified() API 等の仕様を変更。 他の設定用
                          API と同様，処理結果を返すようにした。仕様が変更され
                          ても，既存アプリの動作には全く影響しないはず。
                        ・コードページの設定時にサポート対象ページかどうか
                          チェックするようにした。
Mar.14,2006             ・MyGetFileSize() を使用していた箇所について MyGetFile-
                          Size2() を使用するように改善。
                        ・FileSearchSubSub() の全指定チェックの無駄を省いた。
                        ・Unicode ヘッダの読み書き有無を指定する "-jtu" スイッ
                          チを追加。規定値は 1。0 で無視，2 で常に書込となる。
                          レジストリーで省略値を指定可。
Mar.17,2006             ・Unicode 版 API の実装準備として， ログ関係を Unicode
                          ベースに変更した。
Mar.18,2006             ・Unicode 版 API の実装準備として， UNLHA32.H を両用形
                          式に変更した。 これに伴い UnlhaA() 等の  ANSI 版 API
                          を追加。 UnlhaW() 等の Unicode 版 API も，エラーを返
                          すダミー関数として用意。UNLHA32.H の変更によって，マ
                          クロ UNICODE の定義有無によって各 API の意味が異なる
                          ようになっているので，注意が必要。
                        ・ダイアログ関係を除いて内部処理の  Unicode ベース化が
                          終了。ダイアログ関係については，ダイアログのウィンド
                          ウハンドルを利用して直接情報を取得しているアプリ等が
                          存在することから，引き続き様子見。
Mar.19,2006             ・2.02c で FlushViewOfFile() の実行間隔を 256MB 毎とし
                          たことで，メモリー圧迫の問題が，改善した (らしい) こ
                          とから，ファイル・クローズ時のマップ解放をシステムに
                          任せる仕様へ戻した。
Mar.20,2006             ・HARC ハンドル内のメンバー名記録を WCHAR にし忘れてい
                          たバグを修正。 論理的にはバグだが，2.39 に限って言え
                          ば全く問題なかったり…。(笑)
                        ・UnlhaGetOSType()  等の検索状況チェックが正しく行われ
                          ず，検索前でもエラーとならずに不定の値を返してしまっ
                          ていたバグを修正。
                        ・各  API に渡されたバッファの確保状況をチェックするよ
                          うに改善した。渡されたサイズが確保されていない場合は
                          ERROR_INVALID_VALUE を返す。
Mar.21,2006              (2.39.1.58; α版公開)
Mar.21,2006  Ver 2.39b  ・ワイルドカードによる書庫指定が行われた場合に，対象書
                          庫が確定される前に  FDD チェックを行ってしまっていた
                          ため，正しく判定されていないことのあったバグを修正。
Mar.22,2006             ・これまで Unlha() 等で szCmdLine に NULL が渡された場
                          合に ERROR_COMMAND_NAME  を返していたものを， ERROR_
                          INVALID_VALUE を返すようにした。
                        ・直前の API  実行において内部的に返された UNLHA32.DLL
                          のエラー値を得る UnlhaGetLastError() を追加。
Mar.23,2006             ・UnlhaGetLastError() 用に， 適切な位置で GetLastError
                          () 等のエラー値を保存するように改善。
                        ・コマンド文字列取得ルーチン (ANSI/Unicode) の共通化を
                          進めて， より初期段階から Unicode ベースで扱うように
                          変更した。
Mar.24,2006             ・2.39.1.62 の変更について，まだ SetLastError() を行っ
                          ていた箇所が残っていたバグを修正。
                        ・2.39.1.63 の変更について，Unicode 版のレスポンスファ
                          イル取得ルーチンを作成し忘れていたバグを修正。
Mar.25,2006             ・"-jyn" によるファイル名変更時について，NT 系の場合に
                          は GetSaveFileNameW() を呼ぶようにした。
                        ・Ver 2.39a において，Win9X 系で実行した場合に一部のロ
                          グが正常に出力されなかったバグを修正。
                        ・変名ダイアログについて， 取得を Unicode で行っていた
                          ものの，初期化が ANSI のままだったバグを修正。
                        ・状況表示ダイアログでのパス名等の表示を  Unicode で行
                          うようにした。
Mar.26,2006             ・"-jsc" スイッチを指定した際に， 処理したファイル数が
                          0x8000 (32768)  以上になると，エラーとして扱われてし
                          まうことのあったバグを修正。
                         (巨大化していますが，簡易デバッグ用ログ出力ルーチンに
                          よるものです。 正式版コンパイルを行うと， この版では
                          439KB→299KB となります。ちなみに 2.02e は 272KB)。
                         (2.39.2.70; α版公開)
Mar.28,2006  Ver 2.40   ・Unicode 版 API を実装…といっても所要時間 15 分。(笑)
                         (2.40.0.71; β版公開)
Apr. 2,2006  Ver 2.40a  ・Ver 2.39b 以降において， コールバック ARCHIVERPROC()
                          を使用している場合に，UNLHA32.DLL が勝手にエラー報告
                          を行って処理を中止してしまっていたバグを修正。
                        ・EXTRACTINGINFOEXW 等，Unicode 系構造体を使用した場合
                          に，正常に値が格納されないことのあったバグを修正。
                         (結構影響の大きいバグなので，日替わり UP)
                         (2.40.1.73; β版公開)
Apr. 6,2006  Ver 2.40b  ・"-o2" スイッチが指定されている場合には，lh4 形式が採
                          用された際に LHA Ver 2.13 の仕様どおり "lh4" のメソッ
                          ド ID を記録するようにした。
Apr.13,2006             ・Ver 1.99f 以降 lhx  形式の展開が行えなくなっていたバ
                          グを修正。
Apr.14,2006             ・lhx 形式で 16 ビット以上のスライド辞書サイズを選択し
                          た場合には， ハフマン用のバッファを 2 倍するように改
                          善した (というか，そのほうが圧縮率の向上することが多
                          かっただけで，低下する場合もあるので注意)。
Apr.19,2006             ・ハフマン用バッファへの格納について，『文字・一致長』
                          と『一致位置』について別のバッファを使用するようにし
                          た。一致位置の情報が (実質) 無駄となっているのと，処
                          理の単純化が採用の理由。ただし，バッファ内データ量の
                          変化は諸刃の剣なので，却って圧縮率が低下する場合も，
                          まま，ある点に注意。
                        ・スライド辞書サイズ実験用の圧縮ルーチンと既存のルーチ
                          ンを統合した。 展開ルーチンについては， getbits() の
                          仕様上，一致位置により処理を分岐させる必要が生じるこ
                          とから，展開速度への影響が多大であったため統合してい
                          ない。
Apr.21,2006             ・殆ど差のないところまで最適化できたので，展開ルーチン
                          についても，実験用ルーチンと既存ルーチンの統合を行っ
                          た。
                        ・lhx で 16 ビット以下が指定された場合には，既存の lh4
                          〜lh7  形式の書庫を作成するようにすることで， "-jmm"
                          スイッチを他ツールの『速度 vs 圧縮率』的指定の感覚で
                          使えるようにした。 17 以上を指定した場合には，引き続
                          き "lhx" のメソッド ID となる。
                          参考までに， lhx (17〜19) についても基本的には既存の
                          ルーチンで展開が可能。ただし， 16 ビットを超える一致
                          位置となる場合も当然ながら出てくるので，その点に対応
                          しておく必要がある (WORD サイズに最適化されているルー
                          チンが多い)。最大サイズである 512KB のスライド辞書を
                          作成し，NP = 19 + 1 を指定して各種バッファの確保を
                          行っておけば lh6 形式 (辞書サイズが 16K 以上) 以上の
                          辞書サイズとなるメソッドを統一的に扱える。ちなみに，
                          lh4/lh5 と lh6 以降で PBIT のサイズが異なるため， 同
                          一の展開ルーチンで扱うのは無理 (『メソッド ID で判別
                          して初期値を変更』といった程度を同一と判断するのであ
                          れば，話は別)。
Apr.29,2006             ・2.40.2.77 以降で，まれに圧縮の失敗することがあったた
                          め，遅延処理の条件を改善した。この辺りが絡んで条件が
                          簡略化されているような気がしないでも…。＞オリジナル
                        ・意味もなく lh3 の圧縮ルーチンを追加。これに伴い "-jm"
                          スイッチの仕様を拡張し，"-jm6" で lh3 形式を選べるよ
                          うにした。"-jm5" は lh2 の予定。
                        ・LH 1.90 と同様に ready_made() を使用した場合の結果と
                          比較した上で，固定ツリーを使用するかどうかを決定する
                          ようにした。
Apr.30,2006             ・拡張ヘッダの書き込み順を改善し， "-o" スイッチにより
                          互換モードが指定されている場合には，  ファイルサイズ
                          ヘッダ以外の独自ヘッダを作成しないようにした。ファイ
                          ルサイズヘッダについては，それがないと当該メンバーを
                          扱えなくなることから，無条件で作成される。
May. 1,2006             ・lh2 の圧縮ルーチンを追加。LH Ver 1.9x と異なり，サイ
                          ズによって lh2 と lh3 を切り替えるようなことは行わな
                          い。
                        ・lzs の圧縮ルーチンを追加。  1 段ロケットということで
                          比較的処理は軽いはずなのだが，lh7 よりも遅かったりす
                          るのが実情。最長一致文字数が 17 までと小さく，その度
                          に検索処理を行う結果となっている点も影響しているのは
                          確かだが，圧縮率が低いために出力結果のサイズが大きく
                          なってしまい，そのための入出力処理に時間をとられてい
                          るのが唯一 (といっても過言ではない) 最大の原因。
                          なお， lh1〜lh7 までの LZ77 関係ルーチンを使用してい
                          る関係上，2 文字の一致を無視している点がオリジナルと
                          は大きく異なっている点に注意。
May. 3,2006             ・最大一致文字数の小さい lzs/lh1 が， lh2 以降に比べて
                          検索回数が多くなってしまう分，速度的に不利となってい
                          る点を改善すべく，検索自体については擬似的な最大一致
                          文字数で処理を行うようにした。いろいろな文字数で試し
                          てみたところ，オリジナルの倍数での結果が良かったこと
                          から， 速度とのかねあいで，lh1/lzs/etc を， それぞれ
                          240/255/512 とした。
                        ・↑について， 最終的に THRESHOLD 未満の端数が生じる場
                          合には前後で一致文字数の調整を行っていたのだが，その
                          ような調整を行わずに，一致長の切り捨てを行うようにし
                          た。
                        ・オリジナル同様，8K を超えるファイルについては lh2 で
                          はなく lh3 が適用されるようにした。 反対に，速度的な
                          メリットが存在するので，8KB 未満のファイル場合に lh3
                          から lh2 への切り替えは行わない。
                        ・lz5 の圧縮ルーチンを追加。これでオリジナルの形式につ
                          いては全て圧縮も可能となった。まぁ，展開ルーチンのみ
                          の UNARJ.EXE  から圧縮ルーチンを作成するための布石と
                          いうことで…。(笑) ＞一連の圧縮ルーチン追加
May. 4,2006             ・lz5 の圧縮ルーチンについて，putbits() を使っていたも
                          のをオリジナル同様の  fputc() 相当の処理を行うように
                          した。putbits() 同様アセンブラ化を行ってみたものの，
                          1/100 程度の差しか現れなかったので，C のルーチンを有
                          効にしてある。(笑)

                          ここまでの各圧縮メソッドの比較をしてみると：

                                VMWare55.BMP                     9,437,238
                        unlha32         lh1             8.712    6,064,387
                        unlha32         lh2             7.704    4,784,669
                        unlha32         lh3             3.945    4,791,388
                        unlha32         lh4 (lhx12)     4.827    5,816,805
                        unlha32         lh5 (lhx13)     4.026    4,939,241
                        unlha32         lh6 (lhx15)     4.026    4,796,962
                        unlha32         lh7 (lhx16)     4.543    4,749,376
                        unlha32         lhx17           6.750    4,704,704
                        unlha32         lhx18          11.263    4,689,565
                        unlha32         lhx19          19.441    4,687,836
                        unlha32         lzs             5.258    7,010,067
                        unlha32         lz5             4.486    7,061,391
                        LArc 3.33       lz5                      7,061,871
                        LHarc 1.13d     lh1                      6,081,618
                        LH 1.90         lh3                      4,789,893
                        LHA 2.13        lh5                      4,953,678
                        LHA 2.67        lh5                      4,943,852
                        LHA 2.67        lh6                      4,804,788
                        ExpLzh          lh5                      4,992,949
                        ExpLzh          lh6                      4,913,699
                        Lhaplus         lh5                      4,941,192
                        zip32           Deflate                  4,867,960
                        ExpLzh          Deflate                  4,867,811
                        7-zip32         Deflate                  4,674,848
                        7-zip32         Deflate64                4,617,915
                        cab32           lzx21                    4,295,669
                        7-zip32         Lzma                     3,601,742
                        7-zip32         Ppmd                     4,137,524

                                beside_demo_s.mpg               11,704,324
                        unlha32         lh1            15.021   10,944,100
                        unlha32         lh2            15.710   10,872,570
                        unlha32         lh3             6.135   10,903,150
                        unlha32         lh4             6.880   10,938,992
                        unlha32         lh5             6.329   10,892,649
                        unlha32         lh6             6.306   10,803,100
                        unlha32         lh7             7.548   10,565,128
                        unlha32         lhx17          14.307   10,461,657
                        unlha32         lhx18          29.535   10,385,728
                        unlha32         lhx19          56.421   10,338,759
                        unlha32         lzs             6.620       ―
                        unlha32         lz5             6.399       ―
                        zip32           Deflate                 10,793,851
                        cab32           lzx21                   10,261,500
                        7-zip32         Lzma                    10,256,638

                          といった感じです。DLL 組は LHMelt を使用，サイズは作
                          成された書庫のものです。あと，lh2 形式については，現
                          在の仕様では 8K バイトを超えるファイルについては lh3
                          に変更されます，念のため。それと，圧縮時間については
                          Encode() ルーチンのものなので， UNLHA32.DLL のデータ
                          しかありません。
                          こうしてみると，通常は lh6 で充分。 そして，意外とバ
                          カにしたものではないのが lh3…といった感があります。
                          UNLHA32.DLL のルーチンは，まだ一捻りが足りていないの
                          か，オリジナルに比べて少々圧縮率が悪いので，本来なら
                          さらに有用…ということになりそうです。＞lh3
                          なお，これはデバッグ版での結果で，正式版用コンパイル
                          では，例えば lh6 の BMP では 4.026→2.955 くらいの差
                          が出ます。 最適化，恐るべし。あ， DynaBook G7 の強制
                          標準モード (1.2GHz) での計測です。
May. 8,2006              (2.40.2.92; β版公開)
May.15,2006  Ver 2.40c  ・2.40.2.87 での変更が速度に影響を与えていない (効果が
                          あったとしても  lh1/lh2/lzs/lz5 は使われていない) こ
                          とと， より効果の高い lh1/lh2/lzs/lz5 について，スラ
                          イド辞書の有効サイズ低下によるデメリットのほうが大き
                          いことから，擬似的最大一致文字数による検索関係のコー
                          ドを削除し，オリジナルのコードに戻した。
                        ・lh1/lh2 形式での圧縮中にルーチンを抜けてしまうことの
                          あったバグを修正。 lh1 については，おそらく Ver 0.19
                          から。(^^;;
                         (2.40.3.94; β版公開)
May.18,2006  Ver 2.40d  ・圧縮率実験用として lzx 形式を試験追加。 速度と圧縮率
                          の兼ね合いで， 最終的に最大一致文字数 33，辞書サイズ
                          32K を採用。 lz5 と同様 8 バイト毎のブロック化を採用
                          し一致長は 5 ビットで出力。 一致位置については，基本
                          的に lh5  等と同じでビット長を出力後残りのビットを出
                          力。一致位置のデータについては，lzs/lz5 と異なり lh1
                          以降と同様にオフセットをそのまま採用。
                          結果は以下のとおり：

                                VMWare55.BMP                     9,437,238
                        unlha32         lh4             5.092    5,816,534
                        unlha32         lh5             4.392    4,938,760
                        unlha32         lz5             4.804    7,055,195
                        unlha32         lzx             4.236    5,385,389

                          ARJ でのメソッド 4 と同じ位置づけのものだが， ARJ で
                          は確かにメソッド 1 が 6s  なのに対して 3s 弱と倍程度
                          の速度となっているものの，UNLHA32.DLL では，そもそも
                          通常圧縮である lh5/lh6 が 4s なので， 意味が無くなっ
                          てしまっている (ちなみに正式版なら，双方 3s 弱)。
May.19,2006             ・"-lh?-"，"-lz?-" のメソッド ID では， 不具合の出るア
                          プリの発生する可能性がある (lh0/lh1 以外を  lh5 系の
                          ルーチンで扱ってしまうもの) ので， lzx 形式の ID  を
                          li1 に変更した。lhx については，すでに使用例があるた
                          め変更なし。
                        ・『LZ77 のみの lzs/lz5 に対して，ハフマン法のみを適用
                          した場合の結果は？』といった質問メールが時々やってく
                          るので， 説明用に li2 形式を追加。ちなみに，結果は以
                          下のとおり：

                                VMWare55.BMP                     9,437,238
                        unlha32         lh0             0.270    9,437,320
                        unlha32         lh6             4.156    4,796,986
                        unlha32         li1             4.096    5,385,389
                        unlha32         li2             2.864    8,302,084

                          lz5 等と同じ理由で，非常に単純な処理の割りには時間の
                          掛かってしまうのが実情。 時間が掛かりすぎて lh0 の代
                          わりに使用することも不可。
May.23,2006             ・MTF ルーチン検証用として li3 形式を追加。 向き・不向
                          きのチェックを兼ねているので，MTF による変換を行った
                          後ハフマン法 (li2) を行ったものとなっている。 ルーチ
                          ンについては，MoveMemory() を使ったもの， 各コード毎
                          のインデックスを操作するもの，線形リストを使ったもの
                          の 3 つについて試してみたが，MoveMemory() を使ったも
                          のが一番速かったという，おもしろみのない結果に。次点
                          は線形リスト。インデックスを使ったものは，当該コード
                          のインデックスを検索なしで得られることが利点。しかし
                          そのインデックス操作のコストが高すぎるのでアウト。反
                          対に，線形リストは順序入れ替えのコストが非常に少ない
                          点では有利だが，インデックス検索のコストが少々高いの
                          で次点に甘んじている。ランタイムの使用や十分な最適化
                          を行えない環境では，こちらが最速。
                          なお，これは一般的なデータに対して変換を行った結果で
                          あって，BWT 辺りの後に行った場合とは全く事情が異なる
                          ので注意。
May.26,2006             ・試しに lh5 と同等のメソッドに MTF を適用してみたとこ
                          ろ，8K の辞書サイズで lhx17 と同程度の圧縮率へ向上し
                          たものの，mpg 等では反対に状況が悪くなってしまったこ
                          とから試用を取りやめた。 処理時間も lhx17 に近いもの
                          となるため，lhx17 を適用したほうが話が早い。ただ，メ
                          モリの少ない  DOS のような環境では意味があるのかもし
                          れない。
May.27,2006  Ver 2.40e  ・lzx 等を追加する前からの予定どおり lh3 と lh5 のハイ
                          ブリッド型と言える li4 形式を追加。 出力サイズの少な
                          いほうを，それぞれ採用し組み合わせたもの。文字・一致
                          長については lh5 の，一致位置については lh3 のものが
                          使われている。 書庫サイズは最速となった 32K を採用。
                          ちなみに，これを超えると一致位置の出力量が飛躍的に増
                          大する。 この辺りが，LHA で lh5 系の出力形式が採られ
                          た理由と思われるが， 32K では，こちら (li4) のほうが
                          有利なので問題なし。
                         (パッチレベルが 100 を超えたので 2.40e に変更)
May.28,2006             ・lh3/li4 での一致位置の符号化について， 符号長が 4 を
                          超えた場合の処理を追加し忘れていたバグを修正。
                        ・li1〜li3 形式を削除し，li4 を lx1 に変更。これに伴い
                          "-jmx" スイッチについても修正。
                        ・ヘッダへのファイル名書き込み時の長さチェックの改善を
                          行い "-o" スイッチで指定された互換モードに従うように
                          した。
                        ・LHA OS/2  の新属性ヘッダ 0x7F が正常に読み込めていな
                          かったバグを修正。
May.31,2006             ・h0/h1 形式へのヘッダ書き込み時に，ファイル名の長さが
                          制限を超えていた場合にエラーを返すようにした。5.3 の
                          修正と異なり， こちらは LHarc/LHA がバッファ溢れを起
                          こす可能性のあるパターン。
Jun. 1,2006             ・lh1 について，LHarc を継承した LHx Ver 2.02 のアルゴ
                          リズムを採用していたため，一部のファイルについて正常
                          に圧縮が行えなかったバグを修正 (LHA Ver 2.11b のアル
                          ゴリズムを採用)。 ちなみに，LHA OS/2 2.08 や LHa for
                          UNIX 1.14i も  2.02 のソースを流用しているので，同様
                          の問題を抱えている可能性大。 jLHA 系は新たに書き起こ
                          されていて，LHA のバグ修正版相当なのでセーフのはず。
                          このバグは，遭遇率が相当低いらしく，最近初めて遭遇し
                          て気付いたのが実情。LHA 以降のソースなんてチェックし
                          ていませんでしたしねぇ…。履歴では『圧縮ルーチン』の
                          一言で済まされているので，何の修正か判別不能だし。
                          (LHA の) ドキュメントを見る限りでは，LHx Ver 2.02e，
                          LHa Ver 2.05，2.06  辺りで圧縮関連の修正が行われてい
                          るが，どの次点で修正されたのかは不明。
Jun. 3,2006             ・lx1 形式について， 基本中間バッファを 16K とすること
                          で得手・不得手の差を抑えた。これに伴い，"-je" スイッ
                          チを 65536 まで指定可能なように変更。 BMP のような相
                          性の良いファイルでは 64K としたほうが有利。
Jun. 4,2006             ・一致位置の出力に関して，lh3/lh5/無圧縮…の形式を切り
                          替えて出力するようにすることで，通常のファイルについ
                          ても lh5 相当の圧縮サイズを確保するようにした。
                          lx1 (li4) の結果は以下のとおり：

                                VMWare55.BMP                     9,437,238
                        unlha32         lh6 (lhx15)     4.136    4,796,986
                        unlha32         lx1             3.895    4,666,864

                                beside_demo_s.mpg               11,704,324
                        unlha32         lh6             6.519   10,803,239
                        unlha32         lx1             6.219   10,802,776

                         (2.40.5.8 (2.40.4.108); β版公開)
Jun. 5,2006  Ver 2.40f  ・"-jsp" スイッチを拡張し， Unicode 制御文字を不正とし
                          て扱えるようにした。
                        ・LZSS での遅延処理条件の調整を行った。
Jun. 6,2006             ・Win XP/2000 等での WIN32 Unicode 版 API ロード時の予
                          期しないエラーが発生した場合に表示していたデバッグ用
                          メッセージボックスを削除。 自動的に Win9X 用のダミー
                          API (必要な処理を施した上で  ANSI 版 API を呼び出す)
                          を呼び出す点を含めて，メッセージの非表示以外に変更は
                          なし。この処理が発生するような状況となると，そもそも
                          Win 自体が正常に動作していない可能性が高いので，単純
                          に DLL  の初期化エラーで終了してもいいような気がしな
                          いでも…。
                        ・メソッドにより効果が異なることから，2.40.6.10 での遅
                          延処理条件を元に戻した。やるとすれば，メソッド毎のコ
                          スト計算を行うようにした上で， encode() レベルで異な
                          るルーチンとする必要あり。 (細かくなればなるほど，速
                          度的に不利となるので，専用スイッチにより大元から別
                          ルーチンとしておけば既存アプリへの影響を避けられる)
                         (2.40.6.12 (2.40.5.112); β版公開)
Jun. 8,2006  Ver 2.40g  ・Unicode 版 API を使用した場合に， レスポンスファイル
                          を読めないことがあったバグを修正。
Jun.10,2006              (2.40.7.13 (2.40.6.113); β版公開)
Jun.12,2006  Ver 2.40h  ・ログ出力の際にはファイル名の制御文字を取り除くように
                          した。
Jun.17,2006              (2.40.8.14 (2.40.7.114); β版公開)
Jun.21,2006  Ver 2.40i  ・圧縮時のフルパス名取得時に不正パスと判断されたにも拘
                          わらず，そのまま共有チェックに回ってしまっていたバグ
                          を修正。
                        ・圧縮時のスキップログ出力について，簡易出力の場合に常
                          に共有エラーとして出力されてしまっていたバグを修正。
Jun.22,2006             ・NT 環境以外の場合に lpCharPrevW の初期化が行われてい
                          なかったバグを修正。
Jun.25,2006             ・表面化していなかった (そのような条件で呼び出されるこ
                          とがない) ものの，Mylstrcpyn2() がバッファ溢れを起こ
                          す可能性のあったバグを修正。
                         (2.40.9.18 (2.40.8.118); β版公開)
Jun.26,2006  Ver 2.40j  ・wsprintfW() を使用していた箇所が残っていたため， Win
                          9X 等で  UnlhaCheckArchiveW() が動作しなかったバグを
                          修正。
Jun.27,2006              (2.40.10.19 (2.40.9.119); β版公開)
Jul. 4,2006  Ver 2.40k  ・Ver 2.02a 以降において，'L' 命令等によるリスト出力で
                          書庫のタイムスタンプが  0 表示  (1601-01-01 00:00:00
                          UTC をローカル時間へ変換したもの) されてしまっていた
                          バグを修正。
Jul. 7,2006             ・入れ子チェックの改善を行い，ヘッダの検索と先頭ヘッダ
                          の読み込みを行った上で判断するようにした。これに伴っ
                          て，以前チェックルーチンを組んだ頃と構造が一部異なっ
                          ている BGA 書庫については， 双方に対応可能となるまで
                          チェックルーチンを削除。
Jul. 8,2006              (2.40.11.21 (2.40.10.121); β版公開)
Jul.12,2006  Ver 2.50   ・Unicode API でのレスポンスファイル読み込みについて，
                          BOM を認識するようにした。 存在しない場合は UTF-16LE
                          (既定値) で扱う。これに伴い， "-gl" スイッチによるロ
                          グ出力の際に BOM が出力される。
Jul.15,2006              (2.50.0.1; 正式版公開)
Jul.27,2006  Ver 2.51   ・"--"  スイッチを拡張し LHA と同様 "--[0|1|2]" の指定
                          を行えるように改善した。また，スイッチ文字の無効化の
                          みを指定する "--3" を追加。
                          なお，LHA においては，スイッチ文字無効化を行った場合
                          でも， 依然として '/' がスイッチ文字として機能するの
                          で注意が必要。
Jul.29,2006             ・Unlha() 等において，バッファとサイズ指定の整合性がと
                          れていないなどの理由でバッファ溢れを起こした場合に，
                          ソフトによっては処理が抜けてしまうことのあったバグを
                          修正。
                         (2.51.0.2; β版公開)
Jul.30,2006  Ver 2.51a  ・"-jo"，"-job" スイッチについて， (2 秒単位でなく) 秒
                          単位で指定できるように改善した。確か wDayOfWeek の整
                          合性が取れていないと NT 4.0 SP3/4 でパラメータエラー
                          になってしまう関係で 2 秒単位に甘んじて DosDateTime-
                          ToFileTime() を使っていた覚えが…。 が，もはや時効で
                          しょう。 ということで，wDayOfWeek の設定を行わないで
                          SystemTimeToFileTime() を使っている  (SDK では当該メ
                          ンバは無視と記述) ので，もし NT 4.0 SP3/4 でスイッチ
                          が正常に機能しなかったら，諦めてちょ。大昔の版の箇所
                          でも同様のネタについて書いてあるけど，Win32s 1.25 で
                          すら正常に動作する部分なので，当該 OS が悪い…という
                          ことで。(笑)
                        ・↑について，『使えない』で突き放してしまうのも何なの
                          で， SystemTimeToFileTime() がエラーを返してきた場合
                          には，従来どおり DosDateTimeToFileTime()  を使用する
                          ようにした。
Aug. 2,2006             ・UnlhaGetOriginalSize() 等において，サイズが 4GB 以上
                          であった場合に  UnlhaGetLastError() が ERROR_TOO_BIG
                          を返すように改善。
Aug. 3,2006              (2.51.1.5; 正式版公開)
Aug. 4,2006  Ver 2.51b  ・MySetFilePointer() において，lpToMoveHigh の返却値が
                          おかしかったバグを修正。返却値を使用しないことから，
                          全く表面化していなかったのが敗因。
Aug. 8,2006             ・Ver 2.39 以降 "-gy" スイッチが正常に機能していなかっ
                          たバグを修正。
Aug.11,2006             ・Ver 2.39 以降，h1 形式書庫を作成するとパス名にファイ
                          ル名の含まれてしまうことのあったバグを修正。
                        ・Ver 2.39 以降，NT 系以外の環境で WCharToCharN() にお
                          いて一般保護エラーとなる可能性のあったバグを修正 (今
                          のところ，遭遇・報告例は無し)。
                         (2.51.2.9; 正式版公開)
Sep.25,2006  Ver 2.52   ・CVE-2006-4335 の脆弱性に対応。ただし，パッチで示され
                          ている  tablebits 等の破壊・改竄の対策コードについて
                          は現時点では適用せずに様子見。
Sep.26,2006             ・CVE-2006-4337 の脆弱性に対応。ただし，LHA のオリジナ
                          ルコードを受け継いだソースを使っているものでは
                          read_pt_len() の修正は必要ない (gzip は lh5 系に最適
                          化されている点が仇となっている) 筈なので，read_c_len
                          () のみの修正となっている。
                        ・CVE-2006-4338 の脆弱性に対応。lh5 系以外の展開ルーチ
                          ンについては，とりあえず様子見。
                          展開速度重視の諸兄には申し訳ないが，今回の一連の修正
                          により，展開速度は相当落ちている筈。 特に decode_c()
                          の処理大幅増は致命的。
Sep.27,2006             ・make_table() でのバッファサイズチェックの改善。next-
                          code に対するチェックは ARJ のもので大丈夫だと思われ
                          るが，一応 gzip() の修正コードと同様，条件文の双方の
                          処理でチェックが行われるようにした。
                          ちなみに， gzip のパッチは，実際の展開テストを全く経
                          ていないも同然と思われる。実際に，その通り変更してみ
                          れば一目瞭然だが，多くのファイルが展開できなくなって
                          しまうもので，『単に破壊が起きない (だけの) コードに
                          してみました』というだけのものである。
                        ・'T' 命令の際に  CRC エラーのメッセージボックスを表示
                          しないように改善した。
                        ・各 SFX についても，今回の脆弱性に対応 (ただし， Dos-
                          SFX を除く)。
Sep.30,2006              (2.52.0.6; β版公開)
Oct. 4,2006  Ver 2.52a  ・Win32s  の場合にローカル時間との変換が正常に行われな
                          いことがあったバグを修正。環境変数 TZ の設定の上手く
                          反映されないことが，ままあったことから，自前で TZ を
                          読んで TIME_ZONE_INFORMATION を設定した上で， その設
                          定を使って変換を行うようにした (要は全て自前で変換を
                          行うようにした)。
                          UNLHA32.DLL が認識する TZ の定義書式は以下のとおり：

                            set TZ=<TZS>[<OFF1>[<TZD>[,<SM>,<SW>,<SD>,<ST>,
                                       <EM>,<EW>,<ED>,<ET>,<OFF2>]]]

                                <TZS>  : 標準時名。最大 31 文字まで
                                <OFF1> : UTC との時差。書式は以下のとおり：

                                               [+|-]<時>[:<分>[:<秒>]]

                                         秒は指定可能となっているものの， 現在
                                         の仕様ではバイアス値 (分単位)  に変換
                                         されるため，無視される。
                                <TZD>  : 夏時間名。最大 31 文字まで
                                <SM>   : 夏時間への切り替え月。1〜12 で指定。
                                <SW>   : 切り替えを行う週。意味は次のとおり：

                                               0    : <SD> で直接指定
                                               1〜4 : 第 1 週〜第 4 週
                                               -1   : 最後の週 (か第 5 週)

                                         -2〜-4 は指定できないので注意。
                                <SD>   : 切り替えを行う曜日。0 (日曜) 〜 6 (土
                                         曜) で指定。 <SW> が 0 の場合は当該月
                                         の何日目かを直接指定。
                                <ST>   : 切り替えを行う時間を秒単位で指定。
                                <EM>   : 標準時間への切り替え月。
                                <EW>   : 切り替えを行う週。
                                <ED>   : 切り替えを行う曜日。
                                <ET>   : 切り替えを行う時間。
                                <OFF2> : 標準時と夏時間の時刻差を秒単位で指定
                                         する。1 時間差であれば 3600。
Oct. 7,2006              (2.52.1.7; β版公開)
Oct.12,2006  Ver 2.52b  ・正式版としてコンパイル
Oct.14,2006              (2.52.2.7; 正式版公開)
Oct.14,2006  Ver 2.53   ・h0 ヘッダでのファイル名書き込み時には， エラー等とし
                          ないで例外的に文字数の丸め込みを行った上で書き込むよ
                          うに改善。
                        ・128KB までのヘッダ (あくまでもバッファ溢れのチェック
                          サイズとして) を扱えるように拡張。当然ながら，実際に
                          は h2 であれば 64KB 以上ではエラーとなる。
                        ・"-jc1"  が指定された場合等の破損ヘッダ読み飛ばしにつ
                          いて，最後のメンバーが破損しているとエラーを返してし
                          まうことのあったバグを修正 (本来なら，当該メンバーが
                          存在しないものとして正常終了値を返す必要がある)。
Oct.16,2006             ・バッファオーバフローやメンバーの隠蔽を意図したものと
                          疑われるヘッダを，破損ヘッダとして扱うようにした。
                        ・レジストリーによる強制指定スイッチについては，それま
                          での指定に拘わらず，常に既定値のスイッチ文字を認識す
                          るように改善。
Oct.18,2006             ・たかだか 4KB を超えた程度のヘッダを扱えない  (従って
                          書庫に対する検疫が行われない) 対策ソフトの存在が確認
                          できたので，4KB を超えるヘッダを全て破損ヘッダ扱いと
                          するようにした。 まともな書庫で 4KB を超えるものは存
                          在しないはずなので，問題が発生することはない…と思い
                          たい。(^^;)
                          Exploit LHA 等の検閲を行う McAfee 系の対策ソフト等で
                          も， ヘッダのサイズについては考慮しない (h1 形式等で
                          は，そもそも仕様としては制限なし) ことから，実際に一
                          部のソフトに対しては攻略が可能。(泣)  なので，無条件
                          に 4KB で切っている。
Oct.19,2006             ・WinSFX32(+M) についても 4KB を超えた場合には書庫とし
                          て扱わないようにした。 ファイル名については UNLHA32.
                          と異なり，常に _MAX_PATH 文字での丸めが行われる。
                         (2.53.0.7; β版公開)
Oct.25,2006  Ver 2.53a  ・LMLZH32.DLL とソースを完全共有化。単に条件付きコンパ
                          イルが行われるだけで，UNLHA32.DLL には一切変更が加え
                          られていない。
Oct.28,2006             ・正式版としてコンパイル。
                         (2.53.1.9; 正式版公開)
Oct.30.2006  Ver 2.53b  ・Ver 2.53a で， "--" スイッチによるスイッチ文字等の変
                          更が利かなくなってしまうことのあったバグを修正。最後
                          のパラメータの段階でスイッチ文字のクリアが行われてし
                          まっていたのが原因。
                         (2.53.2.10; 正式版公開)
Dec. 1,2006  Ver 2.54   ・Ver 1.99c 以降において， "-z" スイッチ及び "-jtz" ス
                          イッチでの拡張子指定が正常に機能していなかったバグを
                          修正。
                         (2.54.0.1; β版公開)
Dec. 7,2006  Ver 2.54a  ・WinSFX32M で関連付け設定のアイコン ID を指定できるよ
                          うにした。指定したプログラムのリソースが使われる点に
                          変わりはないので，注意。
                        ・WinSFX32M での関連付け設定について， $AskRegist が指
                          定されている場合には，一括して設定を行うかどうか問い
                          合わせるようにした。
Dec.22,2006              (2.54.1.3; 正式版公開)
Feb.19,2007  Ver 2.55   ・メモリマップドファイルを使用している場合に，まれに一
                          般保護エラーの発生してしまうことがあったバグを修正し
                          ました。
Feb.23,2007              (2.55.0.1; β版公開)
Mar.10,2007  Ver 2.55a  ・正式版としてコンパイル。
                         (2.55.1.2; 正式版公開)
Mar.22,2007  Ver 2.55b  ・状況表示ダイアログの『中止』ボタンで処理を中止した際
                          に，プログラムの抜けてしまうことがあったバグを修正。
                          システムが行っているものを含めたサブクラス化が影響し
                          ているのか，忘れた頃に (対応アプリ側へ戻ってから) 存
                          在しないサブクラス化ルーチンへ飛んでしまうのが原因ら
                          しいので，ダイアログ外で中止処理を行うようにした。
                         (2.55.2.3; 正式版公開)
May. 8,2007  Ver 2.56   ・Ver 1.95 以降において，UnlhaCompressMem() API を使用
                          して作成されたメンバーに正常なパス情報が記録されてい
                          なかったバグを修正。
May.12,2007              (2.56.0.1; β版公開)
Mar.27,2007  Ver 2.56a  ・正式版としてコンパイル。
                         (2.56.1.1; 正式版公開)
Jul. 7,2007  Ver 2.57   ・脆弱性利用を意図した長大な名前  (と言っても最大  255
                          文字) をもつ h0 形式ヘッダについて，破損ヘッダ扱いと
                          していなかったため，ファイル改竄 (中身すり替え) が可
                          能となってしまっていた脆弱性に対応  (最大 200 バイト
                          弱までのサイズであるものの，BAT やアセンブラで記述さ
                          れた COM ファイルであれば， 攻撃コードとして使用が可
                          能となる)。
                        ・WinSFX(M) について，メンバー名取得時にバッファオーバ
                          フローの発生する可能性があった脆弱性に対応。
                        ・DosSFX について， メンバー名取得時にバッファオーバフ
                          ローの発生する可能性があった脆弱性に対応。 CVE-2006-
                          4335 方面については， ルーチン構成が異なることから，
                          少なくとも手元のサンプル数点では問題が発生しないこと
                          から，引き続き様子見。
                         (2.57.0.3; β版公開)
Jul.21,2007  Ver 2.57a  ・正式版としてコンパイル。
                         (2.57.1.3; 正式版公開)
Jul.28,2007  Ver 2.58   ・dir コマンド等，表示絡みだけで問題が発生しているよう
                          なので，time_t，ftime への変換について，Win2K 以降の
                          場合には 2099 年での丸めを行わないようにした。
                        ・time_t との相互変換について， 内部的には 64 ビット値
                          を使うようにした。処理系やプログラムによって扱いの異
                          なる可能性があることから，1752/09/14 00:00:00 を下限
                          として補正を行う。上限については，多くのパーペチュア
                          ルカレンダーが上限としている  2399/12/31 23:59:59 で
                          補正を行う。Win2K 未満での上限は，従来どおり。
                          Win9X 等での下限については，要テスト。
Jul.28,2007  Ver 2.60   ・整合性を考慮して， UnlhaGetArcCreateTime() 等の  API
                          を追加。これに伴いバージョンを 2.60 に更新。
Jul.29,2007             ・FILETIME が基本となっている UNLHA32.DLL においては，
                          あまり意味は無いのかもしれないが， 64 ビット  time_t
                          で情報を得る UnlhaGetWriteTime64() 等の API を追加し
                          た。補正範囲は Ver 2.58 での変更点と同じで，1752/09/
                          14 00:00:00〜2099/12/31 (2399/12/31) 23:59:59。Win2K
                          以降の NT 系では 2399 年まで，それ以外は 2099 年まで
                          となる。
                        ・一部自動的に行っていたタイムスタンプ補正についても，
                          スイッチ指定に従って補正を行うようにした。
                        ・内部変数等を含めて，全ての time_t データを 64 ビット
                          に拡張した (当然ながら， 32 ビット time_t で値を返す
                          API の返却値等は除く)。
Jul.31,2007             ・格納対象ファイルの排他処理チェックが失敗した場合に，
                          原因に拘わらず  ERROR_SHARING を返してしまっていた点
                          を改善した。
Aug. 1,2007             ・API を実行した結果エラーが返ってきたにも拘わらず，直
                          後の UnlhaGetLastError() が ERROR_SUCCESS を返してし
                          まうことのあったバグを修正した。
                        ・ヘッダのタイムスタンプ情報を複数の形式で保持していた
                          ものを，FILETIME 形式一本に整理した。 混乱の元となり
                          かねないので。
Aug. 2,2007             ・LHA for UNIX  で作成された書庫に含まれることのあるシ
                          ンボリックリンクメンバーを無視するようにした。Win 系
                          では，ショートカットを作成することで代用可能だが，別
                          物という感が否めないので…。
                        ・新属性ヘッダ (ID 0xFF)  を出力する場合の出力位置を改
                          善した (ヘッダ読み込み時に FILETIME ヘッダの情報が無
                          効 (上書き) となってしまう)。
Aug. 4,2007              (2.60.0.11; β版公開)
Aug.23,2007  Ver 2.60a  ・Ver 2.60 において， h0 / h1 形式書庫の基本ヘッダ書込
                          の際に UTC  のままタイムスタンプを書き込んでしまって
                          いたバグを修正。
                        ・WinSFX32(M) にマニフェストを付加。実行レベルは，Win-
                          SFX32 が asInvoker， WinSFX32M が requireAdministra-
                          tor となっている。 これに伴い WinSFX32  については，
                          Vista や XP SP3 において特定フォルダへの展開が行えな
                          くなるので，注意が必要となる。
Aug.24,2007             ・WinSFX32M について，インストーラとして使われないと想
                          定される ($ ファイルが存在しない) 場合には， asInvo-
                          ker を指定するようにした。
Aug.25,2007              (2.60.1.14; β版公開)
Aug.28,2007  Ver 2.60b  ・"-i" スイッチに， UNLHA32.DLL 既定の変換を行わせるた
                          めの "-i4" を追加。
Aug.31,2007             ・WinSFX32(M) について，コードの整理を行った。これに伴
                          い WinSFX32  でも 4GB 超のファイルを扱えるようになっ
                          ている。
Sep. 1,2007              (2.60.2.16; β版公開)
Sep. 3,2007  Ver 2.60c  ・コード部分の簡易破損チェックを行うようにした。ファイ
                          ル破損による時限爆弾的誤動作防止用。なのでコード部分
                          のみとなっている。
                          なお，チェックが行われるのは正式版のみ。(笑)
Sep. 6,2007             ・WinSFX32 について， lh0 用展開ルーチン (copyfile) を
                          4GB 対応版とし忘れていたバグを修正。
                        ・WinSFX32(M) のコード整理の続き。 副産物として，FILE-
                          TIME ヘッダの情報が  time_t 等に丸められることなく扱
                          われる等の改善が行われている。(^^;)
Sep. 7,2007             ・(UNLHA32.DLL が使用する)既定フォントの取得方法を変更。
Sep. 8,2007             ・WinSFX32(M) についても，フォントの取得方法を変更。
                        ・WinSFX32(M) について，さらにコードを整理。
Sep.15,2007             ・UNLHA32.DLL では問題が発生していなかったものの，念の
                          ため Win32s 環境の場合には  GetStockObject() へ SYS-
                          TEM_FONT を渡すようにした。
Sep.16,2007             ・↑の処理を WinSFX32(M) にも適用した。
                         (2.60.3.24; β版公開)
Sep.19,2007  Ver 2.60d  ・破損チェックの CRC 計算方法を変更。
Sep.25,2007             ・API のパラメータチェックを少々強化。
Sep.26,2007             ・UnlhaQueryFunctionList() について，Ver 2.60 で追加さ
                          れた API への対応をし忘れていたバグを修正。
Sep.27,2007             ・Win9X/Win32s 上でデバッグ出力を行った際に， 一般保護
                          エラーとなってしまうことのあったバグを修正。
                        ・UTF-16 のレスポンスファイル読込について，fgetwc() 相
                          当の関数を使用するように変更。
                        ・2.60.4.26 の変更について，Win9X 上でグローバルメモ
                          リーに対するチェックが必ず失敗していたバグを修正 (NT
                          系専用のコードとなっていた)。
Sep.29,2007              (2.60.4.30; 正式版公開)
Sep.30,2007  Ver 2.60e  ・Ver 2.60b 以降において，WinSFX32M を作成した場合に不
                          正な書庫が作成されてしまうことのあったバグを修正。
                          (直接コード書き換え部分で SFX 変更前の箇所が残ってし
                          まっていたのが原因。)
                         (2.60.5.31; 正式版公開)
Sep.30,2007  Ver 2.61   ・WinSFX32(M) について，エラーが発生した際に解放済み領
                          域を使用しようとして一般保護エラーとなってしまうこと
                          のあったバグを修正。
Oct.10,2007             ・Win2K 以降の場合には既定コードページとして CP_THREAD
                          _ACP を使用するように改善。
Oct.12,2007             ・ウィンドウ関係について，基本的に Unicode 版 API を使
                          用するように改善。
Oct.13,2007             ・ここまでくると大差がないことから，Unicode 版アプリで
                          コンパイルするように変更。
Oct.14,2007             ・Unicode 版 API  を直接呼び出してしまっていた箇所につ
                          いて修正。
Oct.15,2007             ・警告 Level 4 で警告が出ないようにソースを改善。
                        ・2.61.0.3 以降で追加された代替 Unicode Win32 API にお
                          いて，ヌルポインタを想定していない MyFree() を使用し
                          て解放を行っている箇所のあったバグを修正 (当該関数の
                          ヌルポインタチェックに引っかかる可能性があった)。
                        ・MyFree() について， ヌルポインタ解放警告メッセージを
                          β版のみで出力するように改善した。
                        ・コードページヘッダに  CP_UTF8 が記録されている場合に
                          は，Unicode ファイル名ヘッダ等を記録しないように改善
                          した。 仕様上の話であって，実際に CP_UTF8 の使われる
                          可能性の有無は考慮していない。(^^;;
                        ・MultiByteCharToWideChar() 等について，コードによって
                          指定できないフラグが存在する点に対応した。
Oct.21,2007             ・デバッグ出力関係を整理。レベル分けとスイッチ方面の出
                          力追加を行ったことで，23K ほど肥大化してしまったのは
                          秘密。(笑) 正式版では全て 0 になるのが不幸中の幸い。
                          今後も，継続して対象が追加される。
                         (2.61.0.11; β版公開)
Oct.22,2007  Ver 2.61a  ・DLL をロードしたモジュールのバージョン情報をデバッグ
                          出力するようにした。
                        ・"-p0" の指定が無効となってしまうことのあったバグを修
                          正。
Oct.23,2007             ・デバッグ出力関係の継続作業。
Oct.25,2007             ・いつの頃からか，"-jse2" の指定が無効となってしまって
                          いたバグを修正。
                        ・"-jts" と指定した場合に，既定の 8 文字ではなくチェッ
                          ク無しとなってしまっていたバグを修正。
                        ・デバッグ出力関係の継続作業。
Oct.29,2007             ・ANSI 版 API を使用している場合でも，BOM 付きであれば
                          Unicode 文字のレスポンスファイルを受け付けるように改
                          善した。
                        ・Unicode ヘッダの代わりに  CP_UTF8 でヘッダを記録する
                          "-jtu3", "-jtu4" のスイッチを追加。
Oct.30,2007             ・CP_UTF8 を使用できない環境にもかかわらず "-jtl65001"
                          等の指定を行えてしまっていたバグを修正。"-jtu4" 等に
                          ついては， 使用できない環境では "-jtu2" 等の指定と見
                          なされる。
Oct.30,2007  Ver 2.62   ・試験的に  UnlhaSetUnicodeMode() API を追加。 CP_UTF8
                          に未対応，又は制限の存在する  Win95 等の環境について
                          は ERROR_NOT_SUPPORT エラーとなる。 レスポンスファイ
                          ルについては， BOM が付加されていない場合は UTF-8 と
                          見なされる。従って ANSI での記述は行えないので注意が
                          必要。これに伴いバージョンを Ver 2.62 へ更新。
Oct.31,2007             ・Unlha() 等の  API に規定数を超えたパラメータ数のコマ
                          ンド文字列が渡されるとヒープオーバーフローを起こして
                          しまっていた大バグの脆弱性を修正。ヒープ上にオブジェ
                          クト・例外ハンドラといった関数ポインタは存在しないも
                          のの，ヒープ構造の辻褄合わせを行えば，データポインタ
                          改竄を利用しての任意コード実行は不可能でないと思われ
                          るが， そもそも任意コードを実行して UNLHA32.DLL を呼
                          び出す必要があることから，利用する価値は低いと思われ
                          る。それよりも，レジストリー情報を利用して全ての対応
                          アプリに対して，実行妨害・DOS 攻撃 (クラッシュ) 等を
                          行える点のほうが影響は大。
                        ・UNLHA32.H でのプロトタイプ宣言について，const 修飾の
                          有無を見直し。また，付加し忘れていた箇所についても修
                          正。
Nov. 4,2007              (2.62.0.23; β版公開)
Nov. 5,2007  Ver 2.62a  ・UnlhaOpenArchive() 等において， 省略値スイッチ指定等
                          が重複して処理されてしまっていたバグを修正。
                        ・動作妨害や脆弱性利用等を目的とした用途として使用が可
                          能だったことから，上記の省略値スイッチ指定等の機能を
                          削除。海外ソフトの矯正等は行えなくなるが，昨今のソフ
                          トであれば必要ないはず…。
Nov.10,2007              (2.62.1.25; 正式版公開)
Nov.12,2007  Ver 2.62b  ・WinSFXM，WinSFX32(M) について， コマンド文字列方面の
                          脆弱性に対応。
                        ・一部のリソースが  2.62.0.25 となってしまっていたので
                          修正。
Nov.13,2007              (2.62.2.27; 正式版公開)
Nov.16,2007  Ver 2.63   ・setarg() について，CommandLineToArgvW() API を使用す
                          るように仕様変更を行うつもりだったが，変にエスケープ
                          シーケンス処理を行うので， DmCommandLineToArgvW() を
                          常に使用するようにした。(泣)
Nov.20,2007             ・DmCommandLineToArgvW() について， 最後に余計なゴミパ
                          ラメータが付加されてしまうバグを修正。
                        ・コードページヘッダに従ってコメントを書き込むように改
                          善した。また，コメントファイルについて，API のモード
                          に従って読み込みを行うようにし，ダイアログについても
                          一旦 Unicode で取得するようにした。
Nov.26,2007             ・h1 ヘッダ読込について， ルーチンとしてはサイズ制限が
                          存在しないようにした (固定バッファの 7-Zip 型)。
Nov.27,2007             ・引き続き h2/3 ヘッダ読込についても，サイズ制限のない
                          ルーチンとした。当然ながら全体サイズを超える構造であ
                          れば，不正書庫として扱われる。
                        ・ヘッダ読込が HDR_EXPLOIT_SIZE で失敗した際には，以降
                          の有効ヘッダを検索することなく，即座に中止するように
                          した。
                        ・拡張ヘッダのサイズ情報が最小値未満となっているにもか
                          かわらずエラーとしていなかったバグを修正 (ゴミデータ
                          をヘッダとして扱ってしまう)。 最大値以上のバッファサ
                          イズであることから，オーバーフローの類は発生しない。
                        ・EXPLOIT チェックを無効としている場合には h1 ヘッダで
                          の全体サイズチェックを行わないようにした。
                        ・ヘッダの冒頭が 4 (sizeof(DWORD)) 以外となっている h3
                          ヘッダを扱わないようにした。
Dec. 5,2007             ・Win95 であるにも拘わらず  Win98 以降と同列に扱われる
                          可能性のあった箇所をバグ修正  (エラー処理で Win95 用
                          の処理へ切り替わっていたことから，表面化していなかっ
                          た模様)。
Dec.11,2007             ・グローバル変数の整理。
Dec.13,2007             ・設定ダイアログのボタンコントロールをオートボタン系に
                          変更することで，無駄な変数を使用しないようにした。
                        ・古いアプリで不具合が多々発生していることから， "-o0"
                          と "-o3" の意味を交代した。
Dec.15,2007             ・regpat() を使用するように処理変更を行うことで， reg-
                          fpat() 系のルーチンを削除。
Dec.17,2007             ・extheader() と extheader2() を統合。
Dec.25,2007             ・必要なヘッダ CRC  や名前項目が存在しないヘッダについ
                          て警告ログを出力するようにした。そのような書庫を作成
                          してしまうツールがあり，多々配布も行われていることか
                          ら， "-jsn" スイッチが指定された場合のみエラー扱いさ
                          れる  (文字列長不一致と同じ扱い)。 これに伴いエラー
                          コードを 2 つ追加。
Dec.28,2007             ・文字列処理関数のパラメータチェックを強化 (当該箇所で
                          はなく関数の入り口でチェックするように変更。保険)。
                        ・グローバル変数の整理。
Jan. 9,2008             ・(UNLHA32.DLL の)  ANSI 版 API を使用している場合に，
                          ログの桁揃えがずれてしまうことのあったバグを修正。
                          Unicode 版 API を使用するアプリが， 過去に行われてい
                          たようにログから直接情報を取得することは皆無と考えら
                          れることから，Unicode 版 API の場合でも，あえて Get-
                          StringTypeEx() API を使用して桁合わせを行っている。
                          固定位置と長さによる文字列取得は行えないので注意。
                          GetStringTypeEx() 等で返される値と，アプリ側で行われ
                          る描画の (桁単位での) 結果が一致しない場合が多々ある
                          ことから，『桁が揃う』という前提は排除すること。
Jan.22,2008             ・却ってパフォーマンス低下の嫌いがあることから， Vista
                          世代や x64 環境では，明示的な FlushViewOfFile() は行
                          わないようにした。MFNoFlush による強制設定は引き続き
                          可能。
Jan.24,2008             ・WinSFX32M を  Unicode/ANSI 両対応版 (以降，WinSFX32U
                          と表記) へ更新。!，$ 両ファイルは BOM を付加すること
                          で UTF-16LE による記述も可能。互換性の関係上，SFX 設
                          定ダイアログによるタイトル等については ANSI で記録さ
                          れる。Unicode が必要な場合は $ ファイルを使用。
Jan.25,2008             ・WinSFX32U の小修正 (エラー時の後処理改善)。
Jan.26,2008             ・WinSFX32U について，All Users 配下のメニューへの登録
                          を可能とした。Win の仕様上，『管理者権限で実行』では
                          なく，管理者アカウントで実行しない限りローカル側に登
                          録されるので注意。
                        ・↑に伴い，DELREG.EXE を Ver 0.20 へ更新。
Jan.29,2008             ・WinSFX32U の修正 (Win32s  でのファイルリスト登録不具
                          合等)。
                        ・Vista 以降でのプログレスバー描画頻度を下げた。 (これ
                          までの感覚どおり PBM_SETPOS を行うと，もれなくアニメ
                          を伴ってしまい， そのアニメが終了するまで一部の PBM_
                          SETPOS を受け付けなくなってしまうため。)
                        ・↑に伴って，Vista の場合に少々小細工をしてみた。
Jan.29,2008             ・殆ど効果がなかったので↑の小細工を削除。
Jan.30,2008             ・一部 Unicode 版 API のまま使用されていた箇所を修正。
                        ・WinSFX32U を Ver 3.0.0.15 へ更新 (Win32s での $sCopy
                          コマンド不具合等)。
                        ・WinSFX32U を認識できるようにした (SFX_WIN32_300_1 を
                          返す)。
                        ・WinSFX32U について，asInvoker の書き込み位置がおかし
                          くなっていたバグを修正 (マニフェストが正常に読み込め
                          なくなり実行不可となる)。
Jan.31,2008             ・'A'，'U'，'M' 命令の場合に "-gn1" スイッチが機能する
                          ようにした。
Feb. 1,2008             ・"-jp0" での進捗グラフを， 基本的に LHMelt と同様のサ
                          ブセット版プログレスバーへ変更することで，本体側コー
                          ドの一本化を行った。
                        ・Ver 2.60 以降について，不必要な Unicode パスヘッダを
                          付加してしまうことのあったバグを修正。
Feb. 2,2008              (2.63.0.35; β版公開)
Feb. 4.2008  Ver 2.63a  ・FlushViewOfFile() の実行間隔を 64MB 毎とすることで，
                          (一括) 書き込み時負荷の低下を図った。
Feb. 5,2008             ・新たなサイズでの CreateFileMappingA() が行われずに，
                          そのまま通常の入出力アクセスへ切り替わってしまうこと
                          のあったバグを修正 (主に Vista 等で発生。 が，当該環
                          境では，通常の入出力自体がメモリマップドファイルで行
                          われているかのような挙動を示すため，体感不可。反対に
                          言えば，わざわざ UNLHA32.DLL  側でメモリマップドファ
                          イルを使用する必要性がないことに。^^;)。
Feb. 6,2008             ・利便性を考慮して，設定ダイアログでのフラッシュ指定が
                          メモリマップドファイルにも適用されるようにした：

                                オフ：フラッシュタイミングをシステムに任せる。
                                      MFNoFlush == 2 に相当。 MFNoFlush での指
                                      定は (実質) 無視される。
                                オン：MFNoFlush での指定に従いフラッシュが行わ
                                      れる。

                                        0 : 毎回 (8MB 境界)。
                                        1 : 64MB 境界を越えたタイミング。

                          この仕様変更に伴い，通常はシステム任せのフラッシュが
                          行われることになる。搭載メモリーが少ない場合などス
                          ワップ等の負荷が高い場合には，オンとすることで多少の
                          軽減を図ることが可能 (Win XP 等であれば，Ver 2.63 ま
                          での通常行われる処理と同じ)。
                          ちなみに，上のほうで書いたように，Vista 世代では通常
                          の入出力自体がメモリマップドファイルによっているかの
                          ような挙動を示す。フラッシュタイミングは (システムが
                          行っているだけに) MFNoFlush == 2 に相当。 そのため，
                          扱うファイルのサイズが大きい場合には，実装メモリーが
                          少ない (1GB 未満) とシステムへの負荷が相当高くなる。
                          ↑の仕様が関連し， Memory Boost を使用している場合，
                          相当速いフラッシュメモリーが使われていないと，巨大
                          ファイルが相手の際には劇的に負荷が高まるので注意。
                        ・Vista でのプログレスバー表示について， トップ (右端)
                          位置への到達タイミングを簡易予測し先回りして描画を行
                          うことで， アニメーションによる影響 (バーの伸び遅延)
                          の緩和を図った。クラシックスタイル等で問題の生じる可
                          能性 (伸びが速すぎる) はあるが，この際無視。
Feb. 7,2008             ・設定ダイアログでのレジストリー保存指定について，必要
                          のない項目についてはレジストリーへの書き込みを行わな
                          いようにした。
                        ・空き容量チェックの既定値がオフとなってしまっていたバ
                          グを修正。
Feb. 9,2008              (2.63.1.41; β版公開)
Feb. 9,2008  Ver 2.63b  ・lh0/lh1 形式で格納された  lhd メンバーに対してファイ
                          ル名ヘッダ警告を行っていたバグを修正。
Feb.11,2008             ・WinSFX32U が NT 4.0 で動作しなかったバグを修正。
                        ・WinSFX32U のテロップ表示が乱れてしまうことのあったバ
                          グを修正。
                        ・Ver 2.63 以降， 'J' 命令での書庫連結が正常に行われて
                          いなかったバグを修正。
                         (2.63.2.45; β版公開)
Feb.13,2008  Ver 2.63c  ・"-gr" スイッチを使用してのメンバー名変更が正常に行え
                          なくなっていたバグを修正。
Feb.16,2008              (2.63.3.46; β版公開)
Feb.20,2008  Ver 2.63d  ・UnlhaEnumMembersProc()  を使用しての圧縮 (格納) ファ
                          イル名指定が利かなくなってしまっていたバグを修正。
                        ・WinSFX32U でのショートカット作成について，Unicode で
                          の DDE コマンド実行が正常に行われず，Explorer が落ち
                          てしまうことのあったバグを修正 (SFX のダイアログが
                          ANSI で作成されてしまうことがあったため)。
Feb.23,2008              (2.63.4.48; β版公開)
Feb.25,2008  Ver 2.63e  ・Ver 2.53 以降で，UnlhaOpenArchive2() 等の API へ
                          "-jx" スイッチが渡された際に， NULL ポインタ使用で一
                          般保護エラーとなってしまっていたバグを修正。
Feb.27,2008             ・MyMoveFileExW() の MoveFileEx() API 代替ルーチンにつ
                          いて， 前処理の MyDeleteFileW() が FILE_NOT_FOUND と
                          なった場合に，そのままエラーを返して終了してしまう可
                          能性のあったバグを修正。
                        ・MyMoveFileExW() の MoveFileEx() API 代替ルーチンにつ
                          いて，MOVEFILE_REPLACE_EXISTING が指定されていない場
                          合に (無条件に) エラーを返してしまうことのあったバグ
                          を修正。
Mar. 1,2008              (2.63.5.51; β版公開)
Mar. 3,2008  Ver 2.63f  ・Ver 2.63 以降において，h0 形式ヘッダについて常にパス
                          を付加して扱ってしまっていたバグを修正。
                        ・安易に設定変更を行った結果正常に格納ファイルを扱えな
                          くなる事例が多いことから，設定ダイアログの『厳密な
                          ファイル名サーチ』項目を削除した。これに伴いレジスト
                          リー項目名も変更 (既設定による影響を排除するため)。
                         (2.63.6.53; β版公開)
Mar.15,2008  Ver 2.63g  ・Ver 2.63 以降において， ヘッダサイズ調整のダミーデー
                          タが付加されたヘッダで CRC  計算が正しく行われていな
                          かったバグを修正。
Mar.16,2008              (2.63.7.54; 正式版公開)
Mar.18,2008  Ver 2.63h  ・Ver 2.63 以降， 一部のソフトについて UnlhaFindFirstW
                          () 等による検索が行えなくなっていたバグを修正。
                         (2.63.8.55; 正式版公開)
Mar.25,2008  Ver 2.63i  ・WinSFX32U が英語モードで正常に動作しないことのあった
                          バグを修正。
Mar.29,2008             ・MyReadFile() について，ERROR_HANDLE_EOF を返すべきと
                          ころを  ERROR_INVALID_PARAMETER を返してしまうことの
                          あったバグを修正。
                        ・拡張ヘッダ内での HDR_EXPLOIT_SIZE については，即
                          ERROR_HDR_EXPLOIT エラーで処理を中止するようにした。
Mar.30,2008              (2.63.9.58; 正式版公開)
May.10,2008  Ver 2.64   ・WinSFX32(M) について，WH_CBT フック処理を改善。
                        ・コントロールに対しての位置調整処理について， GetSys-
                          temMetrics() を使ったものから ClientToScreen() を
                          使ったものへ変更した (Vista 等では従来の前提が通用し
                          ないため)。
May.11,2008              (2.64.0.2; β版公開)
May.26,2008  Ver 2.64a  ・正式版としてコンパイル。
                         (2.64.1.2; 正式版公開)
Jun.29,2008  Ver 2.64b  ・Ver 2.64 以降で，非インストーラモードの WinSFX32M 作
                          成に失敗していたバグを修正。
                         (2.64.2.3; 正式版公開)
Jul. 6,2008  Ver 2.64c  ・Ver 2.63 以降で， 設定ダイアログでのラジオボタンのグ
                          ループ分けが，  環境によっては上手く行われないことの
                          あったバグを修正。
                         (2.64.3.4; 正式版公開)
Oct.21,2008  Ver 2.65   ・ディレクトリーメンバーの格納を行う際に，当該ディレク
                          トリー上のファイル等の処理を全て終えた後でディレクト
                          リー自身の登録処理を行うようにすることで，ファイル等
                          が存在する場合にもディレクトリーのタイムスタンプが復
                          元されるように改善した。
                          ディレクトリーメンバー登録順の影響を受ける処理方法で
                          あることが大きな難点。登録順に寄らないならば，新規作
                          成が発生したディレクトリーのリストを登録しておき最後
                          に一括設定…といった感じの処理となるが，環境によって
                          はバカにならないメモリー消費と処理時間増大を招いてし
                          まうことから，とりあえずメモリーと時間が少なくて済む
                          お手軽方法で逃げてある。(^^;)
Oct.28,2008              (2.65.0.1; β版公開)
Nov.15,2008  Ver 2.65a  ・Ver 2.65 において，"-d" スイッチ等でディレクトリーを
                          格納する設定とした場合に，正しいパス情報でディレクト
                          リーメンバーが作成されなくなっていたバグを修正。
Nov.16,2008              (2.65.1.2; β版公開)
Nov.24,2008  Ver 2.65b  ・Ver 2.63a で行った  Vista 環境でのプログレスバー到達
                          予測の処理を削除。
                         (2.65.2.3; β版公開)
Nov.30,2008  Ver 2.65c  ・WinSFX32(U) において，展開先が相対ディレクトリーで指
                          定された場合に，環境によってはコマンド実行に失敗する
                          ことのあったバグを修正した。
                         (2.65.3.4; β版公開)
Dec.13,2008  Ver 2.65d  ・正式版としてコンパイル。
                         (2.65.4.4; 正式版公開)
Jul. 3,2009  Ver 2.66   ・必要のない一部のメッセージ用文字列を削除。
                        ・圧縮・展開時でのプログレスバー描画タイミングを変更。
May.27,2010             ・WinSFX32(U) のファイル入出力ルーチンについて，  直接
                          API を呼び出す方式から  UNLHA32.DLL のサブセット相当
                          のルーチンを呼び出す方法へ戻した。
May.30,2010              (2.66.0.3; β版公開)
Jun. 5,2010  Ver 2.66a  ・正式版としてコンパイル。
                         (2.66.1.3; 正式版公開)
Sep. 4,2010  Ver 2.67   ・コマンドライン文字列にサロゲートペアが含まれていると
                          正常に文字列を取得できなかったバグを修正。
                         (2.67.0.1; β版公開)
Sep.12,2010  Ver 2.67a  ・正式版としてコンパイル。
                         (2.67.1.2; 正式版公開)
