=======================================================================
               Jack32.dllversion 0.20 API 説明ファイル
                                                              木村 利靖
                                                       Toshinobu Kimura
=======================================================================

-----------------------------------------------------------------------
int WINAPI Jack( const HWND hWnd, LPCSTR pszCmdLine,
                 LPSTR pszOutput, const DWORD dwSize );
-----------------------------------------------------------------------
順序数  1
機能
    切り裂き／復元を行います。

引数
    hWnd    Jack32.dllを呼び出すアプリのウィンドウ・ハンドル。
            Jack32.dllは実行時にこのウィンドウに対して EnableWindow()を
            実行しウィンドウの動作を抑制します。ウィンドウが存在しないコ
            ンソールアプリの場合や，指定する必要のない場合は NULLを渡しま
            す。
    pszCmdLine  Jack32.dllに渡すコマンド文字列。
    pszOutput   無視します。
    dwSize      無視です。

戻り値
  正常終了の時          0
  エラーが発生した場合  0 以外の数（ エラー値 >= 0x8000 ）。

-----------------------------------------------------------------------
BOOL WINAPI JackCheckArchive( LPCSTR pszFileName, const int iMode );
-----------------------------------------------------------------------
順序数  11
機能
    指定ファイルが、サポートしている切り裂きファイルとして正しいかどうかを
    返します。

引数
    pszFileName チェックすべき切り裂きファイルのファイル名。
    iMode       無効です。適当な値を指定してください。

戻り値
    TRUE        正しい切り裂きファイルの時。
    FALSE       ファイルが不正の時。

-----------------------------------------------------------------------
BOOL WINAPI JackConfigDialog( const HWND hwnd, LPSTR pszOption,
                              const int iMode );
-----------------------------------------------------------------------
順序数  12
機能
    切り裂き／復元のオプション設定ダイアログを表示します。

引数
    hWnd        Jack32.dllを呼び出すアプリのウィンドウ・ハンドル。
    pszOption   無視します。
    iMode       無効です。適当な値を指定してください。

戻り値
    ERROR_ALREADY_RUNNING   Jack32.dllが既に実行中の時。
    TRUE            設定が成功した時。
    FALSE           設定されなかった時、または取消終了時。

その他
    設定は、レジストリの Software\ArchiverDll 以下に JACK32のセクションが
    作られ書き込まれます。

-----------------------------------------------------------------------
WORD WINAPI JackGetVersion();
-----------------------------------------------------------------------
順序数  2
機能
    Jack32.dllの現在のバージョンを返します。

戻り値
    現在のバージョン     20 -> Version 0.20
                        100 -> Version 1.00

-----------------------------------------------------------------------
BOOL WINAPI JackGetRunning();
-----------------------------------------------------------------------
順序数  10
機能
    現在 Jack32.dllが動作中か否かを得ます。

戻り値
    TRUE        実行中。
    FALSE       未実行（実行可能）。

-----------------------------------------------------------------------
int WINAPI JackGetFileCount( LPCSTR pszArcFile );
-----------------------------------------------------------------------
順序数  17
機能
    指定された切り裂きファイルに格納されているファイル数を得ます。

引数
    szArcFile   格納ファイル数を得たい切り裂きファイル名。

戻り値
    正常な切り裂きファイルであれば 1 を返します。
    エラーのときは -1 を返します。

-----------------------------------------------------------------------
BOOL WINAPI JackQueryFunctionList( const int iFunction );
-----------------------------------------------------------------------
順序数  18
機能
    指定された API が Jack32.dllで使用可能かどうかを得ます。
    Jack32.dllでは未実装の API が多いので、事前にチェックするようにして
    ください。

    JackRipper、JackCombine の各 API は Jack32.dll独自の APIのため、この
    APIでは対象としていません。

引数
    iFunction   APIを示す一意な数値。
                具体的な数値については Jack32.hを参照して下さい。

戻り値
    TRUE        使用可能。
    FALSE       使用不可、または iFunctionが無効な値。

-----------------------------------------------------------------------
HARC WINAPI JackOpenArchive( const HWND hWnd, LPCSTR pszFileName,
                             const DWORD dwMode );
-----------------------------------------------------------------------
順序数  21
機能
    指定ファイルが有効な切り裂きファイルかどうか調べ、有効であれば
    オープンし、一意の数値（ハンドル）を返します。
    以後の切り裂きファイルへのアクセスはこのハンドルでおこないます。
    アクセス終了時には、JackCloseArchive() を呼び出してください。

引数
    hWnd        無視します。
    pszFileName 切り裂きファイル名。
    dwMode      無効です。0 を指定してください。

戻り値
    指定の切り裂きファイルに対応したハンドル。
    エラー時は NULL を返します。

その他
    同時に複数のハンドルを利用可能( なはず )です。

-----------------------------------------------------------------------
int WINAPI JackCloseArchive( HARC harc );
-----------------------------------------------------------------------
順序数  22
機能
    JackOpenArchive() で割り付けたハンドルを解放します。
    Jack32.dllでは、DLLのアンロード時に自動的にハンドルを解放しません
    ので、アクセス終了時にはかならずこの APIを呼び出してください。

引数
    harc    JackOpenArchive() で返されたハンドル。

戻り値
    Jack32.dllでは常に 0 を返します。

-----------------------------------------------------------------------
int WINAPI JackFindFirst( HARC harc, LPCSTR pszWildName,
                          LPINDIVIDUALINFO pSubInfo );
-----------------------------------------------------------------------
順序数  23
機能
    復元時のファイル情報を得ます。

引数
    harc        JackOpenArchive() で返されたハンドル。
    pszWildName 無視します。
    pSubInfo    結果を返すための INDIVIDUALINFO型の構造体へのポインタ。
                結果を必要としない場合は NULLを指定してください。

戻り値
     0      正常終了。lpSubInfoで指定された構造体に復元ファイルの情報が
            セットされます。
    -1      ハンドルが無効。


-----------------------------------------------------------------------
int WINAPI JackFindNext( HARC harc, LPINDIVIDUALINFO pSubInfo );
-----------------------------------------------------------------------
順序数  24
機能
    Jack32.dllが対象とする切り裂きファイルからは、構造上ひとつのファイルへ
    しか復元され得ないので( 単純な話、切り裂き元はひとつのファイルです )、
    この APIは本来は無意味なのですが、他のアーカイバ DLLにあわせるために
    実装しています。

引数
    harc        無視します。
    pSubInfo    無視します。

戻り値
    Jack32.dllでは、検索終了の意味で常に -1 を返します。

-----------------------------------------------------------------------
DWORD WINAPI JackGetArcOriginalSize( HARC harc );
-----------------------------------------------------------------------
順序数  33
機能
    復元ファイルのサイズを取得します。

引数
    harc    JackOpenArchive() で返されたハンドル。

戻り値
    復元ファイルのサイズを返します。
    ハンドルが無効などのエラー時には -1 を返します。

-----------------------------------------------------------------------
DWORD WINAPI JackGetArcCompressedSize( HARC harc );
-----------------------------------------------------------------------
順序数  34
機能
    切り裂きファイル自体のサイズを取得します。

引数
    harc    JackOpenArchive() で返されたハンドル。

戻り値
    切り裂きファイル自体のサイズを返します。
    ハンドルが無効などのエラー時には -1 を返します。


-----------------------------------------------------------------------
DWORD WINAPI JackRipper( LPCSTR pszFileName, LPCSTR pszDirName,
                         int iJackType, LPCSTR pszJackSize )
-----------------------------------------------------------------------

順序数  101
機能
    ファイルを切り裂きます。
    元ファイルが "Jack.hlp" の場合、"Jack1.jak"、"Jack2.jak"、"Jack3.jak"
    のように切り裂きファイルを作成します。

    Jack32.dll独自の APIです。JackQueryFunctionList APIの対象外です。

引数
    pszFileName     切り裂く元ファイルのフルパス名。
    pszDirName      切り裂き先のディレクトリ名。
                    末尾の '\' はあってもなくても可。
    iJackType       切り裂き形式。
                     0: 通常の形式で切り裂く
                     1: 自己復元形式で切り裂く
                    -1: JackConfigDialog() で指定された形式で切り裂く。
    pszJackSize     切り裂きサイズ。
                     1KB を 1024 バイトで換算した文字列値を指定する。
                     NULL を指定すると JackConfigDialog() で指定された
                     サイズで切り裂く。

        例) JackRipper( "c:\work folder\jack.hlp", "c:\ripper files\",
                        0, "1423" );
                通常の形式で、1.44MB サイズで切り裂く。

            JackRipper( "c:\work folder\jack.hlp", "c:\ripper files\",
                        -1, NULL );
                形式もサイズも JackConfigDialog() での指定に従って
                切り裂く。

戻り値
  正常終了の時          0
  エラーが発生した場合  0 以外の数（エラー値 >= 0x8000）。

-----------------------------------------------------------------------
DWORD WINAPI JackCombine( LPCSTR pszFileName, LPCSTR pszDirName )
-----------------------------------------------------------------------

順序数  102
機能
    ファイルを復元します。
    たとえば "Jack1.jak"、"Jack2.jak"、"Jack3.jak" から "Jack.hlp" を
    復元します。

    Jack32.dll独自の APIです。JackQueryFunctionList APIの対象外です。

引数
    pszFileName     復元する切り裂きファイルのフルパス名。
                    １番目のファイルである必要はありません。
                    上記の例の場合、この引数には "Jack1.jak"でも
                    "Jack2.jak"でも "Jack3.jak"でも指定できます。
                    ただし、どれかひとつだけを指定します。

    pszDirName      復元先のディレクトリ名。
                    末尾の '\' はあってもなくても可。

戻り値
  正常終了の時          0
  エラーが発生した場合  0 以外の数（エラー値 >= 0x8000）。


-----------------------------------------------------------------------
レジストリの設定
-----------------------------------------------------------------------

レジストリの設定値

    JackConfigDialog() API で指定した値をここに保存します。

HKEY_CURRENT_USER\Software\ArchiverDll\Jack32\

    JackProcessMode     通常形式で切り裂くか、自己復元形式で切り裂くかの指定。

            0 : 通常の形式で切り裂く( デフォルト )
            1 : 自己復元形式で切り裂く

    JackRipperSize      ファイルを切り裂くサイズを KB単位で指定。
                        1KBは 1024バイト換算。

            デフォルト値は "1423"( 1.44MB FDのサイズ)。


-----------------------------------------------------------------------
注意
-----------------------------------------------------------------------

    現状の APIは今後仕様変更される事があります。

=======================================================================
