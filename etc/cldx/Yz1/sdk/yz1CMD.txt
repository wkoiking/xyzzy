
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  YZ1.DLL Ver 0.32 開発者向けドキュメント

                                                    K.INABA
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

==index==
  ☆はじめに
  ☆コマンドについて
  ☆ワイルドカードについて
   ( ☆ＡＰＩについて ===> api.txt )
   ( ☆構造体・メッセージ・コールバックについて ===> api.txt )
   ( ☆エラーコードについて ===> api.txt )
=========


★はじめに

  現在の仕様はいずれも今後変更される可能性があります。

  このDLLは、LoadLibrary() / GetProcAddress() による
  ダイナミックリンクで使用することが望ましいです。


★コマンドについて

    <command> [-<options>...] <yz1_file_name> [<directory_name>\] [<filespecs>...]

  命令（<command>）及びオプション（<options>）は大文字／小文字を区別し
  ます。個々の、空白かタブまたは改行で区切られた部分を、パラメータと呼
  びます。パラメータは、必ず上の書式に書いた順番で記述してください。
  最初の文字が @ であれば、それに続くファイル名をレスポンスファイルと
  して、その部分をファイル内容で置き換えます。

  レスポンスファイルでもファイル名は空白かタブまたは改行で区切られてい
  るものとします。また、レスポンスファイルの中で別のレスポンスファイル
  を指定することはできません。

  空白を含むファイル名やオプションを指定する場合は、そのパラメータ全体を
  "" で括ってください。レスポンスファイルにおいても同様です。

  <command>

    c  書庫作成( Create archive )

        新しく書庫を作成し、指定されたファイルを圧縮格納します。
        YZ1書庫の性質上、既存書庫への追加圧縮を行うことは出来ません。

    x  展開( eXpand archive )

        書庫内のファイルを、指定したディレクトリかカレントへ展開します。
        [<filespecs>...] で指定することで、一部のファイルだけを抽出する
        ことも可能です。

    s  自己解凍形式に変換( Sfx )

        普通のYZ1書庫を自己解凍書庫へ変換します。

    j  自己解凍形式解除

        YZ1自己解凍書庫を、普通のYZ1書庫へ変換します。

  <-options>

    スイッチ名の後ろに [-c0] と括弧で記述してあるのは、そのオプションを
    何も書かなかったときの、YZ1.DLLのデフォルト設定を示しています。
    数字を省略して単に -c などと書いたときは、特に記述がない限り、
    "1" が補われて -c1 と同じ扱いになります。

    --  レスポンスファイル文字の指定( response file )  [--@]

        例えば --! とすると、以降では !resp.file という形式でレスポンス
        ファイルを指定することになります。単に -- とだけ指定すると、
        以降ではレスポンスファイルは使用できません。

    -+  デフォルト設定使用( not use registry setting )

        このオプションではレジストリの指定を強制的に無視するために使います。
        現状ではレジストリをサポートしていないので無意味です。

    -c[0|1|2]  タイムスタンプ検査( Check timestamp )  [-c0]

        展開時に同名のファイルがあったとき、上書き問い合わせを行う条件を
        設定します。更新日時の新旧が基準となっています。
          -c0: 書庫内のファイルの方が古かったとき問い合わせ
          -c1: チェック省略（常に上書き）
          -c2: チェック省略（常に尋ねる）

    -ea[0|1|2]  パスの検査  [-ea1]

        絶対パスや".."入りでファイル名で格納されたファイルを
        展開しようとしたときの挙動をコントロールします。基準
        ディレクトリ外を上書きされることを禁止したいときに
        このスイッチを利用できます。圧縮時にも有効。
          -ea0: 全て許可
          -ea1: ダイアログでユーザーに問い合わせ
          -ea2: 全て禁止

    -i[0|1|2]  サイレントモード( sIlent mode )  [-i0]

        圧縮や展開の状況表示をどの程度行うかの制御スイッチです。
          -i0: 全て表示
          -i1: 公開鍵情報のみ表示
          -i2: 何も表示しない

　　-p  パスワード圧縮( Password )
　　-P  公開鍵方式パスワード圧縮( Public-key password )

        コマンドラインからパスワードを指定するには、-pPASSWORD などと
        指定します。指定が無く単に -p や -P としたときは、DLLがダイアログで
        ユーザーに問い合わせます。パスワードは、255Bytesまでです。

        また、解凍時のデフォルトパスワード指定としても使えます。

    -r[0|1|2]  圧縮時の下位ディレクトリ探索( Recursive search )  [-r2]

        書庫へ格納する際の、ファイル探索方法の指定です。
          -r0: 非再帰モード。パス名で指定されたファイルのみを格納。
          -r1: ファイル名指定再帰モード。パスとファイル名を切り離し、
               指定されたディレクトリ以下のファイルを再帰的に検索し、
               ファイル名と一致するものを展開します。
          -r2: ディレクトリ名指定再帰モード。ディレクトリ名を指定すると、
               その配下の全ファイルを格納します。

        ※注意！　現状ではこのオプションは展開時には機能しません。

　　-s  自己解凍形式で圧縮( make Self-extrating-archive )

        「アプリケーションのexeのあるディレクトリ -> system
           -> windows」の順でyzdec.exeを探し、最初に見つかった物を使って
        SFXに圧縮します。yzdec.exeがどこにも見つからないと失敗します。
        (v0.32から、カレントディレクトリは探さなくなりました) 

        また、-sa:\deepf\yzdec.exe　というようにSFXモジュールの場所を
        フルパス指定することもできます。この場合も指定されたyzdec.exeが
        存在しないと失敗します。

    -x[0|1]  ディレクトリ情報の使用( extract/archive with full pathname )  [-x1]

        圧縮・展開のどちらの時にも有効です。
          -x0: ディレクトリ情報を無視します。
          -x1: ディレクトリ構造を再現しながら圧縮解凍を行います。

    -y[0|1|2]  はい/いいえ型の質問に対する応答( Yes to all )  [-y2]

          -y0: 常に「いいえ」
          -y1: 常に「はい」
          -y2: ダイアログでユーザーが選択

    -z[0|1]  展開時全パスで合致( match with full pathname )

          -z0: ファイル名のみで比較
          -z1: 厳密に全パスで比較

        ※注意！　現状ではこのオプションは圧縮時には機能しません。

　<yz1_file_name>

        YZ1.DLL は最初のファイル名を YZ1 書庫名とみなします。
        書庫名をワイルドカードで指定することは出来ません。

　<directory_name>

        <yz1_file_name>の次のファイル名が最後が \ で終っていれば、
        基底ディレクトリの指定とみなします。
        このディレクトリ指定がなければカレントを基底ディレクトリとします。

　<filespecs...>

        それ以外の残りのパラメータでは、圧縮/展開したいファイル名を
        指定します。ワイルドカードが使えます。下を参照してください。

        このパラメータを指定しなかった場合、圧縮時はエラーになります。
        展開時は、「全てのファイル」を展開対象とします。-z オプションの
        状態によっては、"*" を指定したときと同じ動作とは限りません。


★ワイルドカードについて

  \ と / 、半角大文字と半角小文字、は同一視します。

  * ( \ を含まない任意の文字列) と ? ( \ 以外の任意の１文字) が使えます。

　"*.*" は「ファイル名に.を含むファイル」の意味になります。
 「全てのファイル」ではないのでご注意下さい。

　また現在の所、圧縮時は、ワイルドカードの入ったファイル名指定は、
　NTFSの副ストリームにはマッチしません。
